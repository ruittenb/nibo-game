<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nibo's Way Out</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Core layout variables */
            --pos-width: 150px;           /* Distance between horizontal positions */
            --platform-height: 110px;     /* Distance between platforms */
            --ground-height: 35px;        /* Height of ground */
            --platform-thickness: 30px;   /* Thickness of platforms */
            --pos-offset: 55px;           /* Offset for position 1 from left edge */
            --top-margin: 70px;           /* Extra space above topmost platform */
            --item-offset: 34px;        /* Offset for objects left of player position */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif;
        }

        .game-container {
            position: relative;
            width: calc(var(--pos-width) * 6);
            user-select: none;
            height: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin));
            background: #0f0f23;
            border: 3px solid #4a4a6a;
            border-radius: 8px;
            overflow: hidden;
        }

        .platform {
            position: absolute;
            height: var(--platform-thickness);
            background: #8b4513;
            border: 3px solid #5d2e0a;
            border-radius: 4px;
            box-shadow: inset 0 -5px 0 rgba(0,0,0,0.3);
        }

        /* Platform 1 (lowest): 5/6 width, aligned right */
        .platform-1 {
            bottom: var(--platform-height);
            right: 0;
            width: calc(var(--pos-width) * 5);
        }

        /* Platform 2 (third from above): 4/6 width, aligned left */
        .platform-2 {
            bottom: calc(var(--platform-height) * 2);
            left: 0;
            width: calc(var(--pos-width) * 4);
        }

        /* Platform 2-right (third from above): 1/6 width, aligned right */
        .platform-2-right {
            bottom: calc(var(--platform-height) * 2);
            right: 0;
            width: var(--pos-width);
        }

        /* Platform 3 (second from above): split with gap at position 3 */
        .platform-3-left {
            bottom: calc(var(--platform-height) * 3);
            left: 0;
            width: calc(var(--pos-width) * 2);
        }

        .platform-3-right {
            bottom: calc(var(--platform-height) * 3);
            right: 0;
            width: calc(var(--pos-width) * 3);
        }

        /* Platform 4 (top): 5/6 width, aligned left */
        .platform-4 {
            bottom: calc(var(--platform-height) * 4);
            left: 0;
            width: calc(var(--pos-width) * 5);
        }

        /* Grate (diamond mesh pattern) */
        .grate {
            position: absolute;
            width: var(--pos-width);
            height: 14px;
            background:
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    transparent 4px,
                    #888 4px,
                    #888 6px,
                    transparent 6px,
                    transparent 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0px,
                    transparent 4px,
                    #888 4px,
                    #888 6px,
                    transparent 6px,
                    transparent 10px
                );
            border-top: 2px solid #aaa;
            border-bottom: 2px solid #555;
        }
        .grate::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 100%;
            height: 100%;
            background:
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    transparent 4px,
                    #222 4px,
                    #222 6px,
                    transparent 6px,
                    transparent 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0px,
                    transparent 4px,
                    #222 4px,
                    #222 6px,
                    transparent 6px,
                    transparent 10px
                );
            opacity: 0.4;
            z-index: -1;
        }

        /* Platform 1 gap: position 1 */
        .grate-L1P1 {
            bottom: calc(var(--platform-height) + var(--platform-thickness) - 16px);
            left: 0;
        }

        /* Platform 2 gap: position 5 */
        .grate-L2P5 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 4);
        }

        /* Platform 3 gap: position 3 */
        .grate-L3P3 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 2);
        }

        /* Platform 4 gap: position 6 */
        .grate-L4P6 {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 5);
        }

        /* Hide radio buttons and checkboxes */
        .position-radio, .level-radio, .key-checkbox, .safe-checkbox, .wrench-checkbox {
            display: none;
        }

        /* Inventory area */
        .inventory {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 84px;
            height: 40px;
            border: 2px solid #4a4a6a;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
        }
        .inventory .key-inv {
            font-size: 24px;
            display: none;
        }
        /* Show key in inventory when picked up, but hide when safe is unlocked */
        #key-pickup:checked ~ #safe-unlock:not(:checked) ~ .inventory .key-inv {
            display: block;
        }

        /* Key in game world */
        .key-in-game {
            position: absolute;
            font-size: 24px;
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) - var(--item-offset));
            z-index: 20;
        }

        /* Safe on level 2, position 6 */
        .safe {
            position: absolute;
            font-size: 28px;
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
            z-index: 20;
        }
        /* Hide safe when unlocked */
        #safe-unlock:checked ~ .safe {
            display: none;
        }
        #key-pickup:checked ~ .key-in-game {
            display: none;
        }

        /* Wrench appears when safe is unlocked, hides when picked up */
        .wrench {
            position: absolute;
            font-size: 28px;
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
            z-index: 20;
            display: none;
        }
        #safe-unlock:checked ~ #wrench-pickup:not(:checked) ~ .wrench {
            display: block;
        }

        /* Wrench in inventory */
        .inventory .wrench-inv {
            font-size: 24px;
            display: none;
        }
        #wrench-pickup:checked ~ .inventory .wrench-inv {
            display: block;
        }

        /* Wrench pickup button */
        .wrench-pickup-btn {
            position: absolute;
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 37px);
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - 28px);
            width: 20px;
            height: 24px;
            cursor: pointer;
            display: none;
            z-index: 60;
            filter: drop-shadow(0 0 8px #00ff88);
            animation: pulse-glow 1.5s ease-in-out infinite;
        }
        .wrench-pickup-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 12px solid #00ff88;
        }
        .wrench-pickup-btn::after {
            content: '';
            position: absolute;
            top: 12px;
            left: 6px;
            width: 8px;
            height: 12px;
            background: #00ff88;
        }
        .wrench-pickup-btn:hover {
            filter: drop-shadow(0 0 15px #00ff88) drop-shadow(0 0 25px #00ff88);
        }
        /* Show wrench pickup button when at level 2, position 6, safe unlocked, wrench not picked up */
        #level-2:checked ~ #pos-6:checked ~ #safe-unlock:checked ~ #wrench-pickup:not(:checked) ~ .wrench-pickup-btn {
            display: block;
        }

        /* Key above safe - pulsates when user has key, clickable to unlock */
        .key-at-safe {
            position: absolute;
            font-size: 24px;
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 35px);
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - 28px);
            z-index: 20;
            display: none;
            cursor: pointer;
        }
        @keyframes key-pulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 8px #ffd700);
            }
            50% {
                transform: scale(1.2);
                filter: drop-shadow(0 0 15px #ffd700) drop-shadow(0 0 25px #ffd700);
            }
        }
        /* Only show key at safe when player is at level 2, position 6, has key, AND safe not yet unlocked */
        #level-2:checked ~ #pos-6:checked ~ #key-pickup:checked ~ #safe-unlock:not(:checked) ~ .key-at-safe {
            display: block;
            animation: key-pulse 1s ease-in-out infinite;
        }

        /* Key pickup button - CSS arrow (triangle + stem), only visible when player at key location and key not picked up */
        .key-pickup-btn {
            position: absolute;
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + 37px);
            left: calc(var(--pos-offset) - var(--item-offset) + 8px);
            width: 20px;
            height: 24px;
            cursor: pointer;
            display: none;
            z-index: 60;
            filter: drop-shadow(0 0 8px #00ff88);
        }
        /* Arrow head (triangle) */
        .key-pickup-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 12px solid #00ff88;
        }
        /* Arrow stem */
        .key-pickup-btn::after {
            content: '';
            position: absolute;
            top: 12px;
            left: 6px;
            width: 8px;
            height: 12px;
            background: #00ff88;
        }
        .key-pickup-btn:hover {
            filter: drop-shadow(0 0 15px #00ff88) drop-shadow(0 0 25px #00ff88);
        }
        @keyframes pulse-glow {
            0%, 100% {
                filter: drop-shadow(0 0 8px #00ff88) drop-shadow(0 0 15px #00ff88);
                opacity: 0.7;
            }
            50% {
                filter: drop-shadow(0 0 20px #00ff88) drop-shadow(0 0 35px #00ff88) drop-shadow(0 0 50px #00ff88);
                opacity: 1;
            }
        }
        .key-pickup-btn {
            animation: pulse-glow 1.5s ease-in-out infinite;
        }
        /* Show key pickup button when at level 4, position 1, and key not yet picked up */
        #level-4:checked ~ #pos-1:checked ~ #key-pickup:not(:checked) ~ .key-pickup-btn {
            display: block;
        }

        .player {
            position: absolute;
            width: auto;
            height: 56px;
            animation: idle 1s ease-in-out infinite;
            z-index: 100;
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 2);
            transition: left 0.3s ease, bottom 0.3s ease;
        }
        .player img {
            height: 100%;
            width: auto;
        }

        /* Player horizontal positions */
        #pos-1:checked ~ .player { left: var(--pos-offset); }
        #pos-2:checked ~ .player { left: calc(var(--pos-offset) + var(--pos-width)); }
        #pos-3:checked ~ .player { left: calc(var(--pos-offset) + var(--pos-width) * 2); }
        #pos-4:checked ~ .player { left: calc(var(--pos-offset) + var(--pos-width) * 3); }
        #pos-5:checked ~ .player { left: calc(var(--pos-offset) + var(--pos-width) * 4); }
        #pos-6:checked ~ .player { left: calc(var(--pos-offset) + var(--pos-width) * 5); }

        /* Player vertical levels */
        #level-0:checked ~ .player { bottom: calc(var(--ground-height) - 2px); }
        #level-1:checked ~ .player { bottom: calc(var(--platform-height) + var(--platform-thickness) - 2px); }
        #level-2:checked ~ .player { bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) - 2px); }
        #level-3:checked ~ .player { bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 2px); }
        #level-4:checked ~ .player { bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) - 2px); }

        @keyframes idle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--ground-height);
            background: linear-gradient(to bottom, #2d5016 0%, #1a3009 100%);
            border-top: 3px solid #4a7023;
        }

        .title {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: #ffd700;
            font-size: 20px;
            text-shadow: 2px 2px 0 #b8860b;
            letter-spacing: 3px;
        }

        .ladder {
            position: absolute;
            width: 24px;
            height: calc(var(--platform-height) - var(--platform-thickness));
            z-index: 10;
            /* Two vertical rails (4px each) */
            background:
                linear-gradient(90deg,
                    #cd853f 0px, #cd853f 4px,
                    transparent 4px, transparent 20px,
                    #cd853f 20px, #cd853f 24px
                );
            box-shadow:
                inset 1px 0 0 #8b5a2b,
                inset -1px 0 0 #8b5a2b;
        }
        /* Horizontal rungs using repeating gradient */
        .ladder::after {
            content: '';
            position: absolute;
            top: 0;
            left: 4px;
            right: 4px;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 10px,
                #cd853f 10px,
                #cd853f 14px
            );
        }

        /* Ladder 1: ground to platform 1, position 5 */
        .ladder-1 {
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + 42px);
        }

        /* Ladder 2: platform 1 to platform 2, position 3 */
        .ladder-2 {
            bottom: calc(var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + 42px);
        }

        /* Ladder 3: platform 2 to platform 3, position 1 */
        .ladder-3 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + 42px);
        }

        /* Ladder 4: platform 3 to platform 4, position 4 */
        .ladder-4 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 3 + 42px);
        }

        /* Arrow labels (clickable) - CSS triangles */
        .arrow {
            position: absolute;
            width: 0;
            height: 0;
            z-index: 50;
            cursor: pointer;
            user-select: none;
            display: none;
            filter: drop-shadow(0 0 8px #ffcc00);
        }

        .arrow:hover {
            filter: drop-shadow(0 0 15px #ffcc00) drop-shadow(0 0 25px #ffcc00);
        }

        /* Right arrow */
        .arrow-right {
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-left: 16px solid #ffcc00;
        }

        /* Left arrow */
        .arrow-left {
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-right: 16px solid #ffcc00;
        }

        /* Up arrow */
        .arrow-up {
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 16px solid #ffcc00;
        }

        /* Down arrow */
        .arrow-down {
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-top: 16px solid #ffcc00;
        }

        /* Horizontal arrow positions */
        .arrow-h {
            bottom: calc(var(--ground-height) - 10px);
        }
        .arrow-1-2, .arrow-2-1 { left: calc(var(--pos-offset) + var(--pos-width) * 0.5 + 12px); }
        .arrow-2-3, .arrow-3-2 { left: calc(var(--pos-offset) + var(--pos-width) * 1.5 + 12px); }
        .arrow-3-4, .arrow-4-3 { left: calc(var(--pos-offset) + var(--pos-width) * 2.5 + 12px); }
        .arrow-4-5, .arrow-5-4 { left: calc(var(--pos-offset) + var(--pos-width) * 3.5 + 12px); }
        .arrow-5-6, .arrow-6-5 { left: calc(var(--pos-offset) + var(--pos-width) * 4.5 + 12px); }

        /* Horizontal arrows move with level */
        #level-0:checked ~ .arrow-h { bottom: calc(var(--ground-height) + 5px); }
        #level-1:checked ~ .arrow-h { bottom: calc(var(--platform-height) + var(--platform-thickness) + 5px); }
        #level-2:checked ~ .arrow-h { bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 5px); }
        #level-3:checked ~ .arrow-h { bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 5px); }
        #level-4:checked ~ .arrow-h { bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + 5px); }

        /* Up arrow positions (at ladder locations) */
        /* Ladder 1: position 5, level 0 -> 1 */
        .arrow-up-L0P5 {
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + 45px);
            bottom: calc(var(--ground-height) + 27.5px);
        }
        /* Ladder 2: position 3, level 1 -> 2 */
        .arrow-up-L1P3 {
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + 45px);
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 27.5px);
        }
        /* Ladder 3: position 1, level 2 -> 3 */
        .arrow-up-L2P1 {
            left: calc(var(--pos-offset) + 45px);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 27.5px);
        }
        /* Ladder 4: position 4, level 3 -> 4 */
        .arrow-up-L3P4 {
            left: calc(var(--pos-offset) + var(--pos-width) * 3 + 45px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 27.5px);
        }

        /* Down arrow positions (at platform gaps) */
        /* Platform 1 gap: position 1, level 1 -> 0 */
        .arrow-down-L1P1 {
            left: calc(var(--pos-offset) + 10px);
            bottom: calc(var(--platform-height) - 5px);
        }
        /* Platform 2 gap: position 5, level 2 -> 1 */
        .arrow-down-L2P5 {
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + 10px);
            bottom: calc(var(--platform-height) * 2 - 5px);
        }
        /* Platform 4 gap: position 6, level 4 -> 3 */
        .arrow-down-L4P6 {
            left: calc(var(--pos-offset) + var(--pos-width) * 5 + 10px);
            bottom: calc(var(--platform-height) * 4 - 5px);
        }
        /* Platform 3 gap: position 3, level 3 -> 2 */
        .arrow-down-L3P3 {
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + 10px);
            bottom: calc(var(--platform-height) * 3 - 5px);
        }

        /* Show horizontal arrows based on position (all levels) */
        #pos-1:checked ~ .arrow-1-2 { display: block; }
        #pos-2:checked ~ .arrow-2-1 { display: block; }
        #pos-2:checked ~ .arrow-2-3 { display: block; }
        #pos-3:checked ~ .arrow-3-2 { display: block; }
        #pos-3:checked ~ .arrow-3-4 { display: block; }
        #pos-4:checked ~ .arrow-4-3 { display: block; }
        #pos-4:checked ~ .arrow-4-5 { display: block; }
        #pos-5:checked ~ .arrow-5-4 { display: block; }
        #pos-5:checked ~ .arrow-5-6 { display: block; }
        #pos-6:checked ~ .arrow-6-5 { display: block; }

        /* Show up arrow at ladder locations */
        /* Ladder 1: level 0, position 5 */
        #level-0:checked ~ #pos-5:checked ~ .arrow-up-L0P5 { display: block; }
        /* Ladder 2: level 1, position 3 */
        #level-1:checked ~ #pos-3:checked ~ .arrow-up-L1P3 { display: block; }
        /* Ladder 3: level 2, position 1 */
        #level-2:checked ~ #pos-1:checked ~ .arrow-up-L2P1 { display: block; }
        /* Ladder 4: level 3, position 4 */
        #level-3:checked ~ #pos-4:checked ~ .arrow-up-L3P4 { display: block; }

        /* Show down arrow at platform gaps */
        /* Platform 1 gap: level 1, position 1 */
        #level-1:checked ~ #pos-1:checked ~ .arrow-down-L1P1 { display: block; }
        /* Platform 2 gap: level 2, position 5 */
        #level-2:checked ~ #pos-5:checked ~ .arrow-down-L2P5 { display: block; }
        /* Platform 4 gap: level 4, position 6 */
        #level-4:checked ~ #pos-6:checked ~ .arrow-down-L4P6 { display: block; }
        /* Platform 3 gap: level 3, position 3 */
        #level-3:checked ~ #pos-3:checked ~ .arrow-down-L3P3 { display: block; }

        /* Fixed navigation panel - 3x3 grid */
        .nav-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 70px;
            height: 70px;
            z-index: 200;
            border: 2px solid #4a4a6a;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
            place-items: center;
        }

        .nav-cell {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .nav-cell-up { grid-column: 2; grid-row: 1; }
        .nav-cell-down { grid-column: 2; grid-row: 3; }
        .nav-cell-left { grid-column: 1; grid-row: 2; }
        .nav-cell-right { grid-column: 3; grid-row: 2; }

        /* Arrow triangles (gray inactive shown via ::before, yellow active via ::after on labels) */
        .nav-cell::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
        }
        .nav-cell-up::before {
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 14px solid #666;
        }
        .nav-cell-down::before {
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 14px solid #666;
        }
        .nav-cell-left::before {
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 14px solid #666;
        }
        .nav-cell-right::before {
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-left: 14px solid #666;
        }

        .nav-btn {
            position: absolute;
            width: 0;
            height: 0;
            cursor: pointer;
            display: none;
            filter: drop-shadow(0 0 4px #ffcc00);
        }
        .nav-btn:hover {
            filter: drop-shadow(0 0 10px #ffcc00) drop-shadow(0 0 15px #ffcc00);
        }

        /* Arrow shapes */
        .nav-up {
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 14px solid #ffcc00;
        }
        .nav-down {
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 14px solid #ffcc00;
        }
        .nav-left {
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 14px solid #ffcc00;
        }
        .nav-right {
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-left: 14px solid #ffcc00;
        }

        /* Show correct left arrow based on current position */
        #pos-2:checked ~ .nav-panel .nav-left[for="pos-1"] { display: block; }
        #pos-3:checked ~ .nav-panel .nav-left[for="pos-2"] { display: block; }
        #pos-4:checked ~ .nav-panel .nav-left[for="pos-3"] { display: block; }
        #pos-5:checked ~ .nav-panel .nav-left[for="pos-4"] { display: block; }
        #pos-6:checked ~ .nav-panel .nav-left[for="pos-5"] { display: block; }

        /* Show correct right arrow based on current position */
        #pos-1:checked ~ .nav-panel .nav-right[for="pos-2"] { display: block; }
        #pos-2:checked ~ .nav-panel .nav-right[for="pos-3"] { display: block; }
        #pos-3:checked ~ .nav-panel .nav-right[for="pos-4"] { display: block; }
        #pos-4:checked ~ .nav-panel .nav-right[for="pos-5"] { display: block; }
        #pos-5:checked ~ .nav-panel .nav-right[for="pos-6"] { display: block; }

        /* Show up arrow at ladder locations */
        #level-0:checked ~ #pos-5:checked ~ .nav-panel .nav-up[for="level-1"] { display: block; }
        #level-1:checked ~ #pos-3:checked ~ .nav-panel .nav-up[for="level-2"] { display: block; }
        #level-2:checked ~ #pos-1:checked ~ .nav-panel .nav-up[for="level-3"] { display: block; }
        #level-3:checked ~ #pos-4:checked ~ .nav-panel .nav-up[for="level-4"] { display: block; }

        /* Show down arrow at grate locations */
        #level-1:checked ~ #pos-1:checked ~ .nav-panel .nav-down[for="level-0"] { display: block; }
        #level-2:checked ~ #pos-5:checked ~ .nav-panel .nav-down[for="level-1"] { display: block; }
        #level-3:checked ~ #pos-3:checked ~ .nav-panel .nav-down[for="level-2"] { display: block; }
        #level-4:checked ~ #pos-6:checked ~ .nav-panel .nav-down[for="level-3"] { display: block; }

        /* Coins */
        .coin {
            position: absolute;
            width: 24px;
            height: 24px;
            color: gold;
            z-index: 15;
        }

        /* Coin positions - on platforms */
        .coin-L0P2 {
            bottom: calc(var(--ground-height) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 1 - var(--item-offset));
        }
        .coin-L1P4 {
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 3 - var(--item-offset));
        }
        .coin-L2P3 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 2 - var(--item-offset));
        }
        .coin-L3P5 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 4 - var(--item-offset));
        }
        .coin-L4P4 {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 3 - var(--item-offset));
        }
    </style>
</head>
<body>
    <!-- SVG symbols for reuse -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="coin" viewBox="96 32 384 384">
            <path fill="currentColor" d="M 96 224 a 192 192 0 1 1 384 0 192 192 0 1 1 -384 0 z m 176 -92 l 0 4 c -28.8 .3 -52 23.7 -52 52.5 0 25.7 18.5 47.6 43.9 51.8 l 41.7 7 c 6 1 10.4 6.2 10.4 12.3 0 6.9 -5.6 12.5 -12.5 12.5 L 248 272 c -11 0 -20 9 -20 20 s 9 20 20 20 l 24 0 0 4 c 0 11 9 20 20 20 s 20 -9 20 -20 l 0 -4.7 c 25 -4.1 44 -25.7 44 -51.8 0 -25.7 -18.5 -47.6 -43.9 -51.8 l -41.7 -7 c -6 -1 -10.4 -6.2 -10.4 -12.3 0 -6.9 5.6 -12.5 12.5 -12.5 l 47.5 0 c 11 0 20 -9 20 -20 s -9 -20 -20 -20 l -8 0 0 -4 c 0 -11 -9 -20 -20 -20 s -20 9 -20 20 z"/>
        </symbol>
    </svg>

    <div class="game-container">
        <div class="title">NIBO'S WAY OUT</div>

        <!-- Radio buttons for level (vertical) -->
        <input type="radio" name="level" id="level-0" class="level-radio">
        <input type="radio" name="level" id="level-1" class="level-radio">
        <input type="radio" name="level" id="level-2" class="level-radio">
        <input type="radio" name="level" id="level-3" class="level-radio">
        <input type="radio" name="level" id="level-4" class="level-radio" checked>

        <!-- Radio buttons for position (horizontal) -->
        <input type="radio" name="position" id="pos-1" class="position-radio">
        <input type="radio" name="position" id="pos-2" class="position-radio">
        <input type="radio" name="position" id="pos-3" class="position-radio" checked>
        <input type="radio" name="position" id="pos-4" class="position-radio">
        <input type="radio" name="position" id="pos-5" class="position-radio">
        <input type="radio" name="position" id="pos-6" class="position-radio">

        <!-- Key pickup checkbox -->
        <input type="checkbox" id="key-pickup" class="key-checkbox">

        <!-- Safe unlock checkbox -->
        <input type="checkbox" id="safe-unlock" class="safe-checkbox">

        <!-- Wrench pickup checkbox -->
        <input type="checkbox" id="wrench-pickup" class="wrench-checkbox">

        <!-- Fixed navigation panel -->
        <div class="nav-panel">
            <!-- Up cell -->
            <div class="nav-cell nav-cell-up">
                <label for="level-1" class="nav-btn nav-up"></label>
                <label for="level-2" class="nav-btn nav-up"></label>
                <label for="level-3" class="nav-btn nav-up"></label>
                <label for="level-4" class="nav-btn nav-up"></label>
            </div>
            <!-- Left cell -->
            <div class="nav-cell nav-cell-left">
                <label for="pos-1" class="nav-btn nav-left"></label>
                <label for="pos-2" class="nav-btn nav-left"></label>
                <label for="pos-3" class="nav-btn nav-left"></label>
                <label for="pos-4" class="nav-btn nav-left"></label>
                <label for="pos-5" class="nav-btn nav-left"></label>
            </div>
            <!-- Right cell -->
            <div class="nav-cell nav-cell-right">
                <label for="pos-2" class="nav-btn nav-right"></label>
                <label for="pos-3" class="nav-btn nav-right"></label>
                <label for="pos-4" class="nav-btn nav-right"></label>
                <label for="pos-5" class="nav-btn nav-right"></label>
                <label for="pos-6" class="nav-btn nav-right"></label>
            </div>
            <!-- Down cell -->
            <div class="nav-cell nav-cell-down">
                <label for="level-0" class="nav-btn nav-down"></label>
                <label for="level-1" class="nav-btn nav-down"></label>
                <label for="level-2" class="nav-btn nav-down"></label>
                <label for="level-3" class="nav-btn nav-down"></label>
            </div>
        </div>

        <!-- Inventory -->
        <div class="inventory">
            <span class="key-inv">üîë</span>
            <span class="wrench-inv">üîß</span>
        </div>

        <!-- Key in game world -->
        <div class="key-in-game">üîë</div>

        <!-- Safe on level 2, position 6 -->
        <div class="safe">üóÑÔ∏è</div>

        <!-- Wrench (appears when safe is unlocked) -->
        <div class="wrench">üîß</div>

        <!-- Key above safe (appears when user has key, clickable to unlock) -->
        <label for="safe-unlock" class="key-at-safe">üîë</label>

        <!-- Pickup button for key -->
        <label for="key-pickup" class="key-pickup-btn"></label>

        <!-- Pickup button for wrench -->
        <label for="wrench-pickup" class="wrench-pickup-btn"></label>

        <!-- Horizontal arrow labels -->
        <label for="pos-2" class="arrow arrow-right arrow-h arrow-1-2"></label>
        <label for="pos-1" class="arrow arrow-left arrow-h arrow-2-1"></label>
        <label for="pos-3" class="arrow arrow-right arrow-h arrow-2-3"></label>
        <label for="pos-2" class="arrow arrow-left arrow-h arrow-3-2"></label>
        <label for="pos-4" class="arrow arrow-right arrow-h arrow-3-4"></label>
        <label for="pos-3" class="arrow arrow-left arrow-h arrow-4-3"></label>
        <label for="pos-5" class="arrow arrow-right arrow-h arrow-4-5"></label>
        <label for="pos-4" class="arrow arrow-left arrow-h arrow-5-4"></label>
        <label for="pos-6" class="arrow arrow-right arrow-h arrow-5-6"></label>
        <label for="pos-5" class="arrow arrow-left arrow-h arrow-6-5"></label>

        <!-- Up arrow labels (at ladder positions) -->
        <label for="level-1" class="arrow arrow-up arrow-up-L0P5"></label>
        <label for="level-2" class="arrow arrow-up arrow-up-L1P3"></label>
        <label for="level-3" class="arrow arrow-up arrow-up-L2P1"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-L3P4"></label>

        <!-- Down arrow labels (at platform gaps) -->
        <label for="level-0" class="arrow arrow-down arrow-down-L1P1"></label>
        <label for="level-1" class="arrow arrow-down arrow-down-L2P5"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-L4P6"></label>
        <label for="level-2" class="arrow arrow-down arrow-down-L3P3"></label>

        <!-- Player character -->
        <div class="player">
            <img src="images/walk-80.png" alt="Player">
        </div>

        <!-- Ladder from ground to platform 1 (position 6) -->
        <div class="ladder ladder-1"></div>

        <!-- Ladder from platform 1 to platform 2 (position 3) -->
        <div class="ladder ladder-2"></div>

        <!-- Ladder from platform 2 to platform 3 (position 1) -->
        <div class="ladder ladder-3"></div>

        <!-- Ladder from platform 3 to platform 4 (position 4) -->
        <div class="ladder ladder-4"></div>

        <!-- Grates at platform gaps -->
        <div class="grate grate-L1P1"></div>
        <div class="grate grate-L2P5"></div>
        <div class="grate grate-L3P3"></div>
        <div class="grate grate-L4P6"></div>

        <!-- Platform 1 (lowest): 5/6 width, aligned right -->
        <div class="platform platform-1"></div>

        <!-- Platform 2 (third from above): 4/6 width, aligned left -->
        <div class="platform platform-2"></div>

        <!-- Platform 2-right (third from above): 1/6 width, aligned right -->
        <div class="platform platform-2-right"></div>

        <!-- Platform 3 (second from above): split with gap at position 3 -->
        <div class="platform platform-3-left"></div>
        <div class="platform platform-3-right"></div>

        <!-- Platform 4 (top): 5/6 width, aligned left -->
        <div class="platform platform-4"></div>

        <!-- Ground -->
        <div class="ground"></div>

        <!-- Coins -->
        <svg class="coin coin-L0P2"><use href="#coin"/></svg>
        <svg class="coin coin-L1P4"><use href="#coin"/></svg>
        <svg class="coin coin-L2P3"><use href="#coin"/></svg>
        <svg class="coin coin-L3P5"><use href="#coin"/></svg>
        <svg class="coin coin-L4P4"><use href="#coin"/></svg>
    </div>
</body>
</html>
