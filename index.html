<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="screen-orientation" content="landscape">
    <meta name="author" content="René Uittenbogaard">
    <meta name="creator" content="Claude Code">
    <title>Nibo's Way Out</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,
AAABAAMAEBAAAAEAIABoBAAANgAAACAgAAABACAAKBEAAJ4EAAAwMAAAAQAgAGgmAADGFQAAKAAAABAAAAAgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAEzZwULMWOiCzNnuAsyZ7gLMme4CzNnuAszZ7gKMme4CzJmuAsyZ7gLMma4CzJnuAoyZ7gKMma4CjBhoAAAVAMJLlscDzp2/xNFi/8TRYr/E0WK/xJF
iv8TRYv/E0WL/xNFiv8TRYr/E0WK/xJFi/8TRIv/E0WL/w46df8ALVkXCS5aHA86dv8TRYv/E0SL/xNEi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/
E0SL/xJEiv8OOnX/ACxZFw0oXxMMNm38EDx8/xA8fP8QPXz/EEB//xBVlP8OYp//DmGe/xFVlP8RP37/ED19/xA9ff8QPXz/DTZt+gAiVQ8AAAAABy5cJwkt
XDoJLF06CmKUlAqCs/0HpdP/BbXh/wW14f8HpdP/C4Cy/QlilI8JLFw6CSxdOgYvXiYBAQAAAQAAAAABAQAAAAAACoe4eQiezf8C0fn/Adf+/wHW/v8B1///
Adf//wLR+f8InMv/C4W4cwAAAAAAAAAAAQAAAAABAAAAAAAADYe4PQiZyf0B1f3/Adb//wHX//8B0vv/AdL7/wDX//8B1///AdX9/wmYx/wIhLc4AAAAAAAB
AAAAAAAAAAEAAAuGubcDx/D/Adb+/wHV/f8Go9D/Co2+/wqMvv8HotH/Adb//wHW/v8DxO7/DIa4sQAAAAAAAAEAAAAAAACA1QYJkcP5Adf//wHW//8Gr9z/
B6XT/wHW/v8B1f3/BLfj/wHW/v8A1///ANf+/wmRwPYBq6oDAAEBAAAAAAAJhLkdCJvL/wHX//8EwOv/Co6//widzP8HpdL/As32/wHX//8A1///Adf//wHX
//8Imcn/DYC5FgAAAAAAAAAAAIC3DgiWx/4A1/7/AdL6/wifzv8Hqtf/A8bw/wHT+/8B0vr/Adf+/wHX//8A1v//CZTF/QGOxgkAAAAAAAAAAAEBAQALh7nS
AtD4/wHX//8CyvX/CpDB/wen1f8Gp9X/CZLC/wHW/v8B1v//As73/wuHuMwAAAEAAAEAAAAAAQABAAAACoe4Zgep1P8B1///Adf//wLR+v8EueT/BLrk/wHS
+v8A1///Adf//wam1f8LhbdgAAAAAAEAAQABAQAAAAABAACB/wIKhri4BbXg/wHX//8B1///Adf//wHX//8A1///Adf//wWy3/8LhrizAf//AQAAAAAAAQAA
AQAAAAAAAAAAAAEAAICzCguHuaQInMr/BLzp/wLN9/8Czff/BLzp/wmcy/4LhrigAHCqCQAAAAAAAAAAAAABAAAAAAABAAAAAAAAAAAAAAABAAAACYa1NwuG
uI8Lh7m5C4e2uQuEt44KhLs0AAEAAAABAQAAAAAAAAAAAAEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAKAAAACAAAABAAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADCxdKQkuXXAJLV1xCC1dcQgsXXEJLV1xCS1dcQgt
XXEJLV1xCS1dcQgtXXEJLV1xCS1dcQktXXEJLV1xCS1dcQktXXEJLF1xCS1dcQktXXEJLV1xCS1dcQktXXEJLV1xCS1dcQktXXEJLlxvBzBaJQAAAAAAAAAA
AAAAAA0mWRQKLV3xDTVr/w01bP8NNWz/DTVs/w01bP8NNWz/DTVs/w00bP8NNWz/DTRs/ww1bP8NNWz/DTVs/w01bP8NNWz/DTVt/w01bP8NNWz/DTVs/w00
bP8NNWz/DDRs/w01bP8NNWz/DTVt/ww0av8KLV3sACdiDQABAAAAAAAACC1fOQswYv8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/
E0WL/xNFiv8TRYv/EkWL/xNFi/8TRYv/EkWL/xNFi/8SRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/wovX/8GLFkuAAAAAAAAAAAJLVk5CzBi/xNF
i/8TRYv/E0WL/xNFi/8TRYv/E0SL/xJFi/8TRYv/E0WL/xNFiv8TRYv/E0WL/xJFi/8TRYv/E0WL/xNFiv8TRYv/EkWL/xNFi/8TRYv/E0WK/xNFi/8TRYv/
E0SL/xNFiv8TRIv/Ci9f/wYsWS4AAAAAAAEBAAktWTkLMGP/E0WL/xNFi/8TRYv/E0SL/xNEi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNF
i/8SRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8SRYv/E0WL/xNFi/8KLl7/ByxZLgAAAAAAAAAACS1ZOQowYv8SRIr/E0WL/xNFi/8TRYv/
E0WK/xNFi/8SRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8SRYv/E0WL/xNFi/8TRYv/E0WK/xNFi/8SRYv/E0WL/xNFi/8TRIv/EkWL/wov
X/8GLFkuAAAAAAAAAAAJLV45CzBi/xNFi/8SRYv/E0WL/xNFi/8TRYv/E0WL/xJEi/8TRYr/E0WL/xNFi/8SRIv/E0WL/xNEi/8TRYv/E0WL/xJFi/8SRYv/
E0WL/xNFi/8TRYv/E0SL/xNFiv8TRYr/E0WK/xNFi/8TRYv/Ci9f/wYsWS4AAAAAAAAAAA0yWRQJLV3yDTVr/w02bf8MNm3/DTZt/w02bf8NNm3/DTZt/w02
bf8NP3f/DVuU/w1wqf8MfbH/C4G1/wuBtP8Me7D/DXCp/w1ak/8NPnX/DTdt/w02bf8NNm3/DTZs/w02bf8NNm3/DTZt/ww1a/8KLl3tACdiDQAAAAAAAAAA
AAAAAAwqXysILV1zCSxcdAksXHQJLFx0CCxcdAksXHQLPm+PCmeY+AuEtv8Lhrj/C4a5/wqQwP8Jl8f/CZfH/wqPwP8Lhrj/Coa4/wqEtv8LZ5b2CTtqiwks
XHQJLFx0CS1cdAktXHQJLFx0CS1ccgcvXiYAAAAAAQAAAAAAAAABAAEAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAC4e2WwuGuPELhrj/CZjI/wS55f8C0fn/
Adf//wHX//8B1///ANf//wLQ+f8FuOP/CZbG/wuGuP8KhrjtCYa7UgAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAA2GuXwLhrj/Co2//wS96P8B1///ANf//wHX//8B1///Adf//wDX//8B1///Adf//wHX//8B1///BLvm/wqMvf8Lhrn+C4W5cQEAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMhrlqC4a5/wmVxf8Cz/j/Adf//wHX//8B1///Adf//wHX/v8B1///Adf+/wHX
//8B1///Adf//wHX//8B1/7/As32/wmSw/8Lhrj+C4S3XwABAAAAAAAAAAEAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC4i4LwuGuPkJkcH/
A9D5/wHX//8B1///Adf//wHX//8B1v//Adb//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///As73/wqPv/8Lhrj1DYO3JwAAAAAAAAAAAQAAAAAA
AAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAMh7fEC4e5/wPG8P8B1v//Adf//wHW/v8B1v//Adf+/wHX//8B1Pz/A8jx/wPI8f8B1Pz/Adf//wHX//8B1///
Adf+/wHX//8B1///A8Pt/wuGuP8Lh7i4AAAAAAAAAAAAAAAAAQABAAAAAAAAAAAAAAAAAAEAAAAAAAAADIe3QAuGuP8HpdP/Adf//wHX//8B1///Adf//wDX
//8C0fn/B6XT/wuIuv8Khrj/C4a5/wuIuv8HpdP/AtD5/wHX//8B1///Adf//wHX//8B1///CKHQ/wuGuP8KhLo0AAAAAAABAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAEAAAALh7mgC4a4/wLJ8/8B1///Adf//wHX//8B1v7/As73/wqQwf8Lhrj/Coq7/wicy/8Im8r/Com7/wuGuP8KkMH/AdP8/wHX//8B1///Adf//wHX
//8DxvD/C4a4/wyGuJQBAQAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAuGuOgJk8P/Adf//wHX//8B1///Adf//wHX//8Im8r/C4a4/wei0P8B0vv/
Adf+/wHX//8C0fn/CKDP/wmQwf8B0vv/Adf//wDX//8B1///Adf//wDX//8Kj8D/DIa43AAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAKiboaC4a4/wel
0/8A1///Adf//wHX//8A1///A8Xx/wuGuP8Jlsf/Adb//wHW//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adb//waj0P8Lh7j+
EpK2DgAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAmEuDYLhrj/Bq/c/wHX//8B1///Adf//wPF7v8Hp9X/C4a4/wep1v8Dwuz/A8Ls/wPC7f8B0/z/Adf//wHX
//8B1///Adf//wDX//8B1///Adf//wHX//8B1///BqzZ/wuGuP8MibopAAAAAAAAAQAAAQEAAAAAAAAAAAABAQEACIa5PQuGuP8Fst//Adf//wDX//8B1///
Co6//wqGuP8Lhrj/C4a4/wuGuP8Lhrj/C4e4/wWy3v8B1///Adf//wHX//8B1///Adf//wDW//8B1///Adf//wHX//8Grtv/C4a4/wuCsy8BAAAAAAAAAAAA
AAABAAAAAAAAAAAAAAAMhLksC4e4/was2f8B1///Adf//wDX//8Dw+3/B6PS/wuGuP8Imsn/Bbbi/wW24v8Ft+L/A8jx/wHX//8B1v//ANf//wHX//8B1///
Adf//wDX//8B1///Adf//weo1v8Lhrj/EIe/IAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAACLuQsLh7j8CJ/O/wHX//8B1///Adf//wHX//8Czfb/C4e5/wqL
vf8CzPb/Adf//wHX//8B1///Adf//wLR+f8DyvT/Adf+/wHX//8B1///ANf//wHW//8B1///CJvK/wuGufcAgL8EAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAA
AAAAAAuGuM0Ki7z/ANX9/wHX//8B1///Adf//wHX//8Gqtj/C4a4/wqPwP8EvOf/AdP9/wHT/P8EvOf/Co7A/wuIuv8B1Pz/Adf//wHX//8A1///ANf//wHT
/P8Kibr/DIW4wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAACoa3fAuGuP8EvOf/Adf//wHX//8B1///Adf//wHW/v8HpdP/Coa4/wuGuf8Lh7j/
C4a4/wuGuf8Lhrj/BqrX/wHX//8B1///Adf//wDX//8B1///BLjk/wuGuP8LhrZwAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAKhbgZC4a49wmU
xP8B1v7/Adb//wHX//8B1///Adf//wHX//8Ewez/B6LR/wmUxP8JlcX/B6TS/wPE7/8B1///Adf//wHX//8B1v7/Adf//wHV/f8JkcL/C4a48g6BuBIAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALhriJC4a4/waw3P8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHW//8A1///Adf//wHX
//8B1///Adf//wHW//8B1///Bq3Z/wuGuP8Khbh9AAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAACAswoLhrjVC4e5/wS86P8B1///
Adf//wDX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHW//8B1///Adf//wS55f8Lhrj/C4e4zQCAqgYAAAAAAAAAAAEAAQAAAAAAAQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeDuiULhrjpC4e5/wW14f8B1///Adf//wHX//8B1/7/Adf//wHX//8B1///Adf+/wHX//8B1v//Adf//wHX/v8Fst7/
C4e5/wuGuOMIibseAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyJuykLhrjfC4a4/wicy/8CyPL/Adf//wHX
//8B1///Adf//wHX//8B1///Adf//wHX//8DxvD/CJrJ/wqGuP8LhrjZB4O2IwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAABAAAAAAAAAAAAAA+HwxEKh7mjC4a4/guGuf8JmMj/BrDc/wS/6v8Dx/H/A8fx/wS/6v8Gr9z/CZfG/wuGuP8Lhrj9C4a5nBKAtg4BAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAKh7c1C4W3pwuGuPULhrj/Coa4/wuGuP8Lhrj/
C4a4/wuGuP8Lhrj0C4a3oguEujAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAI7GCQyHt0AMhrlqCoa4fgqGuH4Mh7hoDYa4PQCStgcAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAA
AABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkSQcIMVofBy9eJgcvXiYHL14mBy9eJgcvXiYHL14mBy9eJgcvXiYHL14m
By9eJgcvXiYHL14mBy9eJgcvXiYHLl4mBy9eJgcvXiYHL14mBy9eJgcvXiYHL14mBy9eJgcvXiYHL14mBy9eJgcvXyYHL14mBy9eJgcvXiYHL14mBy9eJgcv
XiYHL14mBi9eJgcvXiYHL14mBi9eJgcvXiYIKl0eADNmBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQotXXwKLl3cCy5c8AouXPAKLlzwCi5c8AouXPAKLlzw
Ci5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8Aou
XPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAKLlzwCi5c8AouXPAJLl3YCS5dcAAAAAAAAAAAAAAAAAAAAAAAAAAACC9eNgouXfcMM2f/Dzp1/w86dv8PO3b/
Dzp2/w86dv8POnb/Djp2/w86dv8PO3b/Dzp2/w86dv8POnb/Dzp2/w86dv8POnb/Dzp2/w86dv8POnb/Dzp2/w86dv8POnb/Djp2/w86d/8POnb/Dzp2/w86
dv8POnb/Dzp2/w86d/8POnb/Dzp2/w86dv8POnb/Djp2/w86dv8POnb/Dzp2/w86df8MM2f/Ci5d9QcwWiUAAAAAAQAAAAAAAAAAAAAACC5eXwovX/8PPHn/
E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRIv/EkWL/xNFiv8TRYv/EkWL/xNF
i/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFiv8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8POnb/Ci5e/wcrWU0AAAAAAQAAAAAAAAAAAQAA
CC5bXwovX/8PPHn/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNF
i/8TRYv/E0WL/xNFiv8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8POnb/Ci5e/wcrWU0AAAAA
AQAAAAAAAAAAAQAACC5bXwovX/8PPHn/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNF
iv8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFi/8POnb/
Ci5e/wcrWU0AAAAAAAAAAAAAAAAAAQAACC5bXwovX/8PPHn/E0WL/xNFiv8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRIv/E0WL/xNF
i/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRIv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRIv/EkWL/xNFi/8TRYv/E0WL/xNFi/8TRYv/
E0WL/xNFi/8POnb/Ci5e/wcrWU0AAAAAAQAAAAAAAAAAAAAACS5bXwovX/8PPHn/E0WL/xNFiv8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNF
i/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFi/8TRIv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRYv/
E0WL/xNFi/8TRIv/E0WL/xNFi/8PO3b/Ci5e/wcrWU0AAAAAAAAAAAAAAAAAAAAACC5bXwovX/8PPHn/E0WL/xNFiv8TRYv/E0WL/xNFiv8TRIv/E0WL/xNF
i/8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/
E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8POnb/Ci5e/wcrWU0AAAAAAAAAAAAAAAAAAAAACC5bXwovX/8PPHn/E0WL/xNFi/8TRIv/E0WL/xNF
iv8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/
E0WL/xNFi/8TRYv/E0WL/xNFi/8TRYv/EkWL/xNFi/8TRYv/E0WL/xNFiv8POnb/Ci5e/wcrWU0AAAAAAAAAAAAAAAAAAAAACjBgUAouXv8OOHH/EUGD/xFB
hP8RQYT/EUGE/xFBhP8RQYT/EUGE/xFBhP8RQIT/EUGE/xFBhP8RQYT/EUGE/xFChP8RSIv/EVKU/xBamf8QX53/D2Ge/w9hnv8QXpz/EFqZ/xFSlP8RR4r/
EUKE/xFBhP8RQYT/EUGE/xFBhP8RQIT/EUGE/xFBhP8RQYT/EUGE/xFBhP8RQYT/EUGE/xFBg/8NN2//Ci5d/wguXD0AAAAAAAAAAAAAAAAAAAAAADdbDgsu
XtoKL1//CzFi/wsxYv8LMWL/CzFi/wsxYv8LMWL/CzFi/wsxYv8LMWL/CzFi/wsxYv8LMmT/C0d6/wtonP8Me6//DICz/wuCtf8LhLb/C4S3/wuEt/8LhLb/
C4K1/wyAs/8Meq7/C2WZ/wtFd/8LMmP/CzFi/wsxY/8LMWL/CzFi/wsxYv8LMGL/CzFi/wsxYv8LMGL/CzFi/wsxYv8KL1//Ci5czAAgYAgAAQAAAAAAAAAA
AAAAAAAAAAAAAA8tYiIKLV6eCS1dwAktXMEJLFzBCS1cwQktXMEJLVzBCS1cwQktXcEJLVzBCjNj0AlIePULc6T/C4W3/wuGuP8Lhrj/C4a4/wuJuv8Ki7z/
Coy9/wqMvf8Ki7z/C4i6/wuGuP8Lhrj/C4a4/wuFt/8LcKD/CUZ28wozYs4JLVzBCC1cwQktXMEJLVzBCS1cwQktXMEJLVzBCS1cwQktXcAKL12XCS9eGwAA
AAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACqqgMNhLc8C4a4qAuGufcLh7j/C4a4/wqMvv8Ins3/
B6zZ/wW24v8EvOj/BMHs/wTB6/8EvOf/Bbbi/war2P8InMz/Cou9/wuGuf8Lhrj/Coa49QuGt6AKh7c1AID/AgAAAAAAAAAAAQAAAAAAAAAAAQAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuItl4LhrjjC4a4/QuGuP8Kjb7/
Bq7b/wLL9P8C0fr/Adb+/wHX/v8B1v//ANf//wHX//8B1///Adf//wHW//8C0fr/Asrz/was2f8KjL3/C4a4/wuGuP0KhrjeDIa5UAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAamMwKDYe4dwuGuP4Lhrj/
Coq8/wii0P8CzPX/Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1v//Adf//wHX//8DyvP/CJ7N/wuJu/8Lhrj/C4a4/AqG
tmkAjqoJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAACOqgkLh7l5
C4a49AuGuP8JksP/Bbjk/wHV/f8B1///Adf//wHX//8B1///Adf//wHX/v8B1///Adf//wHX/v8B1v//Adf//wHX//8B1///Adf//wHX//8B1///AdT9/wW2
4v8KkMH/C4a4/wuGt/IMhLduAJK2BwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAyEulULhrjxC4a4/wqPwP8Dw+7/Adb+/wHX//8B1///Adf//wHX//8B1///Adf//wHX/v8B1///Adf//wHX/v8B1///ANf//wHX//8B1///Adf//wHX
//8B1///Adf//wHW/v8EwOr/Co6+/wuGuP8LhbjtC4W3RwAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAQAAAAAAAQAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAADYa1JguHuO4Lhrj/Co29/wPE7v8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///ANf//wHX//8B1///ANf//wHX
//8B1///ANf//wHX//8B1///Adf//wHX//8B1///BL/q/wqLvP8Lhrj/C4a45QmJthwAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAPh7QRCoe4tguGuP8Ki73/BLvn/wHX//8B1///Adf//wHX/v8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX
//8B1///Adf//wHX//8B1///Adf//wHX//8B1///ANf//wHX//8B1///Adf//wW34v8Kirv/C4a4/wyGuKkAgKoMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALh7lbDIa48wuHuP8HptX/AdT8/wHX//8B1///Adf//wHX//8B1///Adf//wHX/v8B1///Adf//wHV
/f8Dx/D/Bbzn/wS85/8DxvD/AdX9/wHX//8B1///Adf//wHX/v8B1///Adf//wHX//8B1///Adf//wLT+/8IpNL/Coa4/wuFuO8KhrZQAAAAAAAAAQAAAAAA
AAAAAAAAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAABCArxAKhbeuC4a4/wqPwP8DxvH/Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHW
/v8Czfb/Ba7b/wqNvv8Lhrj/C4a4/wuGuP8Lhrj/Co2+/wau2/8Czfb/Adb+/wHX//8B1///Adf//wHX//8B1///Adf//wHX//8Ew+3/Co2+/wuGuP8Lh7mh
AIu5CwAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuFujALhrjsC4a4/wem1P8B1v7/Adf//wHX//8B1///Adf//wHX
//8B1///Adf//wS96f8JlcX/C4e5/wuGuP8Lh7j/C4a4/wuGuP8Lhrj/C4a4/wuHuf8JlMX/BL3o/wHX/v8B1///ANf//wHX//8B1///Adf//wHX//8B1f3/
CKHP/wuGuP8LhrnkDYa8JgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAuFt3kLhrj/C4a4/wLJ8/8B1///Adf//wHX
//8B1///Adf//wHX//8B1///BL3p/wqMvP8Lhrj/C4a4/wuIuv8InMz/Bq3a/was2f8Imsn/C4i6/wuGuP8Lhrj/Coy9/wLN9v8B1///Adf//wHX//8B1///
Adf//wHX//8B1v//A8Pt/wuGuP8Lhrj+DIe2ZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyHuccLhrj/CZbG/wHX
//8B1///Adf//wHX//8B1v//Adf//wHX//8Dy/T/CpDB/wuGuf8LiLr/CZvK/wLK8/8B1///Adf//wHX//8B1///A8bw/wmXx/8LiLr/Cou9/wLL9f8B1///
Adf//wHX//8B1v//Adf//wHX//8B1///Adf//wqQwP8Lhrj/C4e4tAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAQAAAAAAAQAAAAAAE4C2DguG
uPgLhrj/Bq3a/wHX//8B1///Adf//wHX/v8B1///ANf//wHV/f8Grdv/C4e5/wuHuf8Hoc//AtD5/wHX/v8B1///ANf//wHX//8B1v//Adf//wLP+P8FteH/
BL7p/wHX//8B1///Adf//wHX/v8B1///Adf//wHX/v8B1///Adf//wem1P8Lhrj/DIa37gBmmQUAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAA
AQAAAAAADom4NguGuP8Lhrj/BL7p/wHX/v8B1///ANf//wHX//8B1///Adf//wLQ+P8JmMj/C4a4/wqOv/8DxfD/Adf//wHX//8B1///Adf//wHX/v8B1///
Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX/v8B1v//Adf//wHX//8B1///Adf//wW45P8Lhrj/Coa4/w+HvCIAAAAAAAAAAAAAAQAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAADIa2VAuGuP8Lhrj/A8ny/wHX//8B1///Adf//wHX//8B1f3/AtD5/wPF7/8Ki73/C4a4/wmZyP8C0Pj/A9D5/wLQ+f8C0Pn/
AtD5/wHV/f8B1///Adf//wHX//8B1v//Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX/v8B1v//Adf//wPD7f8Lhrj/C4a4/wyHu0AAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACoe4ZAuGuP8Kirv/A8v0/wHX//8B1///Adf//wHX//8Evej/CJvK/wmWxv8Lhrj/Coa4/wqOv/8ImMn/
CJnJ/wiZyf8Imcn/CZrJ/wW34/8B1///ANf//wHX/v8B1v//Adf//wHX//8B1v//Adf//wHX//8B1///ANf//wHX/v8B1///Adf//wPJ8/8Lhrj/C4a4/wqE
tk0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACoS2ZguGuf8Kibv/A8v0/wHX//8B1v//Adf//wHX//8Euub/Coq8/wuGuP8Lh7j/
C4a4/wuGuP8Lh7j/C4a4/wuGuf8Lhrj/C4a4/wmVxf8B1P3/ANf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///ANf//wHX//8B1///Adf//wPJ
8v8Lhrj/C4a4/wqGt04AAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADYi4TwuGuP8Lhrj/A8jy/wHX//8B1///Adf//wHX//8C0Pn/
B6nW/widzf8LiLr/C4a4/wqKvP8Ins7/CKHQ/wih0P8IodD/CaHQ/wau2/8B1v7/Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX
//8B1v//Adf//wTB7P8Lhrj/C4a4/w2GuD0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACoe7MQuGuP8Lhrj/BLzn/wHX/v8B1///
Adf//wHX//8B1v//Adf//wLP+P8Jlsb/C4a4/wqNvv8DxO7/Adf//wHX//8B1///Adf//wHX/v8B1///Adf//wHX//8B1v//Adf//wHX//8B1///Adf//wHX
/v8B1///ANf//wHX//8B1///Adf//wW24v8Lhrj/C4a4/xKEwR0AAAAAAAAAAAAAAQAAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAYC/CAuHuPgLhrj/
BqvY/wHX//8B1///Adf//wHX//8B1///Adf//wHV/f8Gq9j/C4e5/wuHuP8IoM//AtL6/wHX//8B1///Adf//wHX//8B1///Adf//wHT/f8EvOj/Asrz/wHX
//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wel0v8Lhrj/C4e46gCA/wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAyHuL8Lh7j/CZTE/wHW/v8B1v//Adf//wHX//8B1///Adf//wHX//8DyPH/CZHC/wuGuP8Lhrj/CKDP/wLL9P8B0/v/Adb//wHW//8B0/v/Asv0/wif
zv8Lhrj/Coy9/wHU/P8B1///Adf//wHX//8B1v//ANf//wHX//8B1///AdX9/wqOv/8Lhrj/DIa5qwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAyGt24Lhrj/C4a4/wPF7/8B1///Adf//wHX//8B1///Adf//wHX/v8B1///BLzo/wqNvv8Lhrj/C4a4/wqOwP8HotH/Bq3a/wat
2v8HotD/Co6//wuGuP8Lhrj/CZHC/wHT/P8B1///Adf//wHX//8B1v//ANf//wHX/v8B1///Ar/q/wuGuP8Lhrj+Coe5WwAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAyDtCkLhrjoCoa4/wehz/8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adb+/wPC7f8JksP/C4a4/wuG
uP8Lhrj/C4a4/wuGuP8Lhrj/C4a4/wuGuf8Jlsb/Asbw/wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1f3/CZzL/wuGuP8LhrjeD4O2IwAAAAAAAAAA
AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAABSJxA0LhrmkCoe4/gqNvv8DxO7/Adf//wHX/v8B1///Adf//wHX//8B1///Adf//wHX
//8Czff/B6jW/wqRwv8Kjb7/Coq8/wqLvP8Kjb7/CpHC/wat2v8C0Pn/Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8EwOr/Coy9/wuGuP4MhbeZ
AYCzCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJhLdRCoa47wuHuf8Ho9H/AtL7/wHX//8B1///Adf//wHX
//8B1///Adf//wHX//8B1///Adf//wLP+P8Dw+z/BLzn/wS85/8Dw+3/AtH5/wHX//8B1v//Adf//wHX//8B1///Adf//wHX//8B1///Adf//wLR+/8In87/
C4a4/wuHuOsLh7hEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAn78IDIe5rguGuP8Libr/Bbjj/wHX
//8B1///ANf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1v//
Adf//wWy3v8LiLr/C4a4/wuGuJ4AgKoGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACYm2HAuG
uOILhrj/Coi6/wTA6/8B1v7/Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX/v8B1///ANf//wHX//8B1///Adf//wHX//8B1///ANf//wHX/v8B1v//
Adf//wHX//8B1f7/Bbzn/wuHuf8Lhrj/C4e42A6AqhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAA6FuEsLhrfkC4a4/wqOwf8Eu+f/AdX9/wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///Adf//wHX//8B1///
Adf//wHX//8B1///Adf//wHV/f8EuOT/Co2+/wuGuP8MhrndDIa6PwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAQAAAAAAAAAAAAAAAAAAAACAvwQKh7hoCoa48wuGuP8Kjb3/BbLf/wHW//8B1///Adf//wHX/v8B1///Adf//wHX//8B1///Adf//wHX//8B1///
Adf//wHX//8B1///Adf//wHX//8B1///Adb+/wau2/8Ki7z/C4a4/wuGuPALhbpcAKqqAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAgIACC4a4cAuGuO0Lhrj/Coa4/widzf8Dx/H/AdT8/wHX//8B1///Adf//wHX//8B1///
Adf//wHX//8B1v//Adf//wHX//8B1v//Adf//wHT/P8Dxe//CJrK/wuGuP8Lhrj/C4a46guGuGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA2JuVALhrjKC4a3/QuGuP8Kjr//B6XU/wS85/8Czff/
Adb+/wHX//8B1///Adf//wHX//8B1///Adf//wHW/v8CzPb/BLrm/wek0v8KjL7/C4a4/wuGuPwMh7jDC4e6RgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgAIQh7cgDIa4lguGuP0Lhrj/
C4a4/wqKvP8KkMH/CJzL/wat2v8FuOT/BL3o/wS96P8Ft+T/BqzZ/wiby/8KkMH/Coq7/wuGuP8Lhrj/C4a4+wuGuYsJibYcAICAAgAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAA6EuTYLhbeyC4a35wuGuPoLhrj/C4a4/wuGuP8Lhrj/C4a4/wuGuP8Lhrj/C4a4/wuGuP8Lhrj/C4a3+QuGuOUMhrerC4W3LgAAAAAAAAAAAAAAAAAA
AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAgL8ID4m7OAuHuHMLhriiC4a4yAuGuOULhrj3C4a4/guGuP4Lhrf2C4a44wyGuMYLh7ifC4W4bwqEtTQAgKoGAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAD//wEVgKoMC4q1GA+HvCINhrkoDIK4KwyCuCsNh7koD4u5IQuAtRgXirkLAQD/AQAA
AAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAA==
    ">
    <style>
        :root {
            /* Core layout variables */
            --pos-width: 150px;           /* Distance between horizontal positions */
            --platform-height: 110px;     /* Distance between platforms */
            --ground-height: 35px;        /* Height of ground */
            --platform-thickness: 30px;   /* Thickness of platforms */
            --pos-offset: 55px;           /* Offset for position 1 from left edge */
            --top-margin: 70px;           /* Extra space above topmost platform */
            --stage-height: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin)); /* Height of one stage */
            --item-offset: 34px;          /* Offset for items left of player position */
            --pickup-size: 28px;          /* Size of pick-uppable items and loot */
            --ladder-offset: 42px;        /* Horizontal offset for ladders */

            /* Warning walls */
            --warning-wall-width: 8px;   /* Width of warning walls */

            /* UI panels (inv-panel, counter-panel, nav-panel) */
            --panel-top: 10px;            /* Distance from top */
            --panel-left: 10px;           /* Distance from left (nav-panel) */
            --panel-right: 10px;          /* Distance from right */
            --panel-height: 40px;         /* Panel height */
            --panel-padding: 10px;        /* Panel padding */
            --panel-gap: 10px;            /* Gap between panels */
            --inv-panel-width: 160px;     /* padding (10) + 3 gaps (24) + 4 items (112) + padding (10) + border (4) */
            --counter-panel-width: 84px;  /* Counter panel width */
            --nav-panel-height: calc(var(--panel-height) * 2 + var(--panel-gap));
            --nav-panel-width: var(--nav-panel-height); /* square */

            /* Colors */
            --nav-arrow-color: #48d8d8;   /* Navigation arrow color */
            --inactive-arrow-color: #666; /* Inactive navigation arrow color */
            --gold-color: #ffd700;        /* Gold color for title and key */
            --aquamarine-color-1: #5ab0d0;
            --aquamarine-color-2: #78c8e8;
            --aquamarine-color-3: #a0e0f8;
            --aquamarine-color-4: #c8f0ff;
            --ruby-color-1: #c03020;
            --ruby-color-2: #d84838;
            --ruby-color-3: #f06858;
            --ruby-color-4: #ffa090;
            --battery-color: #4a9f4a;
            --bolt-color-1: #ffdd00;
            --bolt-color-2: #ffaa00;
            --barrel-color: #c48b9f;
            --flight-controls-unavailable: #c41616;
            --flight-controls-available: #1aa33a;
            --wrench-color: #708090;
            --axe-color: #cc1010;
            --idcard-color: #3090f0;
            --border-color: #4a4a6a;      /* Border color for UI elements */

            /* Z-index layers */
            --z-walls: 50;               /* Warning walls, rock walls */
            --z-loot-hover: 100;          /* loot hover areas */
            --z-item-hover: 100;          /* Item pickup hover areas */
            --z-climbables: 200;          /* Ladders, vines */
            --z-hazards: 300;             /* Hazards (poison, disease) */
            --z-scenery: 400;             /* Scenery (toolbox, door, tree) */
            --z-floating-item: 500;       /* Floating item icons when using items */
            --z-arrows: 600;              /* In-game navigation arrows */
            --z-darkness: 700;         /* Caves darkness */
            --z-items: 800;               /* Pickupable items (key, wrench, axe, battery, idcard, torch) */
            --z-loot: 800;            /* Loot (coins, gems) */
            --z-ui: 900;                  /* UI elements (title, inventory, counter) */
            --z-title-overlay: 1000;      /* Title screen overlay */
            --z-player: 1100;             /* Player (above title screen) */
            --z-tooltip: 1500;            /* Tooltips */
            --z-endgame-overlay: 2000;    /* Death and escape overlays */

            /* Darkness settings */
            --darkness-hole-width: 180px;     /* Width of the darkness hole (wide enough for nav arrows) */
            --darkness-hole-height: 120px;    /* Height of the darkness hole */
            --darkness-fuzzy-edge: 40px;      /* Fuzzy edge gradient size */
            --darkness-hole-offset: 30px;     /* Shift hole right to not look too far left */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: sans-serif;
        }

        .game-container {
            position: relative;
            width: calc(var(--pos-width) * 6);
            user-select: none;
            height: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin));
            background: #0f0f23;
            border: 3px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        /* Prompt to rotate device when in portrait on mobile */
        .rotate-prompt {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #1a1a2e;
            color: white;
            z-index: 10000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }
        .rotate-prompt svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            animation: rotate-hint 2s ease-in-out infinite;
        }
        .rotate-prompt p {
            font-size: 1.2em;
            margin: 0;
        }
        @keyframes rotate-hint {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(90deg); }
        }
        @media (max-width: 768px) and (orientation: portrait) {
            .rotate-prompt {
                display: flex;
            }
            .game-container {
                display: none;
            }
        }

        /* Scale to fit viewport on small screens (game height is 655px) */
        @media (max-height: 700px) {
            body {
                height: 100vh;
                min-height: auto;
                overflow: hidden;
            }
            .game-container {
                --game-width: calc(var(--pos-width) * 6);
                --game-height: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin));
                --scale-x: calc(100vw / var(--game-width));
                --scale-y: calc(100vh / var(--game-height));
                scale: min(var(--scale-x), var(--scale-y), 1);
            }
        }

        /* Level and position CSS variables for debug display */
        #level-0:checked ~ .game-world { --level: "L0"; }
        #level-1:checked ~ .game-world { --level: "L1"; }
        #level-2:checked ~ .game-world { --level: "L2"; }
        #level-3:checked ~ .game-world { --level: "L3"; }
        #level-4:checked ~ .game-world { --level: "L4"; }
        #level-5:checked ~ .game-world { --level: "L5"; }
        #level-6:checked ~ .game-world { --level: "L6"; }
        #level-7:checked ~ .game-world { --level: "L7"; }
        #level-8:checked ~ .game-world { --level: "L8"; }
        #level-9:checked ~ .game-world { --level: "L9"; }
        #pos-1:checked ~ .game-world { --pos: "P1"; }
        #pos-2:checked ~ .game-world { --pos: "P2"; }
        #pos-3:checked ~ .game-world { --pos: "P3"; }
        #pos-4:checked ~ .game-world { --pos: "P4"; }
        #pos-5:checked ~ .game-world { --pos: "P5"; }
        #pos-6:checked ~ .game-world { --pos: "P6"; }
        #pos-7:checked ~ .game-world { --pos: "P7"; }
        #pos-8:checked ~ .game-world { --pos: "P8"; }
        #pos-9:checked ~ .game-world { --pos: "P9"; }
        #pos-10:checked ~ .game-world { --pos: "P10"; }
        #pos-11:checked ~ .game-world { --pos: "P11"; }
        #pos-12:checked ~ .game-world { --pos: "P12"; }
        #pos-13:checked ~ .game-world { --pos: "P13"; }
        #pos-14:checked ~ .game-world { --pos: "P14"; }
        #pos-15:checked ~ .game-world { --pos: "P15"; }
        #pos-16:checked ~ .game-world { --pos: "P16"; }
        #pos-17:checked ~ .game-world { --pos: "P17"; }
        #pos-18:checked ~ .game-world { --pos: "P18"; }
        #pos-φ:checked ~ .game-world { --pos: "Pφ"; }

        .game-world {
            position: absolute;
            top: calc(var(--stage-height) * -1);
            left: 0;
            width: calc(var(--pos-width) * 18);
            /* Height for 2 vertical stages: S1/S4 at bottom, S2/S3 at top */
            height: calc(var(--stage-height) * 2);
            transition: translate 0.5s ease;
            translate: var(--world-translateX, 0) var(--world-translateY, 0);
            /* Inventory tracking variables (0 = not in inventory, 1 = in inventory) */
            --inv-has-key: 0;
            --inv-has-wrench: 0;
            --inv-has-axe: 0;
            --inv-has-idcard: 0;
            --inv-has-battery: 0;
            --inv-has-torch: 0;
            /* Inventory slot positioning */
            --inv-slot-width: calc(var(--pickup-size) + 8px);  /* item width + gap */
        }

        /*
         * Viewport scrolling via CSS variables
         * Stage layout:
         *   S0 - S2 - S3
         *   S1 - S4 - S5
         * Levels 0-4 are bottom row (S1, S4, S5), levels 5-9 are top row (S0, S2, S3)
         * Positions 1-6 are left column, 7-12 middle column, 13-18 right column
         */

        /* Vertical: levels 0-4 show bottom row (default top offset shows S1/S4/S5) */
        /* Levels 5-9 show top row - need to scroll up by one stage-height */
        #level-5:checked ~ .game-world,
        #level-6:checked ~ .game-world,
        #level-7:checked ~ .game-world,
        #level-8:checked ~ .game-world,
        #level-9:checked ~ .game-world {
            --world-translateY: var(--stage-height);
        }

        /* Horizontal: positions 7-12 scroll left by 6 positions */
        #pos-7:checked ~ .game-world,
        #pos-8:checked ~ .game-world,
        #pos-9:checked ~ .game-world,
        #pos-10:checked ~ .game-world,
        #pos-11:checked ~ .game-world,
        #pos-12:checked ~ .game-world {
            --world-translateX: calc(var(--pos-width) * -6);
        }

        /* Horizontal: positions 13-18 and φ scroll left by 12 positions */
        #pos-13:checked ~ .game-world,
        #pos-14:checked ~ .game-world,
        #pos-15:checked ~ .game-world,
        #pos-16:checked ~ .game-world,
        #pos-17:checked ~ .game-world,
        #pos-18:checked ~ .game-world,
        #pos-φ:checked ~ .game-world {
            --world-translateX: calc(var(--pos-width) * -12);
        }

        /* S1 (pos 1-6, levels 0-4): no translate to avoid stacking context on title screen */
        /* This rule must come AFTER the level-based translateY rules so it overrides them */
        /* Level checks included to allow future S0 implementation (pos 1-6, levels 5-9) */
        #level-0:checked ~ #pos-1:checked ~ .game-world,
        #level-0:checked ~ #pos-2:checked ~ .game-world,
        #level-0:checked ~ #pos-3:checked ~ .game-world,
        #level-0:checked ~ #pos-4:checked ~ .game-world,
        #level-0:checked ~ #pos-5:checked ~ .game-world,
        #level-0:checked ~ #pos-6:checked ~ .game-world,
        #level-1:checked ~ #pos-1:checked ~ .game-world,
        #level-1:checked ~ #pos-2:checked ~ .game-world,
        #level-1:checked ~ #pos-3:checked ~ .game-world,
        #level-1:checked ~ #pos-4:checked ~ .game-world,
        #level-1:checked ~ #pos-5:checked ~ .game-world,
        #level-1:checked ~ #pos-6:checked ~ .game-world,
        #level-2:checked ~ #pos-1:checked ~ .game-world,
        #level-2:checked ~ #pos-2:checked ~ .game-world,
        #level-2:checked ~ #pos-3:checked ~ .game-world,
        #level-2:checked ~ #pos-4:checked ~ .game-world,
        #level-2:checked ~ #pos-5:checked ~ .game-world,
        #level-2:checked ~ #pos-6:checked ~ .game-world,
        #level-3:checked ~ #pos-1:checked ~ .game-world,
        #level-3:checked ~ #pos-2:checked ~ .game-world,
        #level-3:checked ~ #pos-3:checked ~ .game-world,
        #level-3:checked ~ #pos-4:checked ~ .game-world,
        #level-3:checked ~ #pos-5:checked ~ .game-world,
        #level-3:checked ~ #pos-6:checked ~ .game-world,
        #level-4:checked ~ #pos-1:checked ~ .game-world,
        #level-4:checked ~ #pos-2:checked ~ .game-world,
        #level-4:checked ~ #pos-3:checked ~ .game-world,
        #level-4:checked ~ #pos-4:checked ~ .game-world,
        #level-4:checked ~ #pos-5:checked ~ .game-world,
        #level-4:checked ~ #pos-6:checked ~ .game-world {
            translate: none;
        }

        /* Inventory state tracking: set variables when items picked up */
        #key-pickup:checked ~ .game-world { --inv-has-key: 1; }
        #wrench-pickup:checked ~ .game-world { --inv-has-wrench: 1; }
        #axe-pickup:checked ~ .game-world { --inv-has-axe: 1; }
        #idcard-pickup:checked ~ .game-world { --inv-has-idcard: 1; }
        #battery-pickup:checked ~ .game-world { --inv-has-battery: 1; }
        #torch-pickup:checked ~ .game-world { --inv-has-torch: 1; }
        /* Reset when items consumed */
        #toolbox-unlocked:checked ~ .game-world { --inv-has-key: 0; }
        #door-unlocked:checked ~ .game-world { --inv-has-wrench: 0; }
        #tree-chopped:checked ~ .game-world { --inv-has-axe: 0; }
        #bolt-fixed:checked ~ .game-world { --inv-has-battery: 0; }

        .platform {
            position: absolute;
            height: var(--platform-thickness);
            background: #8b4513;
            border: 3px solid #5d2e0a;
            border-radius: 4px;
            box-shadow: inset 0 -5px 0 #0000004d;
        }

        /* Platform 1 (lowest): 5/6 width, aligned right in Stage 1 */
        .platform-S1-L1 {
            bottom: var(--platform-height);
            left: var(--pos-width);
            width: calc(var(--pos-width) * 5 - var(--warning-wall-width) - 4px);
        }

        /* Platform 2 (third from above): split in Stage 1 */
        .platform-S1-L2-left {
            bottom: calc(var(--platform-height) * 2);
            left: var(--warning-wall-width);
            width: calc(var(--pos-width) * 4 - var(--warning-wall-width));
        }

        .platform-S1-L2-right {
            bottom: calc(var(--platform-height) * 2);
            left: calc(var(--pos-width) * 5);
            width: calc(var(--pos-width) - var(--warning-wall-width) - 4px);
        }

        /* Platform 3 (second from above): split with gap at position 3 */
        .platform-S1-L3-left {
            bottom: calc(var(--platform-height) * 3);
            left: var(--warning-wall-width);
            width: calc(var(--pos-width) * 2 - var(--warning-wall-width));
        }

        .platform-S1-L3-right {
            bottom: calc(var(--platform-height) * 3);
            left: calc(var(--pos-width) * 3);
            width: calc(var(--pos-width) * 3 - var(--warning-wall-width) - 4px);
        }

        /* Platform 4 (top): 5/6 width, aligned left */
        .platform-S1-L4 {
            bottom: calc(var(--platform-height) * 4);
            left: var(--warning-wall-width);
            width: calc(var(--pos-width) * 5 - var(--warning-wall-width));
        }

        /* Stage 1 platforms are reddish-gray (rusted metal) with rivets */
        .platform-S1-L1,
        .platform-S1-L2-left,
        .platform-S1-L2-right,
        .platform-S1-L3-left,
        .platform-S1-L3-right,
        .platform-S1-L4 {
            background:
                radial-gradient(circle at 15px 50%, #2a2a2a 3px, transparent 3px),
                radial-gradient(circle at calc(100% - 15px) 50%, #2a2a2a 3px, transparent 3px),
                linear-gradient(to bottom, #6b5555 0%, #4a3c3c 100%);
            border-color: #5a4a4a;
        }

        /* Stage 2 Platforms (positioned above S4, offset by stage-height) */
        .platform-S2-L6-left {
            bottom: calc(var(--stage-height) + var(--platform-height));
            left: calc(var(--pos-width) * 7);
            width: calc(var(--pos-width) * 3);
        }
        .platform-S2-L6-right {
            bottom: calc(var(--stage-height) + var(--platform-height));
            left: calc(var(--pos-width) * 11);
            width: calc(var(--pos-width) - 6px);
        }
        .platform-S2-L7-left {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
            left: calc(var(--pos-width) * 6 + 12px);
            width: calc(var(--pos-width) - 12px);
        }
        .platform-S2-L7-right {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
            left: calc(var(--pos-width) * 8);
            width: calc(var(--pos-width) * 4 - 6px);
        }
        .platform-S2-L8-left {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3);
            left: calc(var(--pos-width) * 6 + 12px);
            width: calc(var(--pos-width) * 3 - 12px);
        }
        .platform-S2-L8-right {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3);
            left: calc(var(--pos-width) * 10);
            width: calc(var(--pos-width) * 2 - 6px);
        }
        .platform-S2-L9 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4);
            left: calc(var(--pos-width) * 7);
            width: calc(var(--pos-width) * 5 - 6px);
        }

        /* Stage 2 platforms are green */
        .platform-S2-L6-left,
        .platform-S2-L6-right,
        .platform-S2-L7-left,
        .platform-S2-L7-right,
        .platform-S2-L8-left,
        .platform-S2-L8-right,
        .platform-S2-L9 {
            background: #2e8b2e;
            border-color: #1a5c1a;
        }

        /* Stage 3 Platforms (same vertical level as S2) */
        .platform-S3-L4 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4);
            left: calc(var(--pos-width) * 12);
            width: calc(var(--pos-width) * 3); /* P1-P3 only, gaps at P4 and P6 */
        }

        /* Stage 3 platforms are cool bluish grey metallic */
        .platform-S3-L4 {
            background: #6a7b8c;
            border-color: #4a5a6a;
        }

        /* Stage 4 Platforms (caves, levels 0-4, positions 7-12) */
        .platform-S4-L4-P8 {
            bottom: calc(var(--platform-height) * 4);
            left: calc(var(--pos-width) * 7 - 10px);
            width: calc(var(--pos-width) + 20px);
        }
        .platform-S4-L3-P7 {
            bottom: calc(var(--platform-height) * 3);
            left: calc(var(--pos-width) * 6 + 12px);
            width: calc(var(--pos-width) - 12px + 10px);
        }
        .platform-S4-L3-P9 {
            bottom: calc(var(--platform-height) * 3);
            left: calc(var(--pos-width) * 8 - 10px);
            width: calc(var(--pos-width) + 10px);
        }
        .platform-S4-L3-P12 {
            bottom: calc(var(--platform-height) * 3);
            left: calc(var(--pos-width) * 11);
            width: calc(var(--pos-width) - 12px - 4px);
        }
        .platform-S4-L2-P8 {
            bottom: calc(var(--platform-height) * 2);
            left: calc(var(--pos-width) * 7);
            width: calc(var(--pos-width) + 10px);
        }
        .platform-S4-L2-P10 {
            bottom: calc(var(--platform-height) * 2);
            left: calc(var(--pos-width) * 9);
            width: var(--pos-width);
        }
        .platform-S4-L2-P12 {
            bottom: calc(var(--platform-height) * 2);
            left: calc(var(--pos-width) * 11);
            width: calc(var(--pos-width) - 12px - 4px);
        }
        .platform-S4-L1-P10-P11 {
            bottom: var(--platform-height);
            left: calc(var(--pos-width) * 9);
            width: calc(var(--pos-width) * 2);
        }

        /* Stage 4 platforms are brown soil with bluish-grey fuzzy streaks */
        .platform-S4-L4-P8,
        .platform-S4-L3-P7,
        .platform-S4-L3-P9,
        .platform-S4-L3-P12,
        .platform-S4-L2-P8,
        .platform-S4-L2-P10,
        .platform-S4-L2-P12,
        .platform-S4-L1-P10-P11 {
            background:
                /* Bluish-grey fuzzy streaks (10:1 ratio, vertically spread) */
                radial-gradient(ellipse 50px 5px at 25% 25%, #64788c66 0%, #64788c33 50%, transparent 80%),
                radial-gradient(ellipse 45px 4px at 65% 75%, #5a6e8259 0%, #5a6e8226 50%, transparent 80%),
                /* Base soil gradient */
                linear-gradient(to bottom, #6b5344 0%, #4a3728 100%);
            border-color: #3a2a1a;
        }

        /* Stage 4 stalagmites */
        .stalagmite-S4 {
            position: absolute;
            color: #4a3a2a;
            filter: drop-shadow(2px 0 2px #66aaff80);
        }
        .stalagmite-S4 svg {
            width: 100%;
            height: 100%;
        }
        .stalagmite-S4-L3-P10-P11 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 12px);
            left: calc(var(--pos-width) * 10 - 27px);
            width: 48px;
            height: 115px;
        }
        .stalagmite-S4-L3-P11-P12 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-width) * 11 - 7px);
            width: 40px;
            height: 84px;
        }
        .stalagmite-S4-L0-P8-P9 {
            bottom: calc(var(--ground-height) - 7px);
            left: calc(var(--pos-width) * 8 - 30px);
            width: 60px;
            height: 108px;
        }

        /* Stage 4 stalactites */
        .stalactite-S4 {
            position: absolute;
            color: #4a3a2a;
            filter: drop-shadow(2px 0 2px #66aaff80);
        }
        .stalactite-S4 svg {
            width: 100%;
            height: 100%;
        }
        .stalactite-S4-L4-P9-P10 {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) - 5px);
            left: calc(var(--pos-width) * 9 - 24px);
            width: 48px;
            height: 84px;
        }
        .stalactite-S4-L1-P7-P8 {
            bottom: calc(var(--platform-height) * 1 + var(--platform-thickness) - 3px);
            left: calc(var(--pos-width) * 7 - 12px);
            width: 48px;
            height: 84px;
        }
        .stalactite-S4-L1-P9-P10 {
            bottom: calc(var(--platform-height) * 1 + var(--platform-thickness) - 3px);
            left: calc(var(--pos-width) * 9 - 12px);
            width: 48px;
            height: 84px;
        }
        .stalagmite-S4-L1-P9-P10 {
            bottom: calc(var(--platform-height) * 1 + var(--platform-thickness) - 5px);
            left: calc(var(--pos-width) * 9 - 6px);
            width: 48px;
            height: 86px;
        }
        .stalactite-S4-L2-P10-P11 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 20px);
            left: calc(var(--pos-width) * 10 - 28px);
            width: 48px;
            height: 84px;
        }
        .stalagmite-S4-L2-P10-P11 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-width) * 10 - 39px);
            width: 50px;
            height: 96px;
            filter: none;
        }
        .stalactite-S4-L3-P7-P8 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 3px);
            left: calc(var(--pos-width) * 7 - 21px);
            width: 48px;
            height: 84px;
        }
        .stalagmite-S4-L3-P7-P8 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-width) * 7 - 30px);
            width: 44px;
            height: 84px;
            filter: none;
        }
        .stalactite-S4-L3-P8-P9 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 1px);
            left: calc(var(--pos-width) * 8 - 32px);
            width: 48px;
            height: 84px;
        }
        .stalagmite-S4-L3-P8-P9 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-width) * 8 - 16px);
            width: 40px;
            height: 70px;
        }
        .stalactite-S4-L2-P8-P9 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) - 3px);
            left: calc(var(--pos-width) * 8 - 22px);
            width: 48px;
            height: 84px;
        }
        .stalagmite-S4-L2-P8-P9 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-width) * 8 - 33px);
            width: 47px;
            height: 89px;
            filter: none;
        }

        /* Grate (diamond mesh pattern) */
        .grate {
            position: absolute;
            width: var(--pos-width);
            height: 14px;
            background:
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    transparent 4px,
                    #888 4px,
                    #888 6px,
                    transparent 6px,
                    transparent 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0px,
                    transparent 4px,
                    #888 4px,
                    #888 6px,
                    transparent 6px,
                    transparent 10px
                );
            border-top: 2px solid #aaa;
            border-bottom: 2px solid #555;
        }
        .grate::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 100%;
            height: 100%;
            background:
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    transparent 4px,
                    #222 4px,
                    #222 6px,
                    transparent 6px,
                    transparent 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0px,
                    transparent 4px,
                    #222 4px,
                    #222 6px,
                    transparent 6px,
                    transparent 10px
                );
            opacity: 0.4;
            z-index: -1;
        }
        .grate-S1-L1-P1 {
            bottom: calc(var(--platform-height) + var(--platform-thickness) - 16px);
            left: 0;
        }
        .grate-S1-L2-P5 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 4);
        }
        .grate-S1-L3-P3 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 2);
        }
        .grate-S1-L4-P6 {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 5);
        }

        /* Stage 3 grates (positioned above S4, same height as S2) */
        .grate-S3-L7-P13-P14 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 12);
            width: calc(var(--pos-width) * 2);
        }
        .grate-S3-L6-P13-P14 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 12);
            width: calc(var(--pos-width) * 2);
        }
        .grate-S3-L8-P13-P14 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) - 16px);
            left: calc(var(--pos-width) * 12);
            width: calc(var(--pos-width) * 2);
        }
        .platform-S3-L9-P17-floating {
            position: absolute;
            bottom: calc(var(--stage-height) + var(--platform-height) * 4);
            left: calc(var(--pos-width) * 16);
            width: var(--pos-width);
            height: var(--platform-thickness);
            background: #6a7b8c;
            border: 3px solid #4a5a6a;
            border-radius: 4px;
            box-shadow: inset 0 -5px 0 #0000004d;
        }

        /* Bolt S3-L1-P3 */
        .bolt {
            position: absolute;
            bottom: calc(var(--stage-height) + var(--platform-height) * 1 + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset));
            width: 20px;
            height: 24px;
            color: var(--bolt-color-1);
        }
        .bolt svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 4px var(--bolt-color-1));
            animation: bolt-flicker 2s steps(1) infinite;
        }
        .bolt .tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .bolt:hover {
            z-index: var(--z-tooltip);
        }
        .bolt:hover .tooltip {
            opacity: 1;
        }
        /* Hide bolt when fixed */
        #bolt-fixed:checked ~ .game-world .bolt {
            display: none;
        }
        /* Battery floating above bolt */
        .battery-at-bolt {
            position: absolute;
            width: 20px;
            height: 20px;
            bottom: calc(var(--stage-height) + var(--platform-height) * 1 + var(--platform-thickness) + 35px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) - 2px);
            z-index: var(--z-floating-item);
            display: none;
            cursor: pointer;
        }
        .battery-at-bolt svg {
            width: 100%;
            height: 100%;
            color: #50c050;
        }
        /* Show battery at bolt when player is next to it, has battery, AND bolt not yet fixed (S3 uses levels 5-9) */
        #level-6:checked ~ #pos-15:checked ~ #battery-pickup:checked ~ #bolt-fixed:not(:checked) ~ .game-world .battery-at-bolt {
            display: block;
            animation: battery-hovering-pulse 1s ease-in-out infinite;
        }
        /* Installed battery (shown after bolt is fixed) */
        .battery-installed {
            position: absolute;
            width: 20px;
            height: 24px;
            bottom: calc(var(--stage-height) + var(--platform-height) * 1 + var(--platform-thickness) + 5px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset));
            color: #50c050;
            display: none;
        }
        .battery-installed svg {
            width: 100%;
            height: 100%;
        }
        .battery-installed .tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .battery-installed:hover {
            z-index: var(--z-tooltip);
        }
        .battery-installed:hover .tooltip {
            opacity: 1;
        }
        #bolt-fixed:checked ~ .game-world .battery-installed {
            display: block;
        }

        /* Control button S3-L2-P3 */
        .flight-controls-unavailable {
            position: absolute;
            width: calc(var(--pickup-size) * 1.7);
            height: calc(var(--pickup-size) * 2);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 10px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) - 8px);
            pointer-events: none;
            color: var(--flight-controls-unavailable);
        }
        .flight-controls-unavailable svg {
            width: 100%;
            height: 100%;
        }
        .flight-controls-hover-area {
            position: absolute;
            width: calc(var(--pickup-size) * 1.7);
            height: calc(var(--pickup-size) * 2);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 10px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) - 8px);
            pointer-events: auto;
            z-index: 1;
        }
        /* Hide hover area when player is at button with ID card and bolt fixed (so label click works) - S3 uses levels 5-9 */
        #level-7:checked ~ #pos-15:checked ~ #idcard-pickup:checked ~ #bolt-fixed:checked ~ #flight-controls-used:not(:checked) ~ .game-world .flight-controls-hover-area {
            display: none;
        }
        /* Enable hover on control button when player is at position with ID card and bolt fixed */
        #level-7:checked ~ #pos-15:checked ~ #idcard-pickup:checked ~ #bolt-fixed:checked ~ #flight-controls-used:not(:checked) ~ .game-world .flight-controls-unavailable {
            pointer-events: auto;
        }
        /* Gray out button when bolt is not fixed */
        #bolt-fixed:not(:checked) ~ .game-world .flight-controls-unavailable {
            animation: flight-controls-offline 2s ease-in-out infinite;
        }
        /* ID card floating above control button */
        .idcard-at-controls {
            position: absolute;
            width: 24px;
            height: 24px;
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) + 41px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) + 4px);
            z-index: var(--z-floating-item);
            display: none;
            cursor: pointer;
        }
        .idcard-at-controls svg {
            width: 100%;
            height: 100%;
            color: var(--idcard-color);
        }
        /* Show ID card at button when player is next to it, has ID card, bolt fixed, AND button not yet pressed - S3 uses levels 5-9 */
        #level-7:checked ~ #pos-15:checked ~ #idcard-pickup:checked ~ #bolt-fixed:checked ~ #flight-controls-used:not(:checked) ~ .game-world .idcard-at-controls {
            display: block;
            animation: idcard-hovering-pulse 1s ease-in-out infinite;
        }
        .flight-controls-unavailable .tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .flight-controls-unavailable:hover {
            z-index: var(--z-tooltip);
        }
        .flight-controls-hover-area:hover ~ .flight-controls-unavailable {
            z-index: var(--z-tooltip);
        }
        /* Show "no power" tooltip when bolt not fixed */
        .flight-controls-unavailable .tooltip-no-idcard {
            display: none;
        }
        #bolt-fixed:not(:checked) ~ .game-world .flight-controls-unavailable:hover .tooltip-no-power,
        #bolt-fixed:not(:checked) ~ .game-world .flight-controls-hover-area:hover ~ .flight-controls-unavailable .tooltip-no-power {
            opacity: 1;
        }
        /* Show "no ID card" tooltip when bolt fixed */
        #bolt-fixed:checked ~ .game-world .flight-controls-unavailable .tooltip-no-power {
            display: none;
        }
        #bolt-fixed:checked ~ .game-world .flight-controls-unavailable .tooltip-no-idcard {
            display: block;
        }
        #bolt-fixed:checked ~ .game-world .flight-controls-unavailable:hover .tooltip-no-idcard,
        #bolt-fixed:checked ~ .game-world .flight-controls-hover-area:hover ~ .flight-controls-unavailable .tooltip-no-idcard {
            opacity: 1;
        }
        /* Hide red button when pressed, show green button */
        #flight-controls-used:checked ~ .game-world .flight-controls-unavailable {
            display: none;
        }
        #flight-controls-used:checked ~ .game-world .flight-controls-hover-area {
            display: none;
        }
        /* Green button (shown when flight-controls-used is checked) */
        .flight-controls-available {
            position: absolute;
            width: calc(var(--pickup-size) * 1.7);
            height: calc(var(--pickup-size) * 2);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 10px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) - 8px);
            display: none;
            cursor: pointer;
            color: var(--flight-controls-available);
        }
        .flight-controls-available svg {
            width: 100%;
            height: 100%;
        }
        .flight-controls-available .tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .flight-controls-available:hover {
            z-index: var(--z-tooltip);
        }
        .flight-controls-available:hover .tooltip {
            opacity: 1;
        }
        #flight-controls-used:checked ~ .game-world .flight-controls-available {
            display: block;
            pointer-events: none;
        }
        /* Hover area for green button tooltip (when not adjacent) */
        .flight-controls-available-hover-area {
            position: absolute;
            width: calc(var(--pickup-size) * 1.7);
            height: calc(var(--pickup-size) * 2);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 10px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset) - 8px);
            display: none;
            pointer-events: auto;
            z-index: 1;
        }
        #flight-controls-used:checked ~ .game-world .flight-controls-available-hover-area {
            display: block;
        }
        /* Hide hover area when player is at L7-P15 (so label click works) */
        #level-7:checked ~ #pos-15:checked ~ #flight-controls-used:checked ~ .game-world .flight-controls-available-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        #flight-controls-used:checked ~ .game-world .flight-controls-available-hover-area:hover ~ .flight-controls-available .tooltip {
            opacity: 1;
        }
        #flight-controls-used:checked ~ .game-world .flight-controls-available-hover-area:hover ~ .flight-controls-available {
            z-index: var(--z-tooltip);
        }
        /* Enable clicking green button only when player is next to it - S3 uses levels 5-9 */
        #level-7:checked ~ #pos-15:checked ~ #flight-controls-used:checked ~ .game-world .flight-controls-available {
            pointer-events: auto;
        }

        /* Stage 2 Branches (replaces grates) */
        .branch {
            position: absolute;
            width: var(--pos-width);
            height: 12px;
            background: linear-gradient(to bottom,
                #8b5a2b 0%,
                #a0522d 30%,
                #8b4513 50%,
                #6b3e0a 70%,
                #5d3a1a 100%
            );
            border-radius: 6px 6px 4px 4px;
            box-shadow:
                0 3px 2px #00000066,
                inset 0 1px 0 #ffffff33;
        }
        .branch::before {
            content: '';
            position: absolute;
            top: 3px;
            left: 15%;
            width: 8px;
            height: 6px;
            background: #5d3a1a;
            border-radius: 50%;
            box-shadow:
                25px -1px 0 #6b3e0a,
                50px 1px 0 #5d3a1a;
        }
        .branch-S2-L6-P7 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) - 14px);
            left: calc(var(--pos-width) * 6 + 12px);
            width: calc(var(--pos-width) - 12px);
        }
        .branch-S2-L6-P11 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) - 14px);
            left: calc(var(--pos-width) * 10);
        }
        .branch-S2-L7-P8 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 14px);
            left: calc(var(--pos-width) * 7);
        }
        .branch-S2-L8-P10 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) - 14px);
            left: calc(var(--pos-width) * 9);
        }
        .branch-S2-L9-P7 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) - 14px);
            left: calc(var(--pos-width) * 6 + 12px);
            width: calc(var(--pos-width) - 12px);
        }

        /* Title screen toggle */
        #title-screen-toggle {
            display: none;
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 10000;
        }
        #debug-toggle:checked ~ #title-screen-toggle {
            display: block;
        }

        /* Debug toggle - press Alt+D (or Alt+Shift+D on Mac) to toggle */
        #debug-toggle {
            display: none;
        }
        #debug-toggle:checked {
            display: none;
        }
        /* Hide radio buttons and checkboxes by default */
        .position-radio, .level-radio, .key-checkbox, .toolbox-checkbox, .wrench-checkbox, .axe-checkbox, .battery-checkbox, .idcard-checkbox, .torch-checkbox, .tree-checkbox, .escaped-checkbox, .darkness-checkbox, .loot-checkbox, .door-checkbox, .flight-controls-checkbox {
            display: none;
            /* When unhidden for debugging: */
            z-index: 9999;
            position: fixed;
        }
        /* Debug positions - levels (single column on left, level-9 on top, level-0 on bottom) */
        #level-9 { top: 30px; left: 10px; }
        #level-8 { top: 50px; left: 10px; }
        #level-7 { top: 70px; left: 10px; }
        #level-6 { top: 90px; left: 10px; }
        #level-5 { top: 110px; left: 10px; }
        #level-4 { top: 140px; left: 10px; }
        #level-3 { top: 160px; left: 10px; }
        #level-2 { top: 180px; left: 10px; }
        #level-1 { top: 200px; left: 10px; }
        #level-0 { top: 220px; left: 10px; }
        /* Debug positions - positions (row 1) */
        #pos-1 { top: 10px; left: 30px; }
        #pos-2 { top: 10px; left: 50px; }
        #pos-3 { top: 10px; left: 70px; }
        #pos-4 { top: 10px; left: 90px; }
        #pos-5 { top: 10px; left: 110px; }
        #pos-6 { top: 10px; left: 130px; }
        #pos-7 { top: 10px; left: 160px; }
        #pos-8 { top: 10px; left: 180px; }
        #pos-9 { top: 10px; left: 200px; }
        #pos-10 { top: 10px; left: 220px; }
        #pos-11 { top: 10px; left: 240px; }
        #pos-12 { top: 10px; left: 260px; }
        /* Debug positions - S3 */
        #pos-13 { top: 10px; left: 290px; }
        #pos-14 { top: 10px; left: 310px; }
        #pos-15 { top: 10px; left: 330px; }
        #pos-16 { top: 10px; left: 350px; }
        #pos-17 { top: 10px; left: 370px; }
        #pos-18 { top: 10px; left: 390px; }
        #pos-φ { top: 10px; left: 420px; }
        /* Debug positions - S1 loot (next to L6) */
        #loot-S1-L0-P3-pickup { top: 90px; left: 30px; }
        #loot-S1-L1-P4-pickup { top: 90px; left: 50px; }
        #loot-S1-L3-P5-pickup { top: 90px; left: 70px; }
        #loot-S1-L2-P1-pickup { top: 90px; left: 90px; }
        #loot-S1-L4-P2-pickup { top: 90px; left: 110px; }
        #loot-S2-L5-P8-pickup { top: 30px; left: 160px; }
        #loot-S2-L6-P11-pickup { top: 30px; left: 180px; }
        #loot-S2-L7-P7-pickup { top: 30px; left: 200px; }
        #loot-S2-L8-P9-pickup { top: 30px; left: 220px; }
        #loot-S2-L9-P10-pickup { top: 30px; left: 240px; }
        #loot-S3-L5-P15-pickup { top: 30px; left: 290px; }
        #loot-S3-L5-P18-pickup { top: 30px; left: 310px; }
        #loot-S3-L8-P18-pickup { top: 30px; left: 330px; }
        #loot-S3-L9-P14-pickup { top: 30px; left: 350px; }
        /* Debug positions - S4 loot */
        #loot-S4-L3-P7-pickup { top: 90px; left: 160px; }
        #loot-S4-L3-P8-pickup { top: 90px; left: 180px; }
        #loot-S4-L3-P12-pickup { top: 90px; left: 200px; }
        #loot-S4-L1-P10-pickup { top: 90px; left: 220px; }
        #loot-S4-L0-P9-pickup { top: 90px; left: 240px; }
        /* Debug positions - S1 items (next to L5) */
        #key-pickup { top: 110px; left: 30px; }
        #toolbox-unlocked { top: 110px; left: 50px; }
        #wrench-pickup { top: 110px; left: 70px; }
        #door-unlocked { top: 110px; left: 90px; }
        #idcard-pickup { top: 50px; left: 160px; }
        #tree-chopped { top: 50px; left: 180px; }
        #axe-pickup { top: 50px; left: 290px; }
        #battery-pickup { top: 50px; left: 310px; }
        #bolt-fixed { top: 50px; left: 330px; }
        #flight-controls-used { top: 50px; left: 350px; }
        #escaped { top: 50px; left: 370px; }
        #darkness-toggle { top: 110px; left: 160px; }
        #torch-pickup { top: 110px; left: 180px; }
        /* Show inputs when debug is checked */
        #debug-toggle:checked ~ .game-container .position-radio,
        #debug-toggle:checked ~ .game-container .level-radio,
        #debug-toggle:checked ~ .game-container .key-checkbox,
        #debug-toggle:checked ~ .game-container .toolbox-checkbox,
        #debug-toggle:checked ~ .game-container .wrench-checkbox,
        #debug-toggle:checked ~ .game-container .axe-checkbox,
        #debug-toggle:checked ~ .game-container .idcard-checkbox,
        #debug-toggle:checked ~ .game-container .battery-checkbox,
        #debug-toggle:checked ~ .game-container .torch-checkbox,
        #debug-toggle:checked ~ .game-container .tree-checkbox,
        #debug-toggle:checked ~ .game-container .escaped-checkbox,
        #debug-toggle:checked ~ .game-container .darkness-checkbox,
        #debug-toggle:checked ~ .game-container .loot-checkbox,
        #debug-toggle:checked ~ .game-container .door-checkbox,
        #debug-toggle:checked ~ .game-container .flight-controls-checkbox {
            display: block;
        }

        /* Inventory area */
        .inv-panel {
            position: absolute;
            top: var(--panel-top);
            right: var(--panel-right);
            width: var(--inv-panel-width);
            height: var(--panel-height);
            border: 2px solid var(--border-color);
            border-radius: 4px;
            background: #0000004d;
            display: flex;
            flex-direction: row-reverse;
            align-items: center;
            justify-content: flex-start;
            padding-left: var(--panel-padding);
            padding-right: var(--panel-padding);
            gap: 8px;
            z-index: var(--z-ui);
        }
        /* Inventory item icons - hidden by default (display: none so they don't take space in flexbox) */
        .inventory-key,
        .inventory-wrench,
        .inventory-axe,
        .inventory-idcard,
        .inventory-battery,
        .inventory-torch {
            width: var(--pickup-size);
            height: var(--pickup-size);
            display: none;
            justify-content: center;
            align-items: center;
        }
        .inventory-key svg,
        .inventory-wrench svg,
        .inventory-axe svg,
        .inventory-idcard svg,
        .inventory-battery svg,
        .inventory-torch svg {
            width: 24px;
            height: 24px;
        }
        .inventory-key svg { color: var(--gold-color); }
        .inventory-wrench svg { color: var(--wrench-color); }
        .inventory-axe svg { color: var(--wrench-color); }
        .inventory-idcard svg { color: var(--idcard-color); }
        .inventory-battery svg { color: var(--battery-color); }
        /* Torch has its own colors in the SVG */
        /* Show inventory items when picked up (delayed fade-in after fly animation) */
        #key-pickup:checked ~ .inv-panel .inventory-key,
        #wrench-pickup:checked ~ .inv-panel .inventory-wrench,
        #axe-pickup:checked ~ .inv-panel .inventory-axe,
        #idcard-pickup:checked ~ .inv-panel .inventory-idcard,
        #battery-pickup:checked ~ .inv-panel .inventory-battery,
        #torch-pickup:checked ~ .inv-panel .inventory-torch {
            display: flex;
            opacity: 0;
            animation: inventory-fade-in 0.2s ease-out 0.4s forwards;
        }
        /* Hide key from inventory when toolbox is unlocked (key used) */
        #toolbox-unlocked:checked ~ .inv-panel .inventory-key {
            display: none;
        }
        /* Hide axe from inventory when tree is chopped (axe used) */
        #tree-chopped:checked ~ .inv-panel .inventory-axe {
            display: none;
        }
        /* Hide wrench from inventory when door is unlocked (wrench used) */
        #door-unlocked:checked ~ .inv-panel .inventory-wrench {
            display: none;
        }
        /* Hide battery from inventory when bolt is fixed (battery used) */
        #bolt-fixed:checked ~ .inv-panel .inventory-battery {
            display: none;
        }
        /* Hide torch from inventory when in S4 (shown next to player instead) */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~
        :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~
        .inv-panel .inventory-torch {
            display: none !important;
        }

        /* loot counter box */
        .counter-panel {
            position: absolute;
            top: calc(var(--panel-top) + var(--panel-height) + var(--panel-gap));
            right: var(--panel-right);
            width: var(--counter-panel-width);
            height: var(--panel-height);
            border: 2px solid var(--border-color);
            border-radius: 4px;
            background: #0000004d;
            display: flex;
            align-items: center;
            padding-left: var(--panel-padding);
            overflow: hidden;
            z-index: var(--z-ui);
        }
        .counter-panel .loot-icon {
            width: 24px;
            height: 24px;
            color: var(--gold-color);
        }
        .counter-panel .digit-container {
            height: 24px;
            overflow: hidden;
            margin-left: 14px;
        }
        .counter-panel .digit-strip {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.5s ease-out;
            transform: translateY(calc(
                (var(--loot-S1-L0-P3, 0) + var(--loot-S1-L1-P4, 0) + var(--loot-S1-L3-P5, 0) + var(--loot-S1-L2-P1, 0) + var(--loot-S1-L4-P2, 0) +
                 var(--loot-S2-L5-P8, 0) + var(--loot-S2-L6-P11, 0) + var(--loot-S2-L7-P7, 0) + var(--loot-S2-L8-P9, 0) + var(--loot-S2-L9-P10, 0) +
                 var(--loot-S3-L5-P15, 0) + var(--loot-S3-L5-P18, 0) + var(--loot-S3-L8-P18, 0) + var(--loot-S3-L9-P14, 0) +
                 var(--loot-S4-L3-P7, 0) + var(--loot-S4-L3-P8, 0) + var(--loot-S4-L3-P12, 0) + var(--loot-S4-L1-P10, 0) + var(--loot-S4-L0-P9, 0))
                * -24px
            ));
        }
        .counter-panel .digit {
            height: 24px;
            line-height: 24px;
            font-size: 20px;
            font-weight: bold;
            color: var(--gold-color);
        }
        /* loot collection: 0 = not collected, 1 for coins, 2 for aquamarine */
        #loot-S1-L0-P3-pickup:checked ~ .counter-panel { --loot-S1-L0-P3: 1; }
        #loot-S1-L1-P4-pickup:checked ~ .counter-panel { --loot-S1-L1-P4: 1; }
        #loot-S1-L3-P5-pickup:checked ~ .counter-panel { --loot-S1-L3-P5: 1; }
        #loot-S1-L2-P1-pickup:checked ~ .counter-panel { --loot-S1-L2-P1: 1; }
        #loot-S1-L4-P2-pickup:checked ~ .counter-panel { --loot-S1-L4-P2: 1; }
        #loot-S2-L5-P8-pickup:checked ~ .counter-panel { --loot-S2-L5-P8: 1; }
        #loot-S2-L6-P11-pickup:checked ~ .counter-panel { --loot-S2-L6-P11: 2; }
        #loot-S2-L7-P7-pickup:checked ~ .counter-panel { --loot-S2-L7-P7: 1; }
        #loot-S2-L8-P9-pickup:checked ~ .counter-panel { --loot-S2-L8-P9: 2; }
        #loot-S2-L9-P10-pickup:checked ~ .counter-panel { --loot-S2-L9-P10: 1; }
        #loot-S3-L5-P15-pickup:checked ~ .counter-panel { --loot-S3-L5-P15: 1; }
        #loot-S3-L5-P18-pickup:checked ~ .counter-panel { --loot-S3-L5-P18: 3; }
        #loot-S3-L8-P18-pickup:checked ~ .counter-panel { --loot-S3-L8-P18: 1; }
        #loot-S3-L9-P14-pickup:checked ~ .counter-panel { --loot-S3-L9-P14: 1; }
        #loot-S4-L3-P7-pickup:checked ~ .counter-panel { --loot-S4-L3-P7: 1; }
        #loot-S4-L3-P8-pickup:checked ~ .counter-panel { --loot-S4-L3-P8: 2; }
        #loot-S4-L3-P12-pickup:checked ~ .counter-panel { --loot-S4-L3-P12: 1; }
        #loot-S4-L1-P10-pickup:checked ~ .counter-panel { --loot-S4-L1-P10: 2; }
        #loot-S4-L0-P9-pickup:checked ~ .counter-panel { --loot-S4-L0-P9: 1; }

        /* Key - single element that animates from game world to inventory */
        .key-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) - var(--item-offset));
            z-index: var(--z-items);
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .key-in-game svg {
            width: 24px;
            height: 24px;
            color: var(--gold-color);
        }
        .key-tooltip {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + var(--pickup-size));
            left: calc(var(--pos-offset) - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
        }
        /* Hover area for key tooltip (when not adjacent) */
        .key-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
        }
        /* Hide key hover area when picked up or used */
        #key-pickup:checked ~ .game-world .key-hover-area,
        #toolbox-unlocked:checked ~ .game-world .key-hover-area,
        #key-pickup:checked ~ .game-world .key-tooltip,
        #toolbox-unlocked:checked ~ .game-world .key-tooltip {
            display: none;
        }
        /* Hide hover area when player is at key (so label click works) */
        #level-4:checked ~ #pos-1:checked ~ .game-world .key-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .key-hover-area:hover ~ .key-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at key and hovers */
        #level-4:checked ~ #pos-1:checked ~ #key-pickup:not(:checked) ~ .game-world .key-in-game:hover ~ .key-tooltip {
            opacity: 1;
        }
        /* Hide key when toolbox is unlocked (key used) */
        #toolbox-unlocked:checked ~ .game-world .key-in-game {
            display: none;
        }
        /* Enable clicking key only when player is next to it */
        #level-4:checked ~ #pos-1:checked ~ #key-pickup:not(:checked) ~ .game-world .key-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: key-pulse 1s ease-in-out infinite;
        }
        /* Fly key to inventory when picked up (Stage 1: viewport right = pos-width * 6) */
        /* Key is always slot 0 (rightmost), no offset needed */
        #key-pickup:checked ~ .game-world .key-in-game {
            bottom: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 6 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px);
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }

        /* Toolbox on level 2, position 6 */
        .toolbox {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
            z-index: var(--z-scenery);
        }
        .toolbox svg {
            width: 100%;
            height: 100%;
            color: #cc1010;
            transform: scale(1.1);
        }
        /* Hide toolbox when unlocked */
        #toolbox-unlocked:checked ~ .game-world .toolbox {
            display: none;
        }
        .toolbox-tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .toolbox:hover {
            z-index: var(--z-tooltip);
        }
        .toolbox:hover .tooltip {
            opacity: 1;
        }

        /* Axe on stage 3, level 4, pos φ (floating platform) */
        .axe-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 16 - var(--item-offset));
            z-index: var(--z-items);
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, width 0.5s ease-in-out, height 0.5s ease-in-out;
        }
        .axe-in-game svg {
            width: 100%;
            height: 100%;
        }
        .axe-tooltip {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) + var(--pickup-size));
            left: calc(var(--pos-offset) + var(--pos-width) * 16 - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
        }
        /* Hover area for axe tooltip (when not adjacent) */
        .axe-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 16 - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
        }
        /* Hide axe hover area and tooltip when picked up or tree chopped */
        #axe-pickup:checked ~ .game-world .axe-hover-area,
        #axe-pickup:checked ~ .game-world .axe-tooltip,
        #tree-chopped:checked ~ .game-world .axe-hover-area,
        #tree-chopped:checked ~ .game-world .axe-tooltip {
            display: none;
        }
        /* Hide hover area when player is at axe (so label click works) */
        #level-8:checked ~ #pos-φ:checked ~ .game-world .axe-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .axe-hover-area:hover ~ .axe-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at axe and hovers */
        #level-8:checked ~ #pos-φ:checked ~ #axe-pickup:not(:checked) ~ .game-world .axe-in-game:hover ~ .axe-tooltip {
            opacity: 1;
        }
        /* Enable clicking axe only when player is at phantom position (S3 uses levels 5-9, level-8 = visual L3) */
        #level-8:checked ~ #pos-φ:checked ~ #axe-pickup:not(:checked) ~ .game-world .axe-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: axe-pulse 1s ease-in-out infinite;
        }
        /* Fly axe to inventory when picked up (Stage 3: viewport right = pos-width * 18) */
        /* Axe slot = slot 0 offset by key + wrench */
        #axe-pickup:checked ~ .game-world .axe-in-game {
            bottom: calc(var(--stage-height) + var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 18 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px
                       - var(--inv-slot-width) * (var(--inv-has-key) + var(--inv-has-wrench)));
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }

        /* ID card on stage 2, level 4, pos 6 */
        .idcard-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset));
            z-index: var(--z-items);
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, width 0.5s ease-in-out, height 0.5s ease-in-out;
        }
        .idcard-in-game svg {
            width: 100%;
            height: 100%;
            color: var(--idcard-color);
        }
        .idcard-tooltip {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) + var(--pickup-size));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
        }
        /* Hover area for ID card tooltip (when not adjacent) */
        .idcard-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
        }
        /* Hide ID card hover area and tooltip when picked up */
        #idcard-pickup:checked ~ .game-world .idcard-hover-area,
        #idcard-pickup:checked ~ .game-world .idcard-tooltip {
            display: none;
        }
        /* Hide hover area when player is at ID card (so label click works) */
        #level-9:checked ~ #pos-12:checked ~ .game-world .idcard-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .idcard-hover-area:hover ~ .idcard-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at ID card and hovers */
        #level-9:checked ~ #pos-12:checked ~ #idcard-pickup:not(:checked) ~ .game-world .idcard-in-game:hover ~ .idcard-tooltip {
            opacity: 1;
        }
        /* Enable clicking id card only when player is next to it - S2 uses levels 5-9, L4 -> L9 */
        #level-9:checked ~ #pos-12:checked ~ #idcard-pickup:not(:checked) ~ .game-world .idcard-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: idcard-pulse 1s ease-in-out infinite;
        }
        /* Fly id card to inventory when picked up (Stage 2: viewport right = pos-width * 12) */
        /* ID card slot = slot 0 offset by key + wrench + axe */
        #idcard-pickup:checked ~ .game-world .idcard-in-game {
            bottom: calc(var(--stage-height) + var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 12 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px
                       - var(--inv-slot-width) * (var(--inv-has-key) + var(--inv-has-wrench) + var(--inv-has-axe)));
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }

        /* Battery on stage 3, level 1, pos 2 */
        .battery-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 13 - var(--item-offset));
            z-index: var(--z-items);
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, width 0.5s ease-in-out, height 0.5s ease-in-out;
        }
        .battery-in-game svg {
            width: 100%;
            height: 100%;
            color: var(--battery-color);
            filter: drop-shadow(2px -2px 2px #00000080);
        }
        .battery-tooltip {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) + var(--pickup-size));
            left: calc(var(--pos-offset) + var(--pos-width) * 13 - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
        }
        /* Hover area for battery tooltip (when not adjacent) */
        .battery-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 13 - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
        }
        /* Hide battery hover area and tooltip when picked up or bolt fixed */
        #battery-pickup:checked ~ .game-world .battery-hover-area,
        #battery-pickup:checked ~ .game-world .battery-tooltip,
        #bolt-fixed:checked ~ .game-world .battery-hover-area,
        #bolt-fixed:checked ~ .game-world .battery-tooltip {
            display: none;
        }
        /* Hide hover area when player is at battery (so label click works) */
        #level-6:checked ~ #pos-14:checked ~ .game-world .battery-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .battery-hover-area:hover ~ .battery-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at battery and hovers */
        #level-6:checked ~ #pos-14:checked ~ #battery-pickup:not(:checked) ~ .game-world .battery-in-game:hover ~ .battery-tooltip {
            opacity: 1;
        }
        /* Enable clicking battery only when player is next to it - S3 uses levels 5-9, L1 -> L6 */
        #level-6:checked ~ #pos-14:checked ~ #battery-pickup:not(:checked) ~ .game-world .battery-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: battery-pulse 1s ease-in-out infinite;
        }
        /* Fly battery to inventory when picked up (Stage 3: viewport right = pos-width * 18) */
        /* Battery slot = slot 0 offset by key + wrench + axe + idcard */
        #battery-pickup:checked ~ .game-world .battery-in-game {
            bottom: calc(var(--stage-height) + var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 18 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px
                       - var(--inv-slot-width) * (var(--inv-has-key) + var(--inv-has-wrench) + var(--inv-has-axe) + var(--inv-has-idcard)));
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }

        /* Torch - S4 (caves) L0-P12 */
        .torch-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset));
            z-index: var(--z-items);
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .torch-in-game svg {
            width: 24px;
            height: 24px;
        }
        .torch-tooltip {
            bottom: calc(var(--ground-height) + var(--pickup-size));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
        }
        /* Hover area for torch tooltip (when not adjacent) */
        .torch-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
        }
        /* Hide torch hover area and tooltip when picked up */
        #torch-pickup:checked ~ .game-world .torch-hover-area,
        #torch-pickup:checked ~ .game-world .torch-tooltip {
            display: none;
        }
        /* Hide hover area when player is at torch (so label click works) */
        #level-0:checked ~ #pos-12:checked ~ .game-world .torch-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .torch-hover-area:hover ~ .torch-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at torch and hovers */
        #level-0:checked ~ #pos-12:checked ~ #torch-pickup:not(:checked) ~ .game-world .torch-in-game:hover ~ .torch-tooltip {
            opacity: 1;
        }
        /* Enable clicking torch only when player is next to it - S4 uses levels 0-4 */
        #level-0:checked ~ #pos-12:checked ~ #torch-pickup:not(:checked) ~ .game-world .torch-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: torch-pulse 1s ease-in-out infinite;
        }
        /* Fly torch to inventory when picked up (S4: viewport right = pos-width * 12) */
        #torch-pickup:checked ~ .game-world .torch-in-game {
            bottom: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 12 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px
                       - var(--inv-slot-width) * (var(--inv-has-key) + var(--inv-has-wrench) + var(--inv-has-axe) + var(--inv-has-idcard) + var(--inv-has-battery)));
            opacity: 0;
            transition: none;
        }

        /* Wrench - single element that animates from game world to inventory */
        .wrench-in-game {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
            z-index: var(--z-items);
            display: none;
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, width 0.5s ease-in-out, height 0.5s ease-in-out;
        }
        .wrench-in-game svg {
            width: 100%;
            height: 100%;
            color: var(--wrench-color);
        }
        .wrench-tooltip {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + var(--pickup-size) + 25px);
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset) + var(--pickup-size) / 2);
            transform: translateX(-50%);
            display: none;
        }
        /* Hover area for wrench tooltip (when not adjacent) */
        .wrench-hover-area {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 25px);
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
            pointer-events: auto;
            z-index: var(--z-item-hover);
            display: none;
        }
        /* Show wrench hover area and tooltip element when toolbox unlocked but wrench not picked up */
        #toolbox-unlocked:checked ~ #wrench-pickup:not(:checked) ~ .game-world .wrench-hover-area,
        #toolbox-unlocked:checked ~ #wrench-pickup:not(:checked) ~ .game-world .wrench-tooltip {
            display: block;
        }
        /* Hide hover area when player is at wrench (so label click works) */
        #level-2:checked ~ #pos-6:checked ~ #toolbox-unlocked:checked ~ .game-world .wrench-hover-area {
            display: none;
        }
        /* Show tooltip on hover area hover */
        .wrench-hover-area:hover ~ .wrench-tooltip {
            opacity: 1;
        }
        /* Show tooltip when player is at wrench and hovers */
        #level-2:checked ~ #pos-6:checked ~ #toolbox-unlocked:checked ~ #wrench-pickup:not(:checked) ~ .game-world .wrench-in-game:hover ~ .wrench-tooltip {
            opacity: 1;
        }
        /* Show wrench when toolbox is unlocked */
        #toolbox-unlocked:checked ~ .game-world .wrench-in-game {
            display: block;
        }
        /* Enable clicking wrench only when player is next to it */
        #level-2:checked ~ #pos-6:checked ~ #toolbox-unlocked:checked ~ #wrench-pickup:not(:checked) ~ .game-world .wrench-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: wrench-pulse 1s ease-in-out infinite;
        }
        /* Fly wrench to inventory when picked up (Stage 1) */
        /* Wrench slot = slot 0 offset by key (if in inventory) */
        #toolbox-unlocked:checked ~ #wrench-pickup:checked ~ .game-world .wrench-in-game {
            bottom: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) / 2 - var(--pickup-size) / 2 - 4px);
            left: calc(var(--pos-width) * 6 - var(--panel-right) - 2px - var(--panel-padding) - var(--pickup-size) - 4px
                       - var(--inv-slot-width) * var(--inv-has-key));
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }


        /* Key above toolbox - pulsates when user has key, clickable to unlock */
        .key-at-toolbox {
            position: absolute;
            width: 19px;
            height: 19px;
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 35px);
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - 28px);
            z-index: var(--z-floating-item);
            display: none;
            cursor: pointer;
        }
        .key-at-toolbox svg {
            width: 100%;
            height: 100%;
            color: var(--gold-color);
        }
        /* Only show key at toolbox when player is next to it, has key, AND toolbox not yet unlocked */
        #level-2:checked ~ #pos-6:checked ~ #key-pickup:checked ~ #toolbox-unlocked:not(:checked) ~ .game-world .key-at-toolbox {
            display: block;
            animation: key-hovering-pulse 1s ease-in-out infinite;
        }

        /* Axe above tree - pulsates when user has axe, clickable to use */
        .axe-at-tree {
            position: absolute;
            width: 24px;
            height: 24px;
            bottom: calc(var(--stage-height) + var(--ground-height) + 13px);
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + var(--ladder-offset) - 3px);
            z-index: var(--z-floating-item);
            display: none;
            cursor: pointer;
            transform-origin: bottom left;
        }
        .axe-at-tree svg {
            width: 100%;
            height: 100%;
            transform-origin: bottom left;
        }
        /* Only show axe at tree when player is next to it, has axe, AND tree not yet chopped - S2 uses levels 5-9 */
        #level-5:checked ~ #pos-12:checked ~ #axe-pickup:checked ~ #tree-chopped:not(:checked) ~ .game-world .axe-at-tree {
            display: block;
            animation: axe-chop 1s ease-in infinite;
        }

        .player {
            position: absolute;
            width: auto;
            height: 56px;
            animation: idle 1s ease-in-out infinite;
            z-index: var(--z-player);
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 2);
            transition: left 0.3s ease, bottom 0.3s ease;
        }
        .player svg {
            height: 100%;
            width: auto;
        }

        /* Player horizontal positions */
        /* S1: pos 1-6 */
        #pos-1:checked ~ .game-world .player { left: var(--pos-offset); }
        #pos-2:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width)); }
        #pos-3:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 2); }
        #pos-4:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 3); }
        #pos-5:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 4); }
        #pos-6:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 5); }
        /* S2/S4: pos 7-12 */
        #pos-7:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 6); }
        #pos-8:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 7); }
        #pos-9:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 8); }
        #pos-10:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 9); }
        #pos-11:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 10); }
        #pos-12:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 11); }
        /* S3: pos 13-18 */
        #pos-13:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 12); }
        #pos-14:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 13); }
        #pos-15:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 14); }
        #pos-16:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 15); }
        #pos-17:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 16); }
        #pos-18:checked ~ .game-world .player { left: calc(var(--pos-offset) + var(--pos-width) * 17); }
        /* Phantom position: L8-Pφ displays at L9-P17 visual location */
        #level-8:checked ~ #pos-φ:checked ~ .game-world .player {
            left: calc(var(--pos-offset) + var(--pos-width) * 16); /* P17 X position */
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) - 2px); /* L9 height (same as L4) */
        }

        /* Player vertical levels (S1/S4: levels 0-4) */
        #level-0:checked ~ .game-world .player { bottom: calc(var(--ground-height) - 2px); }
        #level-1:checked ~ .game-world .player { bottom: calc(var(--platform-height) + var(--platform-thickness) - 2px); }
        #level-2:checked ~ .game-world .player { bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) - 2px); }
        #level-3:checked ~ .game-world .player { bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) - 2px); }
        #level-4:checked ~ .game-world .player { bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) - 2px); }
        /* Player vertical levels (S2/S3: levels 5-9, display at same heights as 0-4) */
        /* Player vertical levels (S2/S3: levels 5-9, positioned above S1/S4) */
        #level-5:checked ~ .game-world .player { bottom: calc(var(--stage-height) + var(--ground-height) - 2px); }
        #level-6:checked ~ .game-world .player { bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) - 2px); }
        #level-7:checked ~ .game-world .player { bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) - 2px); }
        #level-8:checked ~ .game-world .player { bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) - 2px); }
        #level-9:checked ~ .game-world .player { bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) - 2px); }

        /* Landing after jump from phantom position */
        #level-8:checked ~ #pos-16:checked ~ .game-world .player,
        #level-8:checked ~ #pos-18:checked ~ .game-world .player {
            transition: left 0.3s ease-out, bottom 0.3s ease-in;
        }

        /* Player tooltip */
        .player-tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 12px;
        }
        .player:hover .player-tooltip {
            opacity: 1;
        }
        /* Debug mode: show level and position in player tooltip */
        #debug-toggle:checked ~ .game-container .game-world .player-tooltip::after {
            content: " (" var(--level) "-" var(--pos) ")";
        }

        /* Torch held by player in S4 */
        .torch-held {
            display: none;
            position: absolute;
            width: 20px;
            top: -55px;
            z-index: calc(var(--z-player) + 10);
            /* Position relative to player - offset to appear beside them */
            margin-left: 40px;
        }
        .torch-held svg {
            width: 100%;
            height: 100%;
        }
        /* Show torch next to player in S4 when picked up */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~
        :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~
        #torch-pickup:checked ~ .game-world .torch-held {
            display: block;
            filter: drop-shadow(0 0 6px yellow);
        }

        .ground-S1,
        .ground-S2,
        .ground-S3,
        .ground-S4 {
            position: absolute;
            bottom: 0;
            width: calc(var(--pos-width) * 6);
            height: var(--ground-height);
        }
        .ground-S1 {
            left: 0;
            background: linear-gradient(to bottom, #4a5568 0%, #2d3748 100%);
            border-top: 3px solid #718096;
        }
        .ground-S2 {
            left: calc(var(--pos-width) * 6);
            bottom: var(--stage-height);
            background: linear-gradient(to bottom, #8b5a2b 0%, #5d3a1a 100%);
            border-top: 3px solid #a0522d;
        }
        .ground-S4 {
            left: calc(var(--pos-width) * 6);
            background:
                /* Bluish-grey fuzzy streaks scattered across (10:1 ratio) */
                radial-gradient(ellipse 80px 8px at 5% 55%, #64788c66 0%, #64788c33 50%, transparent 80%),
                radial-gradient(ellipse 60px 6px at 18% 30%, #5a6e8259 0%, #5a6e8226 50%, transparent 80%),
                radial-gradient(ellipse 100px 10px at 28% 72%, #6e829666 0%, #6e829633 50%, transparent 80%),
                radial-gradient(ellipse 70px 7px at 40% 45%, #5f738759 0%, #5f738726 50%, transparent 80%),
                radial-gradient(ellipse 90px 9px at 52% 80%, #64788c66 0%, #64788c33 50%, transparent 80%),
                radial-gradient(ellipse 55px 5px at 62% 35%, #5a6e8259 0%, #5a6e8226 50%, transparent 80%),
                radial-gradient(ellipse 85px 8px at 72% 60%, #6e829666 0%, #6e829633 50%, transparent 80%),
                radial-gradient(ellipse 65px 6px at 82% 25%, #5f738759 0%, #5f738726 50%, transparent 80%),
                radial-gradient(ellipse 75px 7px at 92% 68%, #64788c66 0%, #64788c33 50%, transparent 80%),
                radial-gradient(ellipse 50px 5px at 12% 78%, #5a6e8259 0%, #5a6e8226 50%, transparent 80%),
                radial-gradient(ellipse 95px 9px at 35% 20%, #6e829666 0%, #6e829633 50%, transparent 80%),
                radial-gradient(ellipse 45px 4px at 48% 58%, #5f738759 0%, #5f738726 50%, transparent 80%),
                radial-gradient(ellipse 70px 7px at 78% 42%, #64788c66 0%, #64788c33 50%, transparent 80%),
                radial-gradient(ellipse 60px 6px at 88% 85%, #5a6e8259 0%, #5a6e8226 50%, transparent 80%),
                radial-gradient(ellipse 80px 8px at 22% 50%, #6e829666 0%, #6e829633 50%, transparent 80%),
                /* Base soil gradient */
                linear-gradient(to bottom, #6b5344 0%, #4a3728 100%);
            border-top: 3px solid #7d6252;
        }
        .ground-S3 {
            left: calc(var(--pos-width) * 12);
            bottom: var(--stage-height);
            background:
                radial-gradient(circle at 8% 25%, #00000066 0%, #00000066 1px, transparent 1px),
                radial-gradient(circle at 22% 65%, #00000059 0%, #00000059 1px, transparent 1px),
                radial-gradient(circle at 37% 40%, #0000004d 0%, #0000004d 2px, transparent 2px),
                radial-gradient(circle at 52% 80%, #00000066 0%, #00000066 1px, transparent 1px),
                radial-gradient(circle at 68% 35%, #00000059 0%, #00000059 1px, transparent 1px),
                radial-gradient(circle at 78% 70%, #0000004d 0%, #0000004d 2px, transparent 2px),
                radial-gradient(circle at 91% 50%, #00000066 0%, #00000066 1px, transparent 1px),
                radial-gradient(circle at 15% 40%, #00000026 0%, transparent 8%),
                radial-gradient(circle at 45% 70%, #0000001a 0%, transparent 6%),
                radial-gradient(circle at 75% 30%, #0000001f 0%, transparent 7%),
                radial-gradient(circle at 30% 80%, #00000014 0%, transparent 5%),
                radial-gradient(circle at 85% 60%, #0000001a 0%, transparent 6%),
                radial-gradient(circle at 60% 50%, #00000014 0%, transparent 4%),
                linear-gradient(to bottom, #6b6f73 0%, #4a4d50 100%);
            border-top: 3px solid #7a7e82;
        }

        /* Warning walls - yellow/black diagonal stripes marking stage edges */
        .warning-wall {
            position: absolute;
            width: var(--warning-wall-width);
            z-index: var(--z-walls);
            background: repeating-linear-gradient(
                -45deg,
                #ffcc00,
                #ffcc00 4px,
                #222 4px,
                #222 8px
            );
        }
        .wall-S1-left {
            left: 0;
            bottom: var(--ground-height);
            height: calc(var(--stage-height) - var(--ground-height) - var(--panel-top) * 2 - var(--panel-height) * 2 - 10px);
        }
        .wall-S1-right {
            left: calc(var(--pos-width) * 6 - var(--warning-wall-width) - 4px);
            bottom: calc(var(--ground-height) + 60px);
            height: calc(var(--stage-height) - var(--ground-height) - 60px - var(--panel-top) * 2 - var(--panel-height) * 2 - 10px);
        }
        /* Rock walls - shared base styles */
        .rock-wall {
            position: absolute;
            width: 12px;
            z-index: var(--z-walls);
        }
        .rock-wall::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='400'%3E%3Cdefs%3E%3Cfilter id='f' x='-20%25' y='-20%25' width='140%25' height='140%25'%3E%3CfeGaussianBlur stdDeviation='0.4'/%3E%3C/filter%3E%3C/defs%3E%3Cpolygon points='2,5 8,7 10,13 5,15 1,11' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='6,35 11,39 9,47 4,45 2,40' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='1,58 7,56 10,62 8,68 3,66' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='4,105 9,103 11,108 7,114 2,110' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='2,122 6,119 10,124 8,132 3,129' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='5,168 10,171 8,179 3,177 1,172' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='3,195 8,192 11,198 6,205 1,200' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='6,212 10,215 8,222 3,220 2,216' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='1,265 7,263 10,270 5,277 2,272' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='4,295 9,292 11,299 7,305 2,301' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='2,310 8,308 10,315 6,322 1,317' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='5,352 10,355 8,363 3,360 1,356' fill='%232a2a2a' filter='url(%23f)'/%3E%3Cpolygon points='3,368 7,365 11,371 8,378 2,374' fill='%23333' filter='url(%23f)'/%3E%3Cpolygon points='6,390 10,394 7,402 2,399 3,393' fill='%232a2a2a' filter='url(%23f)'/%3E%3C/svg%3E");
            background-repeat: repeat-y;
        }
        /* Rock wall positions - left edge variant (jagged right edge) */
        .wall-S2-left,
        .wall-S4-left {
            background: repeating-linear-gradient(
                10deg,
                #777 0px,
                #777 8px,
                #666 8px,
                #666 10px,
                #777 10px,
                #777 22px,
                #333 22px,
                #333 24px
            );
            box-shadow: inset -2px 0 3px #00000066;
            clip-path: polygon(
                0% 0%, 100% 0%, 100% 2%, 72% 4%, 100% 7%, 85% 9%, 68% 13%,
                100% 16%, 78% 21%, 100% 23%, 65% 27%, 88% 31%, 100% 34%,
                70% 38%, 100% 41%, 82% 46%, 100% 48%, 68% 53%, 90% 56%,
                100% 59%, 75% 64%, 100% 67%, 65% 72%, 85% 75%, 100% 78%,
                72% 83%, 100% 86%, 80% 91%, 68% 94%, 100% 97%, 100% 100%,
                0% 100%
            );
        }
        .wall-S2-left {
            left: calc(var(--pos-width) * 6);
            bottom: calc(var(--stage-height) + var(--ground-height));
            height: calc(var(--stage-height) - var(--ground-height) - var(--panel-top) * 2 - var(--panel-height) * 2 - 10px);
        }
        .wall-S4-left {
            left: calc(var(--pos-width) * 6);
            bottom: calc(var(--ground-height) + 60px);
            height: calc(var(--stage-height) - var(--ground-height) - 60px - var(--panel-top) * 2 - var(--panel-height) * 2 - 10px);
        }
        /* Rock wall position - right edge variant (jagged left edge) */
        .wall-S4-right {
            left: calc(var(--pos-width) * 12 - 16px);
            bottom: var(--ground-height);
            height: calc(var(--stage-height) - var(--ground-height) - var(--panel-top) * 2 - var(--panel-height) * 2 - 10px);
            background: repeating-linear-gradient(
                -10deg,
                #777 0px,
                #777 8px,
                #666 8px,
                #666 10px,
                #777 10px,
                #777 22px,
                #333 22px,
                #333 24px
            );
            box-shadow: inset 2px 0 3px #00000066;
            clip-path: polygon(
                0% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 97%, 32% 94%, 0% 91%,
                20% 86%, 28% 83%, 0% 78%, 15% 75%, 35% 72%, 0% 67%, 25% 64%,
                0% 59%, 10% 56%, 32% 53%, 0% 48%, 18% 46%, 0% 41%, 30% 38%,
                0% 34%, 12% 31%, 35% 27%, 0% 23%, 22% 21%, 0% 16%, 32% 13%,
                15% 9%, 0% 7%, 28% 4%, 0% 2%
            );
        }
        /* Manhole and cover at S2-L5-P7 (entry point from S4) */
        .manhole-S2-L5-P7 {
            position: absolute;
            left: calc(var(--pos-offset) + var(--pos-width) * 6 - 10px);
            bottom: calc(var(--stage-height) + var(--ground-height) - 22px);
            width: 66px;
            height: 21px;
            background: #1a1a1a;
            border-radius: 50%;
            box-shadow: inset 0 2px 4px #000000cc;
        }
        .manhole-cover-S2-L5-P7 {
            position: absolute;
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 14px);
            bottom: calc(var(--stage-height) + var(--ground-height) - 29px);
            width: 66px;
            height: 21px;
            background: linear-gradient(to bottom, #5a5a5a 0%, #3a3a3a 50%, #4a4a4a 100%);
            border-radius: 50%;
            border: 2px solid #2a2a2a;
            box-shadow: 1px 1px 3px #00000080;
        }
        .manhole-cover-S2-L5-P7::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 4px;
            background: #2a2a2a;
            border-radius: 2px;
        }

        /* Spaceship background in Stage 3 */
        .spacecraft-bg {
            position: absolute;
            left: calc(var(--pos-width) * 12);
            bottom: calc(var(--stage-height) + var(--ground-height) + 40px);
            z-index: 0;
        }
        .spacecraft-bg svg {
            display: block;
            width: calc(var(--pos-width) * 12 * 0.729);
            height: calc(var(--pos-width) * 12 * 438 / 1540 * 0.729);
            opacity: 0.85;
        }

        /* Factory background in Stage 1 */
        .factory-bg {
            position: absolute;
            left: 0;
            bottom: 0;
            height: var(--stage-height);
            width: calc(var(--pos-width) * 6);
            z-index: 0;
        }
        .factory-bg svg {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Jungle background in Stage 2 */
        .jungle-bg {
            position: absolute;
            left: calc(var(--pos-width) * 6);
            bottom: var(--stage-height);
            height: var(--stage-height);
            width: calc(var(--pos-width) * 6);
            z-index: 0;
            -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 12%, black 100%);
            mask-image: linear-gradient(to bottom, transparent 0%, black 12%, black 100%);
        }
        .jungle-bg svg {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Caves background in Stage 4 */
        .caves-bg {
            position: absolute;
            left: calc(var(--pos-width) * 6);
            bottom: 0;
            height: var(--stage-height);
            width: calc(var(--pos-width) * 6);
            z-index: 0;
            -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 12%, black 100%);
            mask-image: linear-gradient(to bottom, transparent 0%, black 12%, black 100%);
        }
        .caves-bg svg {
            display: block;
            width: 100%;
            height: 100%;
        }

        h2 {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--gold-color);
            font-size: 20px;
            text-shadow: 2px 2px 0 #b8860b;
            letter-spacing: 3px;
            z-index: var(--z-ui);
        }
        .subtitle {
            position: absolute;
            top: 42px;
            left: 50%;
            transform: translateX(-50%);
            z-index: var(--z-ui);
            color: var(--gold-color);
            font-size: 14px;
            font-style: italic;
            text-shadow: 1px 1px 0 #b8860b;
        }
        .subtitle-S1,
        .subtitle-S2,
        .subtitle-S3,
        .subtitle-S4 {
            display: none;
        }
        /* S1: pos 1-6 + levels 0-4 */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~ :is(#pos-1, #pos-2, #pos-3, #pos-4, #pos-5, #pos-6):checked ~ .subtitle-S1 {
            display: block;
        }
        /* S4: pos 7-12 + levels 0-4 */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~ :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~ .subtitle-S4 {
            display: block;
        }
        /* S2: pos 7-12 + levels 5-9 */
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~ .subtitle-S2 {
            display: block;
        }
        /* S3: pos 13-18 + levels 5-9 */
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ :is(#pos-13, #pos-14, #pos-15, #pos-16, #pos-17, #pos-18, #pos-φ):checked ~ .subtitle-S3 {
            display: block;
        }

        /* Base ladder styles */
        .ladder {
            position: absolute;
            width: 24px;
            height: calc(var(--platform-height) - var(--platform-thickness));
            z-index: var(--z-climbables);
        }

        /* Wooden ladder - two vertical rails with horizontal rungs */
        .wooden-ladder {
            /* Two vertical rails (4px each) */
            background:
                linear-gradient(90deg,
                    #cd853f 0px, #cd853f 4px,
                    transparent 4px, transparent 20px,
                    #cd853f 20px, #cd853f 24px
                );
            box-shadow:
                inset 1px 0 0 #8b5a2b,
                inset -1px 0 0 #8b5a2b;
        }
        /* Horizontal rungs using repeating gradient */
        .wooden-ladder::after {
            content: '';
            position: absolute;
            top: 0;
            left: 4px;
            right: 4px;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 10px,
                #cd853f 10px,
                #cd853f 14px
            );
        }

        /* Spine ladder - central pole with alternating rungs */
        .spine-ladder {
            /* Central vertical pole (4px wide, centered) */
            background:
                linear-gradient(90deg,
                    transparent 0px, transparent 10px,
                    #708090 10px, #708090 14px,
                    transparent 14px, transparent 24px
                );
            filter: drop-shadow(2px 2px 2px #00000080);
        }
        /* Alternating rungs using two pseudo-elements */
        .spine-ladder::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 14px;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 10px,
                #708090 10px,
                #708090 14px,
                transparent 14px,
                transparent 28px
            );
        }
        .spine-ladder::after {
            content: '';
            position: absolute;
            top: 14px;
            left: 10px;
            width: 14px;
            height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 10px,
                #708090 10px,
                #708090 14px,
                transparent 14px,
                transparent 28px
            );
        }

        /* Ladder at S1-L0-P5: ground to platform 1 */
        .ladder-S1-L0-P5 {
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + var(--ladder-offset));
        }

        /* Ladder at S1-L1-P3: platform 1 to platform 2 */
        .ladder-S1-L1-P3 {
            bottom: calc(var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + var(--ladder-offset));
        }

        /* Ladder at S1-L2-P1: platform 2 to platform 3 */
        .ladder-S1-L2-P1 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--ladder-offset));
        }

        /* Ladder at S1-L3-P4: platform 3 to platform 4 */
        .ladder-S1-L3-P4 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 3 + var(--ladder-offset));
        }

        /* Ladder at S4-L4-P7: platform 4 to S2 (only visible when player at position) */
        .ladder-S4-L4-P7 {
            display: none;
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + var(--ladder-offset));
        }
        #level-4:checked ~ #pos-7:checked ~ .game-world .ladder-S4-L4-P7,
        #level-4:checked ~ #pos-8:checked ~ #torch-pickup:checked ~ .game-world .ladder-S4-L4-P7 {
            display: block;
        }

        /* Ladder at S3-L0-P4: ground to platform 1 */
        .ladder-S3-L5-P16 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 15 + var(--ladder-offset));
        }

        /* Ladder at S3-L3-P5: platform 3 to floating platform (phantom) */
        .ladder-S3-L8-P17 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 16 + var(--ladder-offset));
        }
        /* Ladder at S3-L1-P6: platform 1 to platform 2 (extended) */
        .ladder-S3-L6-P18 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) - 14px);
            left: calc(var(--pos-offset) + var(--pos-width) * 17 + var(--ladder-offset));
            height: calc(var(--platform-height) - var(--platform-thickness) + 28px);
        }

        /* Barrel at S3-L4-P3 */
        .barrel-S3-L9-P15 {
            position: absolute;
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) * 2 + 4px);
            left: calc(var(--pos-offset) + var(--pos-width) * 14 + var(--ladder-offset) + 8px);
            width: 32px;
            z-index: var(--z-scenery);
        }
        .barrel-S3-L9-P15 svg {
            position: absolute;
            width: 32px;
            height: 32px;
            color: var(--barrel-color);
            transform: scaleY(1.5);
            filter: drop-shadow(0 0 2px #000000cc);
        }
        .barrel-S3-L9-P15 svg:first-child {
            top: 0px;
            left: 14px;
        }
        .barrel-S3-L9-P15 svg:nth-child(2) {
            rotate: 90deg;
            top: 5px;
            left: -4px;
        }
        .barrel-S3-L9-P15 .tooltip {
            bottom: calc(100% + 6px);
            left: 50%;
            transform: translateX(-50%);
        }
        .barrel-S3-L9-P15:hover .tooltip {
            opacity: 1;
        }

        /* Vines for stage 2 */
        .vine {
            position: absolute;
            width: 24px;
            height: calc(var(--platform-height) - var(--platform-thickness));
            z-index: var(--z-climbables);
            /* Wavy main stem */
            background:
                radial-gradient(ellipse 8px 12px at 8px 10px, #228b22 50%, transparent 50%),
                radial-gradient(ellipse 8px 12px at 16px 30px, #228b22 50%, transparent 50%),
                radial-gradient(ellipse 8px 12px at 8px 50px, #228b22 50%, transparent 50%),
                radial-gradient(ellipse 8px 12px at 16px 70px, #228b22 50%, transparent 50%),
                radial-gradient(ellipse 8px 12px at 8px 90px, #228b22 50%, transparent 50%),
                radial-gradient(ellipse 8px 12px at 16px 110px, #228b22 50%, transparent 50%),
                linear-gradient(90deg, transparent 10px, #1a6b1a 10px, #1a6b1a 14px, transparent 14px);
        }
        /* Leaves on the vine */
        .vine::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(ellipse 10px 6px at 2px 20px, #32cd32 50%, transparent 50%),
                radial-gradient(ellipse 10px 6px at 22px 45px, #32cd32 50%, transparent 50%),
                radial-gradient(ellipse 10px 6px at 2px 65px, #32cd32 50%, transparent 50%),
                radial-gradient(ellipse 10px 6px at 22px 85px, #32cd32 50%, transparent 50%),
                radial-gradient(ellipse 10px 6px at 2px 105px, #32cd32 50%, transparent 50%);
        }

        /* Stage 2 Vines (positioned above S4) */
        .vine-S2-L5-P8 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + var(--ladder-offset));
        }
        .vine-S2-L5-P11 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + var(--ladder-offset));
        }
        .vine-S2-L6-P7 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + var(--ladder-offset));
        }
        .vine-S2-L6-P10 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + var(--ladder-offset));
        }
        .vine-S2-L7-P11 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + var(--ladder-offset));
        }
        .vine-S2-L8-P9 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + var(--ladder-offset));
        }

        /* Arrow labels (clickable) - CSS triangles */
        .arrow {
            position: absolute;
            width: 0;
            height: 0;
            z-index: var(--z-arrows);
            cursor: pointer;
            user-select: none;
            display: none;
            filter: drop-shadow(0 0 8px var(--nav-arrow-color));
        }

        .arrow:hover {
            filter: drop-shadow(0 0 15px var(--nav-arrow-color)) drop-shadow(0 0 25px var(--nav-arrow-color));
        }

        /* Right arrow */
        .arrow-right {
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-left: 16px solid var(--nav-arrow-color);
        }

        /* Left arrow */
        .arrow-left {
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-right: 16px solid var(--nav-arrow-color);
        }

        /* Up arrow */
        .arrow-up {
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 16px solid var(--nav-arrow-color);
        }

        /* Down arrow */
        .arrow-down {
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-top: 16px solid var(--nav-arrow-color);
        }

        /* Horizontal arrow positions */
        .arrow-h {
            bottom: calc(var(--ground-height) - 10px);
        }
        .arrow-S1-P1-P2, .arrow-S1-P2-P1 { left: calc(var(--pos-offset) + var(--pos-width) * 0.5 + 12px); }
        .arrow-S1-P2-P3, .arrow-S1-P3-P2 { left: calc(var(--pos-offset) + var(--pos-width) * 1.5 + 12px); }
        .arrow-S1-P3-P4, .arrow-S1-P4-P3 { left: calc(var(--pos-offset) + var(--pos-width) * 2.5 + 12px); }
        .arrow-S1-P4-P5, .arrow-S1-P5-P4 { left: calc(var(--pos-offset) + var(--pos-width) * 3.5 + 12px); }
        .arrow-S1-P5-P6, .arrow-S1-P6-P5 { left: calc(var(--pos-offset) + var(--pos-width) * 4.5 + 12px); }
        /* Stage 1 to Stage 2 transition arrows */
        .arrow-S2-P7-S1-P6 { left: calc(var(--pos-offset) + var(--pos-width) * 5.5 + 33px); }
        .arrow-S1-P6-S2-P7 { left: calc(var(--pos-offset) + var(--pos-width) * 5 + 60px); }
        /* Stage 2 horizontal arrows */
        .arrow-S2-P7-P8, .arrow-S2-P8-P7 { left: calc(var(--pos-offset) + var(--pos-width) * 6.5 + 12px); }
        .arrow-S2-P8-P9, .arrow-S2-P9-P8 { left: calc(var(--pos-offset) + var(--pos-width) * 7.5 + 12px); }
        .arrow-S2-P9-P10, .arrow-S2-P10-P9 { left: calc(var(--pos-offset) + var(--pos-width) * 8.5 + 12px); }
        .arrow-S2-P10-P11, .arrow-S2-P11-P10 { left: calc(var(--pos-offset) + var(--pos-width) * 9.5 + 12px); }
        .arrow-S2-P11-P12, .arrow-S2-P12-P11 { left: calc(var(--pos-offset) + var(--pos-width) * 10.5 + 12px); }
        .arrow-S2-P12-S3-P13 { left: calc(var(--pos-offset) + var(--pos-width) * 11 + 60px); }
        .arrow-S3-P13-S2-P12 { left: calc(var(--pos-offset) + var(--pos-width) * 11.5 + 33px); }
        /* Stage 3 horizontal arrows */
        .arrow-S3-P13-P14, .arrow-S3-P14-P13 { left: calc(var(--pos-offset) + var(--pos-width) * 12.5 + 12px); }
        .arrow-S3-P14-P15, .arrow-S3-P15-P14 { left: calc(var(--pos-offset) + var(--pos-width) * 13.5 + 12px); }
        .arrow-S3-P15-P16, .arrow-S3-P16-P15 { left: calc(var(--pos-offset) + var(--pos-width) * 14.5 + 12px); }
        .arrow-S3-P16-P17, .arrow-S3-P17-P16 { left: calc(var(--pos-offset) + var(--pos-width) * 15.5 + 12px); }
        .arrow-S3-P17-P18, .arrow-S3-P18-P17 { left: calc(var(--pos-offset) + var(--pos-width) * 16.5 + 12px); }
        /* Stage 4 horizontal arrows */
        .arrow-S4-P7-P8, .arrow-S4-P8-P7 { left: calc(var(--pos-offset) + var(--pos-width) * 6.5 + 12px); }
        .arrow-S4-P8-P9, .arrow-S4-P9-P8 { left: calc(var(--pos-offset) + var(--pos-width) * 7.5 + 12px); }
        .arrow-S4-P9-P10, .arrow-S4-P10-P9 { left: calc(var(--pos-offset) + var(--pos-width) * 8.5 + 12px); }
        .arrow-S4-P10-P11, .arrow-S4-P11-P10 { left: calc(var(--pos-offset) + var(--pos-width) * 9.5 + 12px); }
        .arrow-S4-P11-P12, .arrow-S4-P12-P11 { left: calc(var(--pos-offset) + var(--pos-width) * 10.5 + 12px); }

        /* Horizontal arrows move with level */
        #level-0:checked ~ .game-world .arrow-h { bottom: calc(var(--ground-height) + 19px); }
        #level-1:checked ~ .game-world .arrow-h { bottom: calc(var(--platform-height) + var(--platform-thickness) + 19px); }
        #level-2:checked ~ .game-world .arrow-h { bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 19px); }
        #level-3:checked ~ .game-world .arrow-h { bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 19px); }
        #level-4:checked ~ .game-world .arrow-h { bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + 19px); }
        #level-5:checked ~ .game-world .arrow-h { bottom: calc(var(--stage-height) + var(--ground-height) + 19px); }
        #level-6:checked ~ .game-world .arrow-h { bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) + 19px); }
        #level-7:checked ~ .game-world .arrow-h { bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) + 19px); }
        #level-8:checked ~ .game-world .arrow-h { bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) + 19px); }
        #level-9:checked ~ .game-world .arrow-h { bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) + 19px); }

        /* Up arrow positions (at ladder locations) */
        /* Ladder 1: position 5, level 0 -> 1 */
        .arrow-up-S1-L0-P5 {
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + 10px);
            bottom: calc(var(--ground-height) + 72.5px);
        }
        /* Ladder 2: position 3, level 1 -> 2 */
        .arrow-up-S1-L1-P3 {
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + 10px);
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        /* Ladder 3: position 1, level 2 -> 3 */
        .arrow-up-S1-L2-P1 {
            left: calc(var(--pos-offset) + 10px);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 72.5px);
        }
        /* Ladder 4: position 4, level 3 -> 4 */
        .arrow-up-S1-L3-P4 {
            left: calc(var(--pos-offset) + var(--pos-width) * 3 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }

        /* Stage 2 Up arrows: S2-L0-P2, S2-L0-P5, S2-L1-P1, S2-L1-P4, S2-L2-P5, S2-L3-P3 */
        .arrow-up-S2-L5-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: calc(var(--stage-height) + var(--ground-height) + 72.5px);
        }
        .arrow-up-S2-L5-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--stage-height) + var(--ground-height) + 72.5px);
        }
        .arrow-up-S2-L6-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S2-L6-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S2-L7-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S2-L8-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }

        /* Stage 4 Up arrows */
        /* L0: P7, P8, P9, P12 */
        .arrow-up-S4-L0-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--ground-height) + 72.5px);
        }
        .arrow-up-S4-L0-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: calc(var(--ground-height) + 72.5px);
        }
        .arrow-up-S4-L0-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--ground-height) + 72.5px);
        }
        .arrow-up-S4-L0-P12 {
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + 10px);
            bottom: calc(var(--ground-height) + 72.5px);
        }
        /* L1: P7, P9, P11 */
        .arrow-up-S4-L1-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L1-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L1-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) + var(--platform-thickness) + 72.5px);
        }
        /* L2: P8, P10, P11 */
        .arrow-up-S4-L2-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L2-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L2-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness) + 72.5px);
        }
        /* L3: P7, P9, P10, P11, P12 */
        .arrow-up-S4-L3-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L3-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L3-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L3-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S4-L3-P12 {
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + 10px);
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        /* L4: P7→S2 (climb from S4 level 4 to S2 level 5) */
        .arrow-up-S4-L4-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness) + 72.5px);
        }

        /* Stage 3 Up arrows */
        .arrow-up-S3-L5-P16 {
            left: calc(var(--pos-offset) + var(--pos-width) * 15 + 10px);
            bottom: calc(var(--stage-height) + var(--ground-height) + 72.5px);
        }
        .arrow-up-S3-L8-P17 {
            left: calc(var(--pos-offset) + var(--pos-width) * 16 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness) + 72.5px);
        }
        .arrow-up-S3-L6-P18 {
            left: calc(var(--pos-offset) + var(--pos-width) * 17 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness) + 72.5px);
        }

        /* Stage 3 phantom position arrows (at visual L4-P5) */
        .arrow-left-S3-Pφ {
            left: calc(var(--pos-offset) + var(--pos-width) * 15.5 + 12px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) + 19px);
        }
        .arrow-right-S3-Pφ {
            left: calc(var(--pos-offset) + var(--pos-width) * 16.5 + 12px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness) + 19px);
        }

        /* Down arrow positions (at platform gaps) */
        .arrow-down-S1-L1-P1 {
            left: calc(var(--pos-offset) + 10px);
            bottom: var(--platform-height);
        }
        .arrow-down-S1-L2-P5 {
            left: calc(var(--pos-offset) + var(--pos-width) * 4 + 10px);
            bottom: calc(var(--platform-height) * 2);
        }
        .arrow-down-S1-L3-P3 {
            left: calc(var(--pos-offset) + var(--pos-width) * 2 + 10px);
            bottom: calc(var(--platform-height) * 3);
        }
        .arrow-down-S1-L4-P6 {
            left: calc(var(--pos-offset) + var(--pos-width) * 5 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }

        /* Stage 2 Down arrows: S2-L1-P1, S2-L1-P5, S2-L2-P2, S2-L3-P4, S2-L4-P1 */
        .arrow-down-S2-L6-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height));
        }
        .arrow-down-S2-L6-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height));
        }
        .arrow-down-S2-L7-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
        }
        .arrow-down-S2-L8-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 3);
        }
        .arrow-down-S2-L9-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 4);
        }
        /* S2→S4 climb down arrow at L5-P7 (climb from S2 level 5 to S4 level 4) */
        .arrow-down-S2-L5-P7-to-S4 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-thickness) / 2);
        }
        /* Stage 4 Down arrows */
        /* L4: P7, P9, P10, P11, P12 */
        .arrow-down-S4-L4-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }
        .arrow-down-S4-L4-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }
        .arrow-down-S4-L4-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }
        .arrow-down-S4-L4-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }
        .arrow-down-S4-L4-P12 {
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + 10px);
            bottom: calc(var(--platform-height) * 4);
        }
        /* L3: P8, P10, P11 */
        .arrow-down-S4-L3-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: calc(var(--platform-height) * 3);
        }
        .arrow-down-S4-L3-P10 {
            left: calc(var(--pos-offset) + var(--pos-width) * 9 + 10px);
            bottom: calc(var(--platform-height) * 3);
        }
        .arrow-down-S4-L3-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) * 3);
        }
        /* L2: P7, P9, P11 */
        .arrow-down-S4-L2-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: calc(var(--platform-height) * 2);
        }
        .arrow-down-S4-L2-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: calc(var(--platform-height) * 2);
        }
        .arrow-down-S4-L2-P11 {
            left: calc(var(--pos-offset) + var(--pos-width) * 10 + 10px);
            bottom: calc(var(--platform-height) * 2);
        }
        /* L1: P7, P8, P9, P12 */
        .arrow-down-S4-L1-P7 {
            left: calc(var(--pos-offset) + var(--pos-width) * 6 + 10px);
            bottom: var(--platform-height);
        }
        .arrow-down-S4-L1-P8 {
            left: calc(var(--pos-offset) + var(--pos-width) * 7 + 10px);
            bottom: var(--platform-height);
        }
        .arrow-down-S4-L1-P9 {
            left: calc(var(--pos-offset) + var(--pos-width) * 8 + 10px);
            bottom: var(--platform-height);
        }
        .arrow-down-S4-L1-P12 {
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + 10px);
            bottom: var(--platform-height);
        }
        /* Stage 3 down arrows */
        .arrow-down-S3-L6-P16 {
            left: calc(var(--pos-offset) + var(--pos-width) * 15 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height));
        }
        .arrow-down-S3-L7-P13 {
            left: calc(var(--pos-offset) + var(--pos-width) * 12 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
        }
        .arrow-down-S3-L7-P14 {
            left: calc(var(--pos-offset) + var(--pos-width) * 13 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
        }
        .arrow-down-S3-L7-P18 {
            left: calc(var(--pos-offset) + var(--pos-width) * 17 + 10px);
            bottom: calc(var(--stage-height) + var(--platform-height) * 2);
        }

        /* Show horizontal arrows based on position (all levels) */
        /* Stage 1 arrows */
        #pos-1:checked ~ .game-world .arrow-S1-P1-P2 { display: block; }
        #pos-2:checked ~ .game-world .arrow-S1-P2-P1 { display: block; }
        #pos-2:checked ~ .game-world .arrow-S1-P2-P3 { display: block; }
        #pos-3:checked ~ .game-world .arrow-S1-P3-P2 { display: block; }
        #pos-3:checked ~ .game-world .arrow-S1-P3-P4 { display: block; }
        #pos-4:checked ~ .game-world .arrow-S1-P4-P3 { display: block; }
        #pos-4:checked ~ .game-world .arrow-S1-P4-P5 { display: block; }
        #pos-5:checked ~ .game-world .arrow-S1-P5-P4 { display: block; }
        #pos-5:checked ~ .game-world .arrow-S1-P5-P6 { display: block; }
        #pos-6:checked ~ .game-world .arrow-S1-P6-P5 { display: block; }
        /* Hide left arrow at poison location (S1-L1-P6) */
        #level-1:checked ~ #pos-6:checked ~ .game-world .arrow-S1-P6-P5 { display: none; }
        /* Arrow to S4/S2 area when door is open and player at S1-P6 (enters S4-L0-P7) */
        #level-0:checked ~ #pos-6:checked ~ #door-unlocked:checked ~ .game-world .arrow-S1-P6-S2-P7 { display: block; }
        #pos-6:checked ~ #door-unlocked:checked ~ .nav-panel .nav-right[for="pos-7"] { display: block; }
        /* Arrow back to S1 from S4-L0-P7 */
        #level-0:checked ~ #pos-7:checked ~ #door-unlocked:checked ~ .game-world .arrow-S2-P7-S1-P6 { display: block; }
        /* Stage 4 horizontal arrows (S4 uses levels 0-4, positions 7-12) */
        :is(#level-0, #level-2, #level-4):checked ~ #pos-7:checked ~ .game-world .arrow-S4-P7-P8 { display: block; }
        :is(#level-0, #level-2, #level-4):checked ~ #pos-8:checked ~ .game-world .arrow-S4-P8-P7 { display: block; }
        :is(#level-1, #level-4):checked ~ #pos-8:checked ~ .game-world .arrow-S4-P8-P9 { display: block; }
        :is(#level-1, #level-4):checked ~ #pos-9:checked ~ .game-world .arrow-S4-P9-P8 { display: block; }
        :is(#level-0, #level-2, #level-3):checked ~ #pos-9:checked ~ .game-world .arrow-S4-P9-P10 { display: block; }
        :is(#level-0, #level-2, #level-3):checked ~ #pos-10:checked ~ .game-world .arrow-S4-P10-P9 { display: block; }
        :is(#level-0, #level-1, #level-4):checked ~ #pos-10:checked ~ .game-world .arrow-S4-P10-P11 { display: block; }
        :is(#level-0, #level-1, #level-4):checked ~ #pos-11:checked ~ .game-world .arrow-S4-P11-P10 { display: block; }
        :is(#level-0, #level-1, #level-2, #level-4):checked ~ #pos-11:checked ~ .game-world .arrow-S4-P11-P12 { display: block; }
        :is(#level-0, #level-1, #level-2, #level-4):checked ~ #pos-12:checked ~ .game-world .arrow-S4-P12-P11 { display: block; }
        /* Stage 2 arrows (S2 uses levels 5-9) */
        /* S2 horizontal arrows only show at levels 5-9 */
        #level-5:checked ~ #pos-7:checked ~ .game-world .arrow-S2-P7-P8 { display: block; }
        #level-5:checked ~ #pos-8:checked ~ .game-world .arrow-S2-P8-P7 { display: block; }
        #level-5:checked ~ #pos-8:checked ~ .game-world .arrow-S2-P8-P9 { display: block; }
        #level-5:checked ~ #pos-9:checked ~ .game-world .arrow-S2-P9-P8 { display: block; }
        #level-5:checked ~ #pos-9:checked ~ .game-world .arrow-S2-P9-P10 { display: block; }
        /* Disease location at S2-L0-P10 (level-5, pos-10) - no arrows from this position */
        #level-5:checked ~ #pos-11:checked ~ .game-world .arrow-S2-P11-P10 { display: block; }
        #level-5:checked ~ #pos-11:checked ~ .game-world .arrow-S2-P11-P12 { display: block; }
        #level-5:checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-P11 { display: block; }
        /* S2 levels 6-9 in-game arrows (P7-P12 all walkable via platforms+branches) */
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-7:checked ~ .game-world .arrow-S2-P7-P8 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-8:checked ~ .game-world .arrow-S2-P8-P7 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-8:checked ~ .game-world .arrow-S2-P8-P9 { display: block; }
        :is(#level-7, #level-8, #level-9):checked ~ #pos-9:checked ~ .game-world .arrow-S2-P9-P8 { display: block; }
        :is(#level-7, #level-8, #level-9):checked ~ #pos-9:checked ~ .game-world .arrow-S2-P9-P10 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-10:checked ~ .game-world .arrow-S2-P10-P9 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-10:checked ~ .game-world .arrow-S2-P10-P11 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-11:checked ~ .game-world .arrow-S2-P11-P10 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-11:checked ~ .game-world .arrow-S2-P11-P12 { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-P11 { display: block; }
        /* Arrows to/from Stage 3 (S3 also uses levels 5-9) */
        #level-5:checked ~ #pos-12:checked ~ #tree-chopped:checked ~ .game-world .arrow-S2-P12-S3-P13 { display: block; }
        #level-6:checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-S3-P13 { display: block; }
        #level-7:checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-S3-P13 { display: block; }
        #level-8:checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-S3-P13 { display: block; }
        #level-9:checked ~ #pos-12:checked ~ .game-world .arrow-S2-P12-S3-P13 { display: block; }
        #pos-13:checked ~ .game-world .arrow-S3-P13-S2-P12 { display: block; }
        /* Stage 3 horizontal arrows in game world (S3 uses levels 5-9) */
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-13:checked ~ .game-world .arrow-S3-P13-P14 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-14:checked ~ .game-world .arrow-S3-P14-P13 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-14:checked ~ .game-world .arrow-S3-P14-P15 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-15:checked ~ .game-world .arrow-S3-P15-P14 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-15:checked ~ .game-world .arrow-S3-P15-P16 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-16:checked ~ .game-world .arrow-S3-P16-P15 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-16:checked ~ .game-world .arrow-S3-P16-P17 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-17:checked ~ .game-world .arrow-S3-P17-P16 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-17:checked ~ .game-world .arrow-S3-P17-P18 { display: block; }
        :is(#level-5, #level-6, #level-7, #level-8, #level-9):checked ~ #pos-18:checked ~ .game-world .arrow-S3-P18-P17 { display: block; }
        /* Hide horizontal arrows at L9 platform gaps (P4, P5, P6 have no platform at L9) */
        #level-9:checked ~ #pos-15:checked ~ .game-world .arrow-S3-P15-P16 { display: none; }
        #level-9:checked ~ #pos-16:checked ~ .game-world .arrow-S3-P16-P15 { display: none; }
        #level-9:checked ~ #pos-16:checked ~ .game-world .arrow-S3-P16-P17 { display: none; }
        #level-9:checked ~ #pos-17:checked ~ .game-world .arrow-S3-P17-P16 { display: none; }
        #level-9:checked ~ #pos-17:checked ~ .game-world .arrow-S3-P17-P18 { display: none; }
        #level-9:checked ~ #pos-18:checked ~ .game-world .arrow-S3-P18-P17 { display: none; }
        /* Hide arrows at S3 platform ends */
        #level-6:checked ~ #pos-14:checked ~ .game-world .arrow-S3-P14-P15 { display: none; }
        #level-6:checked ~ #pos-15:checked ~ .game-world .arrow-S3-P15-P14 { display: none; }
        #level-7:checked ~ #pos-14:checked ~ .game-world .arrow-S3-P14-P15 { display: none; }
        #level-7:checked ~ #pos-15:checked ~ .game-world .arrow-S3-P15-P14 { display: none; }

        /* Show up arrow at ladder locations */
        /* Ladder 1: level 0, position 5 */
        #level-0:checked ~ #pos-5:checked ~ .game-world .arrow-up-S1-L0-P5 { display: block; }
        /* Ladder 2: level 1, position 3 */
        #level-1:checked ~ #pos-3:checked ~ .game-world .arrow-up-S1-L1-P3 { display: block; }
        /* Ladder 3: level 2, position 1 */
        #level-2:checked ~ #pos-1:checked ~ .game-world .arrow-up-S1-L2-P1 { display: block; }
        /* Ladder 4: level 3, position 4 */
        #level-3:checked ~ #pos-4:checked ~ .game-world .arrow-up-S1-L3-P4 { display: block; }
        /* Stage 2 up arrows: S2-L5-P8, S2-L5-P11, S2-L6-P7, S2-L6-P10, S2-L7-P11, S2-L8-P9 */
        /* S2 uses levels 5-9 (same heights as 0-4) */
        #level-5:checked ~ #pos-8:checked ~ .game-world .arrow-up-S2-L5-P8 { display: block; }
        #level-5:checked ~ #pos-11:checked ~ .game-world .arrow-up-S2-L5-P11 { display: block; }
        #level-6:checked ~ #pos-7:checked ~ .game-world .arrow-up-S2-L6-P7 { display: block; }
        #level-6:checked ~ #pos-10:checked ~ .game-world .arrow-up-S2-L6-P10 { display: block; }
        #level-7:checked ~ #pos-11:checked ~ .game-world .arrow-up-S2-L7-P11 { display: block; }
        #level-8:checked ~ #pos-9:checked ~ .game-world .arrow-up-S2-L8-P9 { display: block; }
        /* Stage 4 up arrows (S4 uses levels 0-4) */
        /* L0: P7, P8, P9, P12 */
        #level-0:checked ~ #pos-7:checked ~ .game-world .arrow-up-S4-L0-P7 { display: block; }
        #level-0:checked ~ #pos-8:checked ~ .game-world .arrow-up-S4-L0-P8 { display: block; }
        #level-0:checked ~ #pos-9:checked ~ .game-world .arrow-up-S4-L0-P9 { display: block; }
        #level-0:checked ~ #pos-12:checked ~ .game-world .arrow-up-S4-L0-P12 { display: block; }
        /* L1: P7, P9, P11 */
        #level-1:checked ~ #pos-7:checked ~ .game-world .arrow-up-S4-L1-P7 { display: block; }
        #level-1:checked ~ #pos-9:checked ~ .game-world .arrow-up-S4-L1-P9 { display: block; }
        #level-1:checked ~ #pos-11:checked ~ .game-world .arrow-up-S4-L1-P11 { display: block; }
        /* L2: P8, P10, P11 */
        #level-2:checked ~ #pos-8:checked ~ .game-world .arrow-up-S4-L2-P8 { display: block; }
        #level-2:checked ~ #pos-10:checked ~ .game-world .arrow-up-S4-L2-P10 { display: block; }
        #level-2:checked ~ #pos-11:checked ~ .game-world .arrow-up-S4-L2-P11 { display: block; }
        /* L3: P7, P9, P10, P11, P12 */
        #level-3:checked ~ #pos-7:checked ~ .game-world .arrow-up-S4-L3-P7 { display: block; }
        #level-3:checked ~ #pos-9:checked ~ .game-world .arrow-up-S4-L3-P9 { display: block; }
        #level-3:checked ~ #pos-10:checked ~ .game-world .arrow-up-S4-L3-P10 { display: block; }
        #level-3:checked ~ #pos-11:checked ~ .game-world .arrow-up-S4-L3-P11 { display: block; }
        #level-3:checked ~ #pos-12:checked ~ .game-world .arrow-up-S4-L3-P12 { display: block; }
        /* L4: P7 (climb to S2) */
        #level-4:checked ~ #pos-7:checked ~ .game-world .arrow-up-S4-L4-P7 { display: block; }
        /* Stage 3 up arrows (S3 uses levels 5-9) */
        #level-5:checked ~ #pos-16:checked ~ .game-world .arrow-up-S3-L5-P16 { display: block; }
        #level-6:checked ~ #pos-18:checked ~ .game-world .arrow-up-S3-L6-P18 { display: block; }
        #level-8:checked ~ #pos-17:checked ~ .game-world .arrow-up-S3-L8-P17 { display: block; }
        /* Stage 3 phantom position arrows (fall left/right from floating platform) */
        #level-8:checked ~ #pos-φ:checked ~ .game-world .arrow-left-S3-Pφ { display: block; }
        #level-8:checked ~ #pos-φ:checked ~ .game-world .arrow-right-S3-Pφ { display: block; }

        /* Show down arrow at platform gaps */
        #level-1:checked ~ #pos-1:checked ~ .game-world .arrow-down-S1-L1-P1 { display: block; }
        #level-2:checked ~ #pos-5:checked ~ .game-world .arrow-down-S1-L2-P5 { display: block; }
        #level-3:checked ~ #pos-3:checked ~ .game-world .arrow-down-S1-L3-P3 { display: block; }
        #level-4:checked ~ #pos-6:checked ~ .game-world .arrow-down-S1-L4-P6 { display: block; }
        /* Stage 2 down arrows (S2 uses levels 5-9, same heights as 0-4) */
        #level-6:checked ~ #pos-7:checked ~ .game-world .arrow-down-S2-L6-P7 { display: block; }
        #level-6:checked ~ #pos-11:checked ~ .game-world .arrow-down-S2-L6-P11 { display: block; }
        #level-7:checked ~ #pos-8:checked ~ .game-world .arrow-down-S2-L7-P8 { display: block; }
        #level-8:checked ~ #pos-10:checked ~ .game-world .arrow-down-S2-L8-P10 { display: block; }
        #level-9:checked ~ #pos-7:checked ~ .game-world .arrow-down-S2-L9-P7 { display: block; }
        /* Climb down from S2-L5-P7 to S4-L4-P7 */
        #level-5:checked ~ #pos-7:checked ~ .game-world .arrow-down-S2-L5-P7-to-S4 { display: block; }
        /* Stage 4 down arrows (S4 uses levels 0-4) */
        /* L4: P7, P9, P10, P11, P12 */
        #level-4:checked ~ #pos-7:checked ~ .game-world .arrow-down-S4-L4-P7 { display: block; }
        #level-4:checked ~ #pos-9:checked ~ .game-world .arrow-down-S4-L4-P9 { display: block; }
        #level-4:checked ~ #pos-10:checked ~ .game-world .arrow-down-S4-L4-P10 { display: block; }
        #level-4:checked ~ #pos-11:checked ~ .game-world .arrow-down-S4-L4-P11 { display: block; }
        #level-4:checked ~ #pos-12:checked ~ .game-world .arrow-down-S4-L4-P12 { display: block; }
        /* L3: P8, P10, P11 */
        #level-3:checked ~ #pos-8:checked ~ .game-world .arrow-down-S4-L3-P8 { display: block; }
        #level-3:checked ~ #pos-10:checked ~ .game-world .arrow-down-S4-L3-P10 { display: block; }
        #level-3:checked ~ #pos-11:checked ~ .game-world .arrow-down-S4-L3-P11 { display: block; }
        /* L2: P7, P9, P11 */
        #level-2:checked ~ #pos-7:checked ~ .game-world .arrow-down-S4-L2-P7 { display: block; }
        #level-2:checked ~ #pos-9:checked ~ .game-world .arrow-down-S4-L2-P9 { display: block; }
        #level-2:checked ~ #pos-11:checked ~ .game-world .arrow-down-S4-L2-P11 { display: block; }
        /* L1: P7, P8, P9, P12 */
        #level-1:checked ~ #pos-7:checked ~ .game-world .arrow-down-S4-L1-P7 { display: block; }
        #level-1:checked ~ #pos-8:checked ~ .game-world .arrow-down-S4-L1-P8 { display: block; }
        #level-1:checked ~ #pos-9:checked ~ .game-world .arrow-down-S4-L1-P9 { display: block; }
        #level-1:checked ~ #pos-12:checked ~ .game-world .arrow-down-S4-L1-P12 { display: block; }
        /* Stage 3 down arrows (S3 uses levels 5-9) */
        #level-6:checked ~ #pos-16:checked ~ .game-world .arrow-down-S3-L6-P16 { display: block; }
        #level-7:checked ~ #pos-13:checked ~ .game-world .arrow-down-S3-L7-P13 { display: block; }
        #level-7:checked ~ #pos-14:checked ~ .game-world .arrow-down-S3-L7-P14 { display: block; }
        #level-7:checked ~ #pos-18:checked ~ .game-world .arrow-down-S3-L7-P18 { display: block; }

        /* Fixed navigation panel - 3x3 grid */
        .nav-panel {
            position: absolute;
            top: var(--panel-top);
            left: var(--panel-left);
            width: var(--nav-panel-width);
            height: var(--nav-panel-height);
            z-index: var(--z-ui);
            border: 2px solid var(--border-color);
            border-radius: 4px;
            background: #0000004d;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
            place-items: center;
        }

        .nav-cell {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .nav-cell-up { grid-column: 2; grid-row: 1; }
        .nav-cell-down { grid-column: 2; grid-row: 3; }
        .nav-cell-left { grid-column: 1; grid-row: 2; }
        .nav-cell-right { grid-column: 3; grid-row: 2; }

        /* Arrow triangles (gray inactive shown via ::before, yellow active via ::after on labels) */
        .nav-cell::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
        }
        /* Shared transparent borders for vertical arrows (up/down) */
        .nav-cell-up::before, .nav-cell-down::before, .nav-up, .nav-down {
            border-left: 13px solid transparent;
            border-right: 13px solid transparent;
        }
        /* Shared transparent borders for horizontal arrows (left/right) */
        .nav-cell-left::before, .nav-cell-right::before, .nav-left, .nav-right {
            border-top: 13px solid transparent;
            border-bottom: 13px solid transparent;
        }
        /* Inactive (gray) colored borders */
        .nav-cell-up::before { border-bottom: 18px solid var(--inactive-arrow-color); }
        .nav-cell-down::before { border-top: 18px solid var(--inactive-arrow-color); }
        .nav-cell-left::before { border-right: 18px solid var(--inactive-arrow-color); }
        .nav-cell-right::before { border-left: 18px solid var(--inactive-arrow-color); }

        .nav-btn {
            position: absolute;
            width: 0;
            height: 0;
            cursor: pointer;
            display: none;
            filter: drop-shadow(0 0 4px var(--nav-arrow-color));
        }
        .nav-btn:hover {
            filter: drop-shadow(0 0 10px var(--nav-arrow-color)) drop-shadow(0 0 15px var(--nav-arrow-color));
        }

        /* Active (yellow) colored borders */
        .nav-up { border-bottom: 18px solid var(--nav-arrow-color); }
        .nav-down { border-top: 18px solid var(--nav-arrow-color); }
        .nav-left { border-right: 18px solid var(--nav-arrow-color); }
        .nav-right { border-left: 18px solid var(--nav-arrow-color); }

        /* Show correct left arrow based on current position */
        #pos-2:checked ~ .nav-panel .nav-left[for="pos-1"] { display: block; }
        #pos-3:checked ~ .nav-panel .nav-left[for="pos-2"] { display: block; }
        #pos-4:checked ~ .nav-panel .nav-left[for="pos-3"] { display: block; }
        #pos-5:checked ~ .nav-panel .nav-left[for="pos-4"] { display: block; }
        #pos-6:checked ~ .nav-panel .nav-left[for="pos-5"] { display: block; }
        /* Hide left arrow at poison location (S1-L1-P6) */
        #level-1:checked ~ #pos-6:checked ~ .nav-panel .nav-left[for="pos-5"] { display: none; }

        /* Show correct right arrow based on current position */
        #pos-1:checked ~ .nav-panel .nav-right[for="pos-2"] { display: block; }
        #pos-2:checked ~ .nav-panel .nav-right[for="pos-3"] { display: block; }
        #pos-3:checked ~ .nav-panel .nav-right[for="pos-4"] { display: block; }
        #pos-4:checked ~ .nav-panel .nav-right[for="pos-5"] { display: block; }
        #pos-5:checked ~ .nav-panel .nav-right[for="pos-6"] { display: block; }
        /* S4 nav panel arrows (levels 0-4) */
        /* Back to S1 from L0-P7 */
        #level-0:checked ~ #pos-7:checked ~ #door-unlocked:checked ~ .nav-panel .nav-left[for="pos-6"] { display: block; }
        /* S4 horizontal nav arrows */
        :is(#level-0, #level-2, #level-4):checked ~ #pos-7:checked ~ .nav-panel .nav-right[for="pos-8"] { display: block; }
        :is(#level-0, #level-2, #level-4):checked ~ #pos-8:checked ~ .nav-panel .nav-left[for="pos-7"] { display: block; }
        :is(#level-1, #level-4):checked ~ #pos-8:checked ~ .nav-panel .nav-right[for="pos-9"] { display: block; }
        :is(#level-1, #level-4):checked ~ #pos-9:checked ~ .nav-panel .nav-left[for="pos-8"] { display: block; }
        :is(#level-0, #level-2, #level-3):checked ~ #pos-9:checked ~ .nav-panel .nav-right[for="pos-10"] { display: block; }
        :is(#level-0, #level-2, #level-3):checked ~ #pos-10:checked ~ .nav-panel .nav-left[for="pos-9"] { display: block; }
        :is(#level-0, #level-1, #level-4):checked ~ #pos-10:checked ~ .nav-panel .nav-right[for="pos-11"] { display: block; }
        :is(#level-0, #level-1, #level-4):checked ~ #pos-11:checked ~ .nav-panel .nav-left[for="pos-10"] { display: block; }
        :is(#level-0, #level-1, #level-2, #level-4):checked ~ #pos-11:checked ~ .nav-panel .nav-right[for="pos-12"] { display: block; }
        :is(#level-0, #level-1, #level-2, #level-4):checked ~ #pos-12:checked ~ .nav-panel .nav-left[for="pos-11"] { display: block; }
        /* S2 nav panel arrows (levels 5-9) */
        #level-5:checked ~ #pos-7:checked ~ .nav-panel .nav-right[for="pos-8"] { display: block; }
        #level-5:checked ~ #pos-8:checked ~ .nav-panel .nav-left[for="pos-7"] { display: block; }
        #level-5:checked ~ #pos-8:checked ~ .nav-panel .nav-right[for="pos-9"] { display: block; }
        #level-5:checked ~ #pos-9:checked ~ .nav-panel .nav-left[for="pos-8"] { display: block; }
        #level-5:checked ~ #pos-9:checked ~ .nav-panel .nav-right[for="pos-10"] { display: block; }
        /* Disease location at S2-L0-P10 (level-5, pos-10) - no nav arrows from this position */
        #level-5:checked ~ #pos-11:checked ~ .nav-panel .nav-left[for="pos-10"] { display: block; }
        #level-5:checked ~ #pos-11:checked ~ .nav-panel .nav-right[for="pos-12"] { display: block; }
        #level-5:checked ~ #pos-12:checked ~ .nav-panel .nav-left[for="pos-11"] { display: block; }
        /* S2 levels 6-9 nav arrows (P7-P12 all walkable via platforms+branches) */
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-7:checked ~ .nav-panel .nav-right[for="pos-8"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-8:checked ~ .nav-panel .nav-left[for="pos-7"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-8:checked ~ .nav-panel .nav-right[for="pos-9"] { display: block; }
        :is(#level-7, #level-8, #level-9):checked ~ #pos-9:checked ~ .nav-panel .nav-left[for="pos-8"] { display: block; }
        :is(#level-7, #level-8, #level-9):checked ~ #pos-9:checked ~ .nav-panel .nav-right[for="pos-10"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-10:checked ~ .nav-panel .nav-left[for="pos-9"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-10:checked ~ .nav-panel .nav-right[for="pos-11"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-11:checked ~ .nav-panel .nav-left[for="pos-10"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-11:checked ~ .nav-panel .nav-right[for="pos-12"] { display: block; }
        :is(#level-6, #level-7, #level-8, #level-9):checked ~ #pos-12:checked ~ .nav-panel .nav-left[for="pos-11"] { display: block; }
        /* Arrows to/from Stage 3 (S2/S3 use levels 5-9) */
        #level-5:checked ~ #pos-12:checked ~ #tree-chopped:checked ~ .nav-panel .nav-right[for="pos-13"] { display: block; }
        #level-6:checked ~ #pos-12:checked ~ .nav-panel .nav-right[for="pos-13"] { display: block; }
        #level-7:checked ~ #pos-12:checked ~ .nav-panel .nav-right[for="pos-13"] { display: block; }
        #level-8:checked ~ #pos-12:checked ~ .nav-panel .nav-right[for="pos-13"] { display: block; }
        #level-9:checked ~ #pos-12:checked ~ .nav-panel .nav-right[for="pos-13"] { display: block; }
        #pos-13:checked ~ .nav-panel .nav-left[for="pos-12"] { display: block; }
        /* Stage 3 nav panel horizontal arrows */
        #pos-13:checked ~ .nav-panel .nav-right[for="pos-14"] { display: block; }
        #pos-14:checked ~ .nav-panel .nav-left[for="pos-13"] { display: block; }
        #pos-14:checked ~ .nav-panel .nav-right[for="pos-15"] { display: block; }
        #pos-15:checked ~ .nav-panel .nav-left[for="pos-14"] { display: block; }
        #pos-15:checked ~ .nav-panel .nav-right[for="pos-16"] { display: block; }
        #pos-16:checked ~ .nav-panel .nav-left[for="pos-15"] { display: block; }
        #pos-16:checked ~ .nav-panel .nav-right[for="pos-17"] { display: block; }
        #pos-17:checked ~ .nav-panel .nav-left[for="pos-16"] { display: block; }
        #pos-17:checked ~ .nav-panel .nav-right[for="pos-18"] { display: block; }
        #pos-18:checked ~ .nav-panel .nav-left[for="pos-17"] { display: block; }
        /* Stage 3 phantom position nav arrows (fall left/right from floating platform) - S3 uses levels 5-9 */
        #level-8:checked ~ #pos-φ:checked ~ .nav-panel .nav-left[for="pos-16"] { display: block; }
        #level-8:checked ~ #pos-φ:checked ~ .nav-panel .nav-right[for="pos-18"] { display: block; }
        /* Hide nav arrows at L9 platform gaps (equivalent to L4 in display) */
        #level-9:checked ~ #pos-15:checked ~ .nav-panel .nav-right[for="pos-16"] { display: none; }
        #level-9:checked ~ #pos-16:checked ~ .nav-panel .nav-left[for="pos-15"] { display: none; }
        #level-9:checked ~ #pos-16:checked ~ .nav-panel .nav-right[for="pos-17"] { display: none; }
        #level-9:checked ~ #pos-17:checked ~ .nav-panel .nav-left[for="pos-16"] { display: none; }
        #level-9:checked ~ #pos-17:checked ~ .nav-panel .nav-right[for="pos-18"] { display: none; }
        #level-9:checked ~ #pos-18:checked ~ .nav-panel .nav-left[for="pos-17"] { display: none; }
        /* Hide nav arrows at S3 platform ends (L6=L1, L7=L2) */
        #level-6:checked ~ #pos-14:checked ~ .nav-panel .nav-right[for="pos-15"] { display: none; }
        #level-6:checked ~ #pos-15:checked ~ .nav-panel .nav-left[for="pos-14"] { display: none; }
        #level-7:checked ~ #pos-14:checked ~ .nav-panel .nav-right[for="pos-15"] { display: none; }
        #level-7:checked ~ #pos-15:checked ~ .nav-panel .nav-left[for="pos-14"] { display: none; }

        /* Show up arrow at ladder locations */
        #level-0:checked ~ #pos-5:checked ~ .nav-panel .nav-up[for="level-1"] { display: block; }
        #level-1:checked ~ #pos-3:checked ~ .nav-panel .nav-up[for="level-2"] { display: block; }
        #level-2:checked ~ #pos-1:checked ~ .nav-panel .nav-up[for="level-3"] { display: block; }
        #level-3:checked ~ #pos-4:checked ~ .nav-panel .nav-up[for="level-4"] { display: block; }
        /* Stage 4 up arrows (S4 uses levels 0-4) */
        #level-0:checked ~ :is(#pos-7, #pos-8, #pos-9, #pos-12):checked ~ .nav-panel .nav-up[for="level-1"] { display: block; }
        #level-1:checked ~ :is(#pos-7, #pos-9, #pos-11):checked ~ .nav-panel .nav-up[for="level-2"] { display: block; }
        #level-2:checked ~ :is(#pos-8, #pos-10, #pos-11):checked ~ .nav-panel .nav-up[for="level-3"] { display: block; }
        #level-3:checked ~ :is(#pos-7, #pos-9, #pos-10, #pos-11, #pos-12):checked ~ .nav-panel .nav-up[for="level-4"] { display: block; }
        #level-4:checked ~ #pos-7:checked ~ .nav-panel .nav-up[for="level-5"] { display: block; }
        /* Stage 2 up arrows (S2 uses levels 5-9) */
        #level-5:checked ~ #pos-8:checked ~ .nav-panel .nav-up[for="level-6"] { display: block; }
        #level-5:checked ~ #pos-11:checked ~ .nav-panel .nav-up[for="level-6"] { display: block; }
        #level-6:checked ~ #pos-7:checked ~ .nav-panel .nav-up[for="level-7"] { display: block; }
        #level-6:checked ~ #pos-10:checked ~ .nav-panel .nav-up[for="level-7"] { display: block; }
        #level-7:checked ~ #pos-11:checked ~ .nav-panel .nav-up[for="level-8"] { display: block; }
        #level-8:checked ~ #pos-9:checked ~ .nav-panel .nav-up[for="level-9"] { display: block; }
        /* Stage 3 nav up (S3 uses levels 5-9) */
        #level-5:checked ~ #pos-16:checked ~ .nav-panel .nav-up[for="level-6"] { display: block; }
        #level-6:checked ~ #pos-18:checked ~ .nav-panel .nav-up[for="level-7"] { display: block; }
        #level-8:checked ~ #pos-17:checked ~ .nav-panel .nav-up[for="pos-φ"] { display: block; }

        /* Show down arrow at grate locations */
        #level-1:checked ~ #pos-1:checked ~ .nav-panel .nav-down[for="level-0"] { display: block; }
        #level-2:checked ~ #pos-5:checked ~ .nav-panel .nav-down[for="level-1"] { display: block; }
        #level-3:checked ~ #pos-3:checked ~ .nav-panel .nav-down[for="level-2"] { display: block; }
        #level-4:checked ~ #pos-6:checked ~ .nav-panel .nav-down[for="level-3"] { display: block; }
        /* S2→S4 climb down at P7 */
        #level-5:checked ~ #pos-7:checked ~ .nav-panel .nav-down[for="level-4"] { display: block; }
        /* Stage 4 down arrows (S4 uses levels 0-4) */
        #level-4:checked ~ :is(#pos-7, #pos-9, #pos-10, #pos-11, #pos-12):checked ~ .nav-panel .nav-down[for="level-3"] { display: block; }
        #level-3:checked ~ :is(#pos-8, #pos-10, #pos-11):checked ~ .nav-panel .nav-down[for="level-2"] { display: block; }
        #level-2:checked ~ :is(#pos-7, #pos-9, #pos-11):checked ~ .nav-panel .nav-down[for="level-1"] { display: block; }
        #level-1:checked ~ :is(#pos-7, #pos-8, #pos-9, #pos-12):checked ~ .nav-panel .nav-down[for="level-0"] { display: block; }
        /* Stage 2 down arrows (S2 uses levels 5-9) */
        #level-6:checked ~ #pos-7:checked ~ .nav-panel .nav-down[for="level-5"] { display: block; }
        #level-6:checked ~ #pos-11:checked ~ .nav-panel .nav-down[for="level-5"] { display: block; }
        #level-7:checked ~ #pos-8:checked ~ .nav-panel .nav-down[for="level-6"] { display: block; }
        #level-8:checked ~ #pos-10:checked ~ .nav-panel .nav-down[for="level-7"] { display: block; }
        #level-9:checked ~ #pos-7:checked ~ .nav-panel .nav-down[for="level-8"] { display: block; }
        /* Stage 3 nav down (S3 uses levels 5-9) */
        #level-6:checked ~ #pos-16:checked ~ .nav-panel .nav-down[for="level-5"] { display: block; }
        #level-7:checked ~ #pos-13:checked ~ .nav-panel .nav-down[for="level-6"] { display: block; }
        #level-7:checked ~ #pos-14:checked ~ .nav-panel .nav-down[for="level-6"] { display: block; }
        #level-7:checked ~ #pos-18:checked ~ .nav-panel .nav-down[for="level-6"] { display: block; }

        /* loot - animated elements that fly to counter when picked up */
        .loot-in-game {
            position: absolute;
            width: 24px;
            height: 24px;
            z-index: var(--z-loot);
            pointer-events: none;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out;
        }
        .loot-in-game svg {
            width: 100%;
            height: 100%;
        }
        .coin .loot-in-game {
            color: var(--gold-color);
        }
        .aquamarine .loot-in-game {
            color: var(--aquamarine-color-1);
            filter: drop-shadow(0 0 3px var(--aquamarine-color-1));
            animation: aquamarine-sparkle 1s ease-in-out infinite;
        }
        .ruby .loot-in-game {
            filter: drop-shadow(0 0 3px var(--ruby-color-1));
            animation: ruby-sparkle 1s ease-in-out infinite;
        }

        /* loot positions - on platforms */
        .loot-S1-L0-P3 {
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 2 - var(--item-offset));
        }
        .loot-S1-L1-P4 {
            bottom: calc(var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 3 - var(--item-offset));
        }
        .loot-S1-L3-P5 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 4 - var(--item-offset));
        }
        .loot-S1-L2-P1 {
            bottom: calc(var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) - var(--item-offset));
        }
        .loot-S1-L4-P2 {
            bottom: calc(var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 1 - var(--item-offset));
        }

        /* Stage 2 loot positions */
        .loot-S2-L5-P8 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 7 - var(--item-offset));
        }
        .loot-S2-L6-P11 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 10 - var(--item-offset));
        }
        .loot-S2-L7-P7 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 2 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 6 - var(--item-offset));
        }
        .loot-S2-L8-P9 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 8 - var(--item-offset));
        }
        .loot-S2-L9-P10 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 9 - var(--item-offset));
        }

        /* Stage 3 loot positions */
        .loot-S3-L5-P18 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 17 - var(--item-offset));
        }
        .loot-S3-L5-P15 {
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 14 - var(--item-offset));
        }
        .loot-S3-L8-P18 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 17 - var(--item-offset));
        }
        .loot-S3-L9-P14 {
            bottom: calc(var(--stage-height) + var(--platform-height) * 4 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 13 - var(--item-offset));
        }

        /* Stage 4 loot positions - hidden by default, only show when player adjacent */
        .container.loot-S4-L3-P7,
        .container.loot-S4-L3-P8,
        .container.loot-S4-L3-P12,
        .container.loot-S4-L1-P10,
        .container.loot-S4-L0-P9 {
            display: none;
        }
        .loot-S4-L3-P7 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 6 - var(--item-offset));
        }
        .loot-S4-L3-P8 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 7 - var(--item-offset));
        }
        .loot-S4-L3-P12 {
            bottom: calc(var(--platform-height) * 3 + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 - var(--item-offset));
        }
        .loot-S4-L1-P10 {
            bottom: calc(var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 9 - var(--item-offset));
        }
        .loot-S4-L0-P9 {
            bottom: var(--ground-height);
            left: calc(var(--pos-offset) + var(--pos-width) * 8 - var(--item-offset));
        }
        /* Show S4 loot only when player is at that position */
        #level-3:checked ~ #pos-7:checked ~ #loot-S4-L3-P7-pickup:not(:checked) ~ .game-world .loot-S4-L3-P7,
        :is(#level-2:checked ~ #pos-7:checked, #level-4:checked ~ #pos-7:checked, #level-3:checked ~ #pos-8:checked) ~ #torch-pickup:checked ~ #loot-S4-L3-P7-pickup:not(:checked) ~ .game-world .loot-S4-L3-P7 { display: block; }
        #level-3:checked ~ #pos-8:checked ~ #loot-S4-L3-P8-pickup:not(:checked) ~ .game-world .loot-S4-L3-P8,
        :is(#level-2:checked ~ #pos-8:checked, #level-3:checked ~ #pos-9:checked, #level-3:checked ~ #pos-7:checked, #level-4:checked ~ #pos-8:checked) ~ #torch-pickup:checked ~ #loot-S4-L3-P8-pickup:not(:checked) ~ .game-world .loot-S4-L3-P8 { display: block; }
        #level-3:checked ~ #pos-12:checked ~ #loot-S4-L3-P12-pickup:not(:checked) ~ .game-world .loot-S4-L3-P12,
        :is(#level-2:checked ~ #pos-12:checked, #level-4:checked ~ #pos-12:checked, #level-3:checked ~ #pos-11:checked) ~ #torch-pickup:checked ~ #loot-S4-L3-P12-pickup:not(:checked) ~ .game-world .loot-S4-L3-P12 { display: block; }
        #level-1:checked ~ #pos-10:checked ~ #loot-S4-L1-P10-pickup:not(:checked) ~ .game-world .loot-S4-L1-P10,
        :is(#level-0:checked ~ #pos-10:checked, #level-2:checked ~ #pos-10:checked, #level-1:checked ~ #pos-9:checked, #level-1:checked ~ #pos-11:checked) ~ #torch-pickup:checked ~ #loot-S4-L1-P10-pickup:not(:checked) ~ .game-world .loot-S4-L1-P10 { display: block; }
        #level-0:checked ~ #pos-9:checked ~ #loot-S4-L0-P9-pickup:not(:checked) ~ .game-world .loot-S4-L0-P9,
        :is(#level-1:checked ~ #pos-9:checked, #level-0:checked ~ #pos-8:checked, #level-0:checked ~ #pos-10:checked) ~ #torch-pickup:checked ~ #loot-S4-L0-P9-pickup:not(:checked) ~ .game-world .loot-S4-L0-P9 { display: block; }

        /* ========== KEYFRAME ANIMATIONS ========== */
        @keyframes idle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        @keyframes inventory-fade-in {
            to { opacity: 1; }
        }
        @keyframes hazard-roll {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }
        @keyframes tree-pulse {
            0%, 100% { filter: drop-shadow(0 0 8px #4a4); }
            50% { filter: drop-shadow(0 0 15px #4a4) drop-shadow(0 0 25px #4a4); }
        }
        @keyframes door-pulse {
            0%, 100% { filter: drop-shadow(1px 1px 0 #aaa) drop-shadow(-1px -1px 0 #444) drop-shadow(0 0 4px #6a6a6a); }
            50% { filter: drop-shadow(1px 1px 0 #aaa) drop-shadow(-1px -1px 0 #444) drop-shadow(0 0 12px #9a9a9a) drop-shadow(0 0 20px #6a6a6a); }
        }
        @keyframes bolt-flicker {
            0%, 5% { opacity: 1; filter: drop-shadow(0 0 8px var(--bolt-color-1)) drop-shadow(0 0 15px var(--bolt-color-2)); translate: 2px -1px; }
            6%, 15% { opacity: 0; translate: 0 0; }
            16%, 21% { opacity: 1; filter: drop-shadow(0 0 6px var(--bolt-color-1)); translate: -2px 2px; }
            22%, 24% { opacity: 0; translate: 0 0; }
            25%, 29% { opacity: 1; filter: drop-shadow(0 0 4px var(--bolt-color-1)); translate: 1px -2px; }
            30%, 43% { opacity: 0; translate: 0 0; }
            44%, 49% { opacity: 1; filter: drop-shadow(0 0 10px var(--bolt-color-1)) drop-shadow(0 0 20px var(--bolt-color-2)); translate: -1px 1px; }
            50%, 63% { opacity: 0; translate: 0 0; }
            64%, 65% { opacity: 1; filter: drop-shadow(0 0 4px var(--bolt-color-1)); translate: 2px 2px; }
            66%, 70% { opacity: 0; translate: 0 0; }
            71%, 76% { opacity: 1; filter: drop-shadow(0 0 8px var(--bolt-color-1)); translate: -2px -2px; }
            77%, 85% { opacity: 0; translate: 0 0; }
            86% { opacity: 1; filter: drop-shadow(0 0 3px var(--bolt-color-1)); translate: -1px 2px; }
            87%, 90% { opacity: 0; translate: 0 0; }
            91%, 93% { opacity: 1; filter: drop-shadow(0 0 6px var(--bolt-color-1)); translate: 2px -1px; }
            94%, 100% { opacity: 0; translate: 0 0; }
        }
        @keyframes coin-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--gold-color)); }
            50% { filter: drop-shadow(0 0 12px var(--gold-color)) drop-shadow(0 0 20px var(--gold-color)); }
        }
        @keyframes flight-controls-offline {
            0%, 100% { filter: saturate(0); }
            50% { filter: saturate(0.2); }
        }
        @keyframes aquamarine-pulse {
            0%, 100% { color: var(--aquamarine-color-1); filter: drop-shadow(0 0 4px var(--aquamarine-color-1)); }
            17% { color: var(--aquamarine-color-2); filter: drop-shadow(0 0 8px var(--aquamarine-color-2)) drop-shadow(0 0 12px var(--aquamarine-color-1)); }
            33% { color: var(--aquamarine-color-3); filter: drop-shadow(0 0 12px var(--aquamarine-color-3)) drop-shadow(0 0 18px var(--aquamarine-color-2)); }
            50% { color: var(--aquamarine-color-4); filter: drop-shadow(0 0 16px var(--aquamarine-color-4)) drop-shadow(0 0 24px var(--aquamarine-color-3)); }
            67% { color: var(--aquamarine-color-3); filter: drop-shadow(0 0 12px var(--aquamarine-color-3)) drop-shadow(0 0 18px var(--aquamarine-color-2)); }
            83% { color: var(--aquamarine-color-2); filter: drop-shadow(0 0 8px var(--aquamarine-color-2)) drop-shadow(0 0 12px var(--aquamarine-color-1)); }
        }
        @keyframes aquamarine-sparkle {
            0%, 100% { color: var(--aquamarine-color-1); }
            17% { color: var(--aquamarine-color-2); }
            33% { color: var(--aquamarine-color-3); }
            50% { color: var(--aquamarine-color-4); }
            67% { color: var(--aquamarine-color-3); }
            83% { color: var(--aquamarine-color-2); }
        }
        @keyframes ruby-pulse {
            0%, 100% { color: var(--ruby-color-1); filter: drop-shadow(0 0 4px var(--ruby-color-1)); }
            17% { color: var(--ruby-color-2); filter: drop-shadow(0 0 8px var(--ruby-color-2)) drop-shadow(0 0 12px var(--ruby-color-1)); }
            33% { color: var(--ruby-color-3); filter: drop-shadow(0 0 12px var(--ruby-color-3)) drop-shadow(0 0 18px var(--ruby-color-2)); }
            50% { color: var(--ruby-color-4); filter: drop-shadow(0 0 16px var(--ruby-color-4)) drop-shadow(0 0 24px var(--ruby-color-3)); }
            67% { color: var(--ruby-color-3); filter: drop-shadow(0 0 12px var(--ruby-color-3)) drop-shadow(0 0 18px var(--ruby-color-2)); }
            83% { color: var(--ruby-color-2); filter: drop-shadow(0 0 8px var(--ruby-color-2)) drop-shadow(0 0 12px var(--ruby-color-1)); }
        }
        @keyframes ruby-sparkle {
            0%, 100% { color: var(--ruby-color-1); }
            17% { color: var(--ruby-color-2); }
            33% { color: var(--ruby-color-3); }
            50% { color: var(--ruby-color-4); }
            67% { color: var(--ruby-color-3); }
            83% { color: var(--ruby-color-2); }
        }
        @keyframes key-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--gold-color)); }
            50% { filter: drop-shadow(0 0 12px var(--gold-color)) drop-shadow(0 0 20px var(--gold-color)); }
        }
        @keyframes key-hovering-pulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 8px var(--gold-color)); }
            50% { transform: scale(1.2); filter: drop-shadow(0 0 15px var(--gold-color)) drop-shadow(0 0 25px var(--gold-color)); }
        }
        @keyframes wrench-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--wrench-color)); }
            50% { filter: drop-shadow(0 0 12px var(--wrench-color)) drop-shadow(0 0 20px var(--wrench-color)); }
        }
        @keyframes wrench-rotate {
            0% { transform: rotate(65deg); }
            80%, 100% { transform: rotate(0deg); }
        }
        @keyframes axe-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--axe-color)); }
            50% { filter: drop-shadow(0 0 12px var(--axe-color)) drop-shadow(0 0 20px var(--axe-color)); }
        }
        @keyframes axe-chop {
            0% { transform: rotate(0deg); }
            50%, 100% { transform: rotate(45deg); }
        }
        @keyframes battery-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--battery-color)); }
            50% { filter: drop-shadow(0 0 12px var(--battery-color)) drop-shadow(0 0 20px var(--battery-color)); }
        }
        @keyframes battery-hovering-pulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 8px var(--battery-color)); }
            50% { transform: scale(1.2); filter: drop-shadow(0 0 15px var(--battery-color)) drop-shadow(0 0 25px var(--battery-color)); }
        }
        @keyframes torch-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px yellow); }
            50% { filter: drop-shadow(0 0 12px yellow) drop-shadow(0 0 20px yellow); }
        }
        @keyframes idcard-pulse {
            0%, 100% { filter: drop-shadow(0 0 4px var(--idcard-color)); }
            50% { filter: drop-shadow(0 0 12px var(--idcard-color)) drop-shadow(0 0 20px var(--idcard-color)); }
        }
        @keyframes idcard-hovering-pulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 8px var(--idcard-color)); }
            50% { transform: scale(1.2); filter: drop-shadow(0 0 15px var(--idcard-color)) drop-shadow(0 0 25px var(--idcard-color)); }
        }

        /* Enable clicking and pulsing when player is adjacent */
        #level-0:checked ~ #pos-3:checked ~ #loot-S1-L0-P3-pickup:not(:checked) ~ .game-world .loot-S1-L0-P3 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-1:checked ~ #pos-4:checked ~ #loot-S1-L1-P4-pickup:not(:checked) ~ .game-world .loot-S1-L1-P4 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-3:checked ~ #pos-5:checked ~ #loot-S1-L3-P5-pickup:not(:checked) ~ .game-world .loot-S1-L3-P5 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-2:checked ~ #pos-1:checked ~ #loot-S1-L2-P1-pickup:not(:checked) ~ .game-world .loot-S1-L2-P1 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-4:checked ~ #pos-2:checked ~ #loot-S1-L4-P2-pickup:not(:checked) ~ .game-world .loot-S1-L4-P2 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        /* Stage 2 loot pulse/click (S2 uses levels 5-9, so L0->L5, L1->L6, etc) */
        #level-5:checked ~ #pos-8:checked ~ #loot-S2-L5-P8-pickup:not(:checked) ~ .game-world .loot-S2-L5-P8 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-6:checked ~ #pos-11:checked ~ #loot-S2-L6-P11-pickup:not(:checked) ~ .game-world .loot-S2-L6-P11 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: aquamarine-pulse 1s ease-in-out infinite;
        }
        #level-7:checked ~ #pos-7:checked ~ #loot-S2-L7-P7-pickup:not(:checked) ~ .game-world .loot-S2-L7-P7 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-8:checked ~ #pos-9:checked ~ #loot-S2-L8-P9-pickup:not(:checked) ~ .game-world .loot-S2-L8-P9 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: aquamarine-pulse 1s ease-in-out infinite;
        }
        #level-9:checked ~ #pos-10:checked ~ #loot-S2-L9-P10-pickup:not(:checked) ~ .game-world .loot-S2-L9-P10 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        /* Stage 3 loot pulse/click (S3 uses levels 5-9) */
        #level-5:checked ~ #pos-18:checked ~ #loot-S3-L5-P18-pickup:not(:checked) ~ .game-world .loot-S3-L5-P18 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: ruby-pulse 1s ease-in-out infinite;
        }
        #level-5:checked ~ #pos-15:checked ~ #loot-S3-L5-P15-pickup:not(:checked) ~ .game-world .loot-S3-L5-P15 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-8:checked ~ #pos-18:checked ~ #loot-S3-L8-P18-pickup:not(:checked) ~ .game-world .loot-S3-L8-P18 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-9:checked ~ #pos-14:checked ~ #loot-S3-L9-P14-pickup:not(:checked) ~ .game-world .loot-S3-L9-P14 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        /* Stage 4 loot pulse/click (S4 uses levels 0-4) */
        #level-3:checked ~ #pos-7:checked ~ #loot-S4-L3-P7-pickup:not(:checked) ~ .game-world .loot-S4-L3-P7 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-3:checked ~ #pos-8:checked ~ #loot-S4-L3-P8-pickup:not(:checked) ~ .game-world .loot-S4-L3-P8 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: aquamarine-pulse 1s ease-in-out infinite;
        }
        #level-3:checked ~ #pos-12:checked ~ #loot-S4-L3-P12-pickup:not(:checked) ~ .game-world .loot-S4-L3-P12 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }
        #level-1:checked ~ #pos-10:checked ~ #loot-S4-L1-P10-pickup:not(:checked) ~ .game-world .loot-S4-L1-P10 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: aquamarine-pulse 1s ease-in-out infinite;
        }
        #level-0:checked ~ #pos-9:checked ~ #loot-S4-L0-P9-pickup:not(:checked) ~ .game-world .loot-S4-L0-P9 .loot-in-game {
            pointer-events: auto;
            cursor: pointer;
            animation: coin-pulse 1s ease-in-out infinite;
        }

        /* Move Stage 1 loot to counter when picked up */
        #loot-S1-L0-P3-pickup:checked ~ .game-world .loot-S1-L0-P3,
        #loot-S1-L1-P4-pickup:checked ~ .game-world .loot-S1-L1-P4,
        #loot-S1-L3-P5-pickup:checked ~ .game-world .loot-S1-L3-P5,
        #loot-S1-L2-P1-pickup:checked ~ .game-world .loot-S1-L2-P1,
        #loot-S1-L4-P2-pickup:checked ~ .game-world .loot-S1-L4-P2 {
            bottom: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) - var(--panel-top) - var(--panel-height) / 2 - 18px);
            left: calc(var(--pos-width) * 6 - var(--panel-right) - var(--counter-panel-width) + var(--panel-padding) - 4px);
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }
        /* Move Stage 2 loot to counter when picked up (add stage-height for S2 vertical offset) */
        #loot-S2-L5-P8-pickup:checked ~ .game-world .loot-S2-L5-P8,
        #loot-S2-L6-P11-pickup:checked ~ .game-world .loot-S2-L6-P11,
        #loot-S2-L7-P7-pickup:checked ~ .game-world .loot-S2-L7-P7,
        #loot-S2-L8-P9-pickup:checked ~ .game-world .loot-S2-L8-P9,
        #loot-S2-L9-P10-pickup:checked ~ .game-world .loot-S2-L9-P10 {
            bottom: calc(var(--stage-height) + var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) - var(--panel-top) - var(--panel-height) / 2 - 18px);
            left: calc(var(--pos-width) * 12 - var(--panel-right) - var(--counter-panel-width) + var(--panel-padding) - 4px);
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }
        /* Move Stage 3 loot to counter when picked up (add stage-height for S3 vertical offset) */
        #loot-S3-L5-P15-pickup:checked ~ .game-world .loot-S3-L5-P15,
        #loot-S3-L5-P18-pickup:checked ~ .game-world .loot-S3-L5-P18,
        #loot-S3-L8-P18-pickup:checked ~ .game-world .loot-S3-L8-P18,
        #loot-S3-L9-P14-pickup:checked ~ .game-world .loot-S3-L9-P14 {
            bottom: calc(var(--stage-height) + var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) - var(--panel-top) - var(--panel-height) / 2 - 18px);
            left: calc(var(--pos-width) * 18 - var(--panel-right) - var(--counter-panel-width) + var(--panel-padding) - 4px);
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
        }
        /* Move Stage 4 loot to counter when picked up (S4 is at bottom, no stage-height offset) */
        /* z-index raised above darkness so flying animation is visible */
        #loot-S4-L3-P7-pickup:checked ~ .game-world .loot-S4-L3-P7,
        #loot-S4-L3-P8-pickup:checked ~ .game-world .loot-S4-L3-P8,
        #loot-S4-L3-P12-pickup:checked ~ .game-world .loot-S4-L3-P12,
        #loot-S4-L1-P10-pickup:checked ~ .game-world .loot-S4-L1-P10,
        #loot-S4-L0-P9-pickup:checked ~ .game-world .loot-S4-L0-P9 {
            bottom: calc(var(--ground-height) + var(--platform-height) * 5 + var(--top-margin) - var(--panel-top) - var(--panel-height) - var(--panel-top) - var(--panel-height) / 2 - 18px);
            left: calc(var(--pos-width) * 12 - var(--panel-right) - var(--counter-panel-width) + var(--panel-padding) - 4px);
            opacity: 0;
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s ease-in-out 0.4s;
            z-index: auto;
        }

        /* Skull */
        .skull {
            position: absolute;
            width: 32px;
            height: 32px;
            padding: 3px;
            --skull-bg-purple: #4a0050;
            color: purple;
            background: linear-gradient(to top, transparent 0%, var(--skull-bg-purple) 12.5%, transparent 25%, var(--skull-bg-purple) 37.5%, transparent 50%, var(--skull-bg-purple) 62.5%, transparent 75%, var(--skull-bg-purple) 87.5%, transparent 100%);
            background-size: 100% 200%;
            animation: hazard-roll 1s linear infinite;
            border-radius: 6px;
            z-index: var(--z-hazards);
        }
        .skull-S1-L1-P6 {
            bottom: calc(var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 5 - var(--item-offset));
        }
        .skull svg {
            width: 100%;
            height: 100%;
        }
        .skull-tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .skull:hover {
            z-index: var(--z-tooltip);
        }
        .skull:hover .tooltip {
            opacity: 1;
        }
        /* Stage 2 Bacteria */
        .disease {
            position: absolute;
            width: 32px;
            height: 32px;
            padding: 3px;
            --disease-bg-purple: #4a0050;
            color: purple;
            background: linear-gradient(to top, transparent 0%, var(--disease-bg-purple) 12.5%, transparent 25%, var(--disease-bg-purple) 37.5%, transparent 50%, var(--disease-bg-purple) 62.5%, transparent 75%, var(--disease-bg-purple) 87.5%, transparent 100%);
            background-size: 100% 200%;
            animation: hazard-roll 1s linear infinite;
            border-radius: 6px;
            z-index: var(--z-hazards);
        }
        .disease-S2-L5-P10 {
            bottom: calc(var(--stage-height) + var(--ground-height) + 2px);
            left: calc(var(--pos-offset) + var(--pos-width) * 9 - var(--item-offset));
        }
        .disease-S2-L6-P9 {
            bottom: calc(var(--stage-height) + var(--platform-height) + var(--platform-thickness));
            left: calc(var(--pos-offset) + var(--pos-width) * 8 - var(--item-offset));
        }
        .disease svg {
            width: 100%;
            height: 100%;
        }
        .disease-tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .disease:hover {
            z-index: var(--z-tooltip);
        }
        .disease:hover .tooltip {
            opacity: 1;
        }

        /* Sprout on stage 2, level 0, pos 6 */
        .tree-container {
            position: absolute;
            width: 92px;
            height: calc(var(--platform-height) - var(--ground-height) + 10px);
            bottom: calc(var(--stage-height) + var(--ground-height));
            left: calc(var(--pos-offset) + var(--pos-width) * 11 + var(--ladder-offset) - 5px - 26px);
            z-index: var(--z-scenery);
        }
        .tree {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .tree svg {
            width: 100%;
            height: 100%;
        }
        /* Tree pulsates when player is next to it, has axe, AND tree not yet chopped (S2 uses levels 5-9) */
        #level-5:checked ~ #pos-12:checked ~ #axe-pickup:checked ~ #tree-chopped:not(:checked) ~ .game-world .tree svg {
            animation: tree-pulse 1s ease-in-out infinite;
        }
        /* Enable clicking tree only when player is next to it, has axe (S2 uses levels 5-9) */
        #level-5:checked ~ #pos-12:checked ~ #axe-pickup:checked ~ #tree-chopped:not(:checked) ~ .game-world .tree {
            pointer-events: auto;
            cursor: pointer;
        }
        /* Hide tree container when chopped (axe used) */
        #tree-chopped:checked ~ .game-world .tree-container {
            display: none;
        }
        /* Hide axe when tree is chopped (axe used) */
        #tree-chopped:checked ~ .game-world .axe-in-game {
            display: none;
        }

        /* Tree tooltip */
        .tree-tooltip, .tree-tooltip-axe {
            bottom: 100%;
            left: 50%;
            transform: translateX(calc(-50% - 35px));
            margin-bottom: 8px;
        }
        .tree-hover-area {
            position: absolute;
            top: 0;
            left: 8px;
            width: calc(100% - 16px);
            height: 100%;
            pointer-events: auto;
            z-index: 1;
        }
        /* Hide hover area when player has axe and is at tree (so label click works) (S2 uses levels 5-9) */
        #level-5:checked ~ #pos-12:checked ~ #axe-pickup:checked ~ .game-world .tree-container .tree-hover-area {
            display: none;
        }
        /* Show "blocked" tooltip on hover (without axe, tree not chopped) */
        #axe-pickup:not(:checked) ~ #tree-chopped:not(:checked) ~ .game-world .tree-hover-area:hover ~ .tree-tooltip {
            opacity: 1;
        }
        /* Show "chop" tooltip on hover (with axe, tree not chopped) */
        #axe-pickup:checked ~ #tree-chopped:not(:checked) ~ .game-world .tree-container:hover .tree-tooltip-axe {
            opacity: 1;
        }

        /* Door */
        .door-container {
            position: absolute;
            width: 32px;
            height: 58px;
            z-index: var(--z-scenery);
        }
        .door-container.door-S1-L0-P6 {
            bottom: calc(var(--ground-height) + 2px);
            left: calc(var(--pos-width) * 6 - 42px);
        }
        .door {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .door svg {
            position: absolute;
            top: 0;
            left: 22px;
            width: 100%;
            height: 100%;
            color: #6a6a6a;
            filter: drop-shadow(1px 1px 0 #aaa) drop-shadow(-1px -1px 0 #444);
            transform: scaleX(1.65) scaleY(1.7);
        }
        /* Door closed - show by default, hide when opened */
        .door-closed {
            display: block;
        }
        #door-unlocked:checked ~ .game-world .door .door-closed {
            display: none;
        }
        /* Door open - hidden by default, show when opened */
        .door-open {
            display: none;
        }
        #door-unlocked:checked ~ .game-world .door .door-open {
            display: block;
        }
        /* Pulse glow when player has wrench and is at door location */
        #level-0:checked ~ #pos-6:checked ~ #wrench-pickup:checked ~ #door-unlocked:not(:checked) ~ .game-world .door {
            pointer-events: auto;
            cursor: pointer;
        }
        #level-0:checked ~ #pos-6:checked ~ #wrench-pickup:checked ~ #door-unlocked:not(:checked) ~ .game-world .door .door-closed {
            animation: door-pulse 1s ease-in-out infinite;
        }

        .wrench-at-door {
            display: none;
            position: absolute;
            bottom: calc(var(--ground-height) + 13px);
            left: calc(var(--pos-width) * 6 - 35px);
            width: 24px;
            height: 24px;
            z-index: var(--z-floating-item);
            transform-origin: calc(100% - 6px) 8px;
        }
        .wrench-at-door svg {
            width: 100%;
            height: 100%;
            color: var(--wrench-color);
            filter: drop-shadow(2px 2px 2px #00000080);
        }
        #level-0:checked ~ #pos-6:checked ~ #wrench-pickup:checked ~ #door-unlocked:not(:checked) ~ .game-world .wrench-at-door {
            display: block;
            animation: wrench-rotate 1s ease-in-out infinite;
            cursor: pointer;
        }

        /* On S4, we achieve a small FOV using four rectangles arranged
         * around a central hole that follows the player position.
         * The hole allows clicking through.
         */

        /* Single darkness using radial-gradient for the hole */
        .darkness-S4 {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: var(--z-darkness);
            pointer-events: none;
            /* Radial gradient: transparent in center, black outside */
            background: radial-gradient(
                ellipse var(--darkness-hole-width) var(--darkness-hole-height) at var(--darkness-x) var(--darkness-y),
                transparent 0%,
                transparent 50%,
                #00000080 70%,
                #000 100%
            );
            transition: --darkness-x 0.5s ease, --darkness-y 0.5s ease, --darkness-hole-width 0.5s ease, --darkness-hole-height 0.5s ease;
            /* Default: huge hole (no darkness visible) */
            --darkness-hole-width: 2000px;
            --darkness-hole-height: 2000px;
            --darkness-x: 50%;
            --darkness-y: 50%;
        }

        /* Register custom properties for animation */
        @property --darkness-x {
            syntax: '<length-percentage>';
            inherits: true;
            initial-value: 50%;
        }
        @property --darkness-y {
            syntax: '<length-percentage>';
            inherits: true;
            initial-value: 50%;
        }
        @property --darkness-hole-width {
            syntax: '<length>';
            inherits: true;
            initial-value: 2000px;
        }
        @property --darkness-hole-height {
            syntax: '<length>';
            inherits: true;
            initial-value: 2000px;
        }

        /* In Stage 4: shrink hole to normal size */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~
        :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~
        .darkness-S4 {
            --darkness-hole-width: 180px;
            --darkness-hole-height: 120px;
        }

        /* Horizontal position rules */
        #pos-7:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 0 + var(--darkness-hole-offset)); }
        #pos-8:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 1 + var(--darkness-hole-offset)); }
        #pos-9:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 2 + var(--darkness-hole-offset)); }
        #pos-10:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 3 + var(--darkness-hole-offset)); }
        #pos-11:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 4 + var(--darkness-hole-offset)); }
        #pos-12:checked ~ .darkness-S4 { --darkness-x: calc(var(--pos-offset) + var(--pos-width) * 5 + var(--darkness-hole-offset)); }

        /* Vertical position rules */
        #level-0:checked ~ .darkness-S4 { --darkness-y: calc(100% - var(--ground-height) - 26px); }
        #level-1:checked ~ .darkness-S4 { --darkness-y: calc(100% - var(--platform-height) - var(--platform-thickness) + 2px - 28px); }
        #level-2:checked ~ .darkness-S4 { --darkness-y: calc(100% - var(--platform-height) * 2 - var(--platform-thickness) + 2px - 28px); }
        #level-3:checked ~ .darkness-S4 { --darkness-y: calc(100% - var(--platform-height) * 3 - var(--platform-thickness) + 2px - 28px); }
        #level-4:checked ~ .darkness-S4 { --darkness-y: calc(100% - var(--platform-height) * 4 - var(--platform-thickness) + 2px - 28px); }

        /* With torch: illuminate darkness (3 levels x 3 positions) */
        :is(#level-0, #level-1, #level-2, #level-3, #level-4):checked ~
        :is(#pos-7, #pos-8, #pos-9, #pos-10, #pos-11, #pos-12):checked ~
        #torch-pickup:checked ~ .darkness-S4 {
            --darkness-hole-width: calc(var(--pos-width) * 2.2);
            --darkness-hole-height: calc(var(--platform-height) * 2.2);
        }

        /* Toggle darkness */
        #darkness-toggle:checked ~ .darkness-S4 {
            display: none;
        }

        /* Overlay base styles */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000000d9;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-out;
        }
        .overlay .message {
            font-size: 28px;
            font-weight: bold;
            text-shadow: 2px 2px 4px #000;
            text-align: center;
        }
        .overlay .submessage {
            color: #888;
            font-size: 18px;
            margin-top: 10px;
        }

        /* Title screen overlay */
        .title-screen-overlay {
            z-index: var(--z-title-overlay);
            background: #000000e6;
            opacity: 1;
            pointer-events: auto;
            cursor: pointer;
        }
        .title-screen-overlay h1 {
            color: #48d8d8;
            font-size: 36px;
            letter-spacing: 3px;
        }
        .title-screen-overlay .story {
            color: #aaa;
            font-size: 16px;
            text-align: center;
            line-height: 1.7;
            margin-top: 25px;
        }
        .title-screen-overlay .submessage {
            font-size: 16px;
            margin-top: 30px;
        }
        .title-screen-overlay .copyright {
            position: absolute;
            bottom: 34px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            color: #666;
            text-shadow: 2px 2px 4px black, 0 0 8px black;
            background: #00000080;
            padding: 6px 12px;
            border-radius: 4px;
            box-shadow: 0 0 10px #000000cc;
        }
        .title-screen-overlay .copyright a {
            color: #888;
            text-decoration: none;
        }
        .title-screen-overlay .copyright a:hover {
            filter: brightness(1.3);
        }
        /* Hide title screen when checkbox is checked */
        #title-screen-toggle:checked ~ .game-container .title-screen-overlay {
            opacity: 0;
            pointer-events: none;
        }
        /* When title screen is showing, position player for title display */
        #title-screen-toggle:not(:checked) ~ .game-container .game-world .player {
            left: calc(var(--pos-offset) + var(--pos-width) * 2.5);
            bottom: calc(var(--stage-height) * 0.65 + 20px);
            transform: translateX(-50%);
        }

        /* Death overlay */
        .death-screen-overlay {
            z-index: var(--z-endgame-overlay);
        }
        .death-screen-overlay .message {
            color: #ff0000;
        }
        /* Show death overlay when player is at hazard locations */
        #level-1:checked ~ #pos-6:checked ~ .death-screen-overlay-poison,
        /* S2 disease use levels 5-9 (L0->L5, L1->L6) */
        #level-5:checked ~ #pos-10:checked ~ .death-screen-overlay-disease,
        #level-6:checked ~ #pos-9:checked ~ .death-screen-overlay-disease {
            opacity: 1;
            pointer-events: auto;
        }

        /* Escape overlay */
        .escape-screen-overlay.overlay {
            z-index: var(--z-endgame-overlay);
            justify-content: space-evenly;
            padding-bottom: 30px;
        }
        .escape-screen-overlay .message {
            color: #4ade80;
        }
        .escape-screen-overlay.overlay .submessage {
            margin-top: 0;
        }
        .escape-screen-overlay .video-box {
            width: 600px;
            height: 400px;
            border: 3px solid #4ade80;
            border-radius: 8px;
            overflow: hidden;
        }
        .escape-screen-overlay .video-box video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* Show escape overlay when escaped checkbox is checked */
        #escaped:checked ~ .escape-screen-overlay {
            opacity: 1;
            pointer-events: auto;
        }

        /* Tooltip styling */
        .tooltip {
            position: absolute;
            background: #1a1a2e;
            border: 3px solid var(--border-color);
            border-radius: 4px;
            padding: 8px 12px;
            color: #ccc;
            font-size: 12px;
            white-space: nowrap;
            text-align: center;
            z-index: var(--z-tooltip);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        .door-tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(calc(-50% - 68px));
            margin-bottom: 8px;
        }

        /* Transparent hover area for door tooltip (doesn't trigger label click) */
        .door-hover-area {
            position: absolute;
            top: -4px;
            left: 10px;
            width: calc(100% - 6px);
            height: calc(100% + 4px + 2px);
            pointer-events: auto;
            z-index: 1;
        }

        /* Hide hover area when player has wrench and is at door (so label click works) */
        #level-0:checked ~ #pos-6:checked ~ #wrench-pickup:checked ~ .game-world .door-container .door-hover-area {
            display: none;
        }

        /* Second tooltip for when player has wrench */
        .door-tooltip-wrench {
            bottom: 100%;
            left: 50%;
            transform: translateX(calc(-50% - 60px));
            margin-bottom: 8px;
        }

        /* Show "broken door" tooltip on hover (without wrench, door not unlocked) */
        #wrench-pickup:not(:checked) ~ #door-unlocked:not(:checked) ~ .game-world .door-hover-area:hover ~ .door-tooltip {
            opacity: 1;
        }

        /* Show "repair door" tooltip on hover (with wrench, door not unlocked) */
        #wrench-pickup:checked ~ #door-unlocked:not(:checked) ~ .game-world .door-container:hover .door-tooltip-wrench {
            opacity: 1;
        }

        /* Utility classes */

        /* loot container */
        .container {
            position: absolute;
            width: var(--pickup-size);
            height: var(--pickup-size);
            z-index: var(--z-loot);
            transition: bottom 0.5s ease-in-out, left 0.5s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container .loot-in-game {
            width: 24px;
            height: 24px;
        }
        .container .tooltip {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }
        .loot-hover-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: auto;
            z-index: var(--z-loot-hover);
        }
        /* Hide hover area when player is at loot location (so pickup works) */
        #level-0:checked ~ #pos-3:checked ~ .game-world .loot-S1-L0-P3 .loot-hover-area,
        #level-1:checked ~ #pos-4:checked ~ .game-world .loot-S1-L1-P4 .loot-hover-area,
        #level-3:checked ~ #pos-5:checked ~ .game-world .loot-S1-L3-P5 .loot-hover-area,
        #level-2:checked ~ #pos-1:checked ~ .game-world .loot-S1-L2-P1 .loot-hover-area,
        #level-4:checked ~ #pos-2:checked ~ .game-world .loot-S1-L4-P2 .loot-hover-area,
        /* S2 uses levels 5-9 */
        #level-5:checked ~ #pos-8:checked ~ .game-world .loot-S2-L5-P8 .loot-hover-area,
        #level-6:checked ~ #pos-11:checked ~ .game-world .loot-S2-L6-P11 .loot-hover-area,
        #level-7:checked ~ #pos-7:checked ~ .game-world .loot-S2-L7-P7 .loot-hover-area,
        #level-8:checked ~ #pos-9:checked ~ .game-world .loot-S2-L8-P9 .loot-hover-area,
        #level-9:checked ~ #pos-10:checked ~ .game-world .loot-S2-L9-P10 .loot-hover-area,
        /* S4 uses levels 0-4 */
        #level-3:checked ~ #pos-8:checked ~ .game-world .loot-S4-L3-P8 .loot-hover-area,
        #level-1:checked ~ #pos-10:checked ~ .game-world .loot-S4-L1-P10 .loot-hover-area {
            display: none;
        }
        /* Show tooltip on hover */
        #loot-S1-L0-P3-pickup:not(:checked) ~ .game-world .loot-S1-L0-P3 .loot-hover-area:hover ~ .tooltip,
        #loot-S1-L1-P4-pickup:not(:checked) ~ .game-world .loot-S1-L1-P4 .loot-hover-area:hover ~ .tooltip,
        #loot-S1-L3-P5-pickup:not(:checked) ~ .game-world .loot-S1-L3-P5 .loot-hover-area:hover ~ .tooltip,
        #loot-S1-L2-P1-pickup:not(:checked) ~ .game-world .loot-S1-L2-P1 .loot-hover-area:hover ~ .tooltip,
        #loot-S1-L4-P2-pickup:not(:checked) ~ .game-world .loot-S1-L4-P2 .loot-hover-area:hover ~ .tooltip,
        #loot-S2-L5-P8-pickup:not(:checked) ~ .game-world .loot-S2-L5-P8 .loot-hover-area:hover ~ .tooltip,
        #loot-S2-L6-P11-pickup:not(:checked) ~ .game-world .loot-S2-L6-P11 .loot-hover-area:hover ~ .tooltip,
        #loot-S2-L7-P7-pickup:not(:checked) ~ .game-world .loot-S2-L7-P7 .loot-hover-area:hover ~ .tooltip,
        #loot-S2-L8-P9-pickup:not(:checked) ~ .game-world .loot-S2-L8-P9 .loot-hover-area:hover ~ .tooltip,
        #loot-S2-L9-P10-pickup:not(:checked) ~ .game-world .loot-S2-L9-P10 .loot-hover-area:hover ~ .tooltip,
        #loot-S3-L5-P15-pickup:not(:checked) ~ .game-world .loot-S3-L5-P15 .loot-hover-area:hover ~ .tooltip,
        #loot-S3-L5-P18-pickup:not(:checked) ~ .game-world .loot-S3-L5-P18 .loot-hover-area:hover ~ .tooltip,
        #loot-S3-L8-P18-pickup:not(:checked) ~ .game-world .loot-S3-L8-P18 .loot-hover-area:hover ~ .tooltip,
        #loot-S3-L9-P14-pickup:not(:checked) ~ .game-world .loot-S3-L9-P14 .loot-hover-area:hover ~ .tooltip,
        #loot-S4-L3-P8-pickup:not(:checked) ~ .game-world .loot-S4-L3-P8 .loot-hover-area:hover ~ .tooltip,
        #loot-S4-L1-P10-pickup:not(:checked) ~ .game-world .loot-S4-L1-P10 .loot-hover-area:hover ~ .tooltip,
        /* Show tooltip when player is at loot location (hover-area hidden, so use container:hover) */
        /* S2/S3 use levels 5-9 */
        #level-6:checked ~ #pos-11:checked ~ #loot-S2-L6-P11-pickup:not(:checked) ~ .game-world .loot-S2-L6-P11:hover .tooltip,
        #level-8:checked ~ #pos-9:checked ~ #loot-S2-L8-P9-pickup:not(:checked) ~ .game-world .loot-S2-L8-P9:hover .tooltip,
        #level-5:checked ~ #pos-18:checked ~ #loot-S3-L5-P18-pickup:not(:checked) ~ .game-world .loot-S3-L5-P18:hover .tooltip,
        /* S4 uses levels 0-4 */
        #level-3:checked ~ #pos-8:checked ~ #loot-S4-L3-P8-pickup:not(:checked) ~ .game-world .loot-S4-L3-P8:hover .tooltip,
        #level-1:checked ~ #pos-10:checked ~ #loot-S4-L1-P10-pickup:not(:checked) ~ .game-world .loot-S4-L1-P10:hover .tooltip {
            opacity: 1;
        }
    </style>
<link rel="preload" as="video" href="intro.mp4" type="video/mp4">
</head>
<body>
    <!-- Rotate device prompt for mobile portrait -->
    <div class="rotate-prompt">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16.48 2.52c3.27 1.55 5.61 4.72 5.97 8.48h1.5C23.44 4.84 18.29 0 12 0l-.66.03 3.81 3.81 1.33-1.32zm-6.25-.77c-.59-.59-1.54-.59-2.12 0L1.75 8.11c-.59.59-.59 1.54 0 2.12l12.02 12.02c.59.59 1.54.59 2.12 0l6.36-6.36c.59-.59.59-1.54 0-2.12L10.23 1.75zm4.6 19.44L2.81 9.17l6.36-6.36 12.02 12.02-6.36 6.36zm-7.31.29C3.52 19.93 1.55 16.76 1.05 13H-.45c.51 6.16 5.66 11 11.95 11l.66-.03-3.81-3.81-1.33 1.32z"/>
        </svg>
        <p>Please rotate your device to landscape mode</p>
    </div>

    <!-- SVG symbols for reuse -->
    <!-- Icons inspired by Font Awesome (https://fontawesome.com) and Material Design (https://materialdesignicons.com) -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="torch" viewBox="40 40 160 160">
            <g transform="rotate(45 120 120)">
                <path fill="orange" d="M 86 96 C 90 102 95 107 102 110 H 142 C 145 109 147 107 149 105 C 159 95 163 80 158 67 L 157 65 C 156 62 154 60 152 58 C 151 56 149 55 148 53 C 144 50 140 47 136 43 C 127 34 126 20 131 10 C 126 11 121 14 117 18 C 102 30 96 51 103 70 V 72 C 103 73 102 74 101 75 C 100 76 98 75 97 74 L 96 73 C 90 65 89 53 93 43 C 84 51 79 64 80 77 C 80 80 81 83 82 86 C 82 89 84 93 86 96"/>
                <path fill="red" d="M 123 81 C 124 76 122 72 121 68 C 120 64 120 60 122 56 L 125 62 C 129 68 136 70 138 78 V 81 C 138 86 136 91 133 94 C 131 95 129 97 127 97 C 121 99 114 96 110 92 C 118 92 122 86 123 81"/>
                <path fill="#aa6418" d="M 150 120 V 140 H 140 L 130 220 H 110 L 100 140 H 90 V 120 H 150 Z"/>
            </g>
        </symbol>
        <symbol id="coin" viewBox="96 32 384 384">
            <path fill="currentColor" d="M 288 32 a 192 192 0 1 1 0 384 a 192 192 0 1 1 0 -384 z M 364.5 147.5 A 108 108 0 0 0 181.8 202.4 L 165.98 202.4 A 9 9 0 0 0 157.43 208.56 L 152.34 222.96 A 9 9 0 0 0 161.18 234.8 L 181.1 234.8 A 108 108 0 0 0 364.5 300.5 A 18 18 0 0 0 336.7 275.3 A 72 72 0 0 1 216.9 234.8 L 286.21 234.8 A 9 9 0 0 0 294.57 228.64 L 299.34 214.24 A 9 9 0 0 0 290.82 202.4 L 219.6 202.4 A 72 72 0 0 1 339.3 172.7 A 18 18 0 0 0 364.5 147.5 Z"/>
        </symbol>
        <symbol id="skull" viewBox="0 0 448 545">
            <path fill="currentColor" d="M 384 144 C 384 64.5 312.4 0 224 0 S 64 64.5 64 144 c 0 47.1 25.1 88.9 64 115.2 l 0 28.8 c 0 17.7 14.3 32 32 32 l 128 0 c 17.7 0 32 -14.3 32 -32 l 0 -28.8 c 38.9 -26.3 64 -68.1 64 -115.2 z M 160 128 a 32 32 0 1 1 0 64 32 32 0 1 1 0 -64 z m 96 32 a 32 32 0 1 1 64 0 32 32 0 1 1 -64 0 z M 445.5 339.7 c -6.8 -16.3 -25.5 -24 -41.8 -17.2 L 224 397.3 44.3 322.5 c -16.3 -6.8 -35 .9 -41.8 17.2 s .9 35 17.2 41.8 L 140.8 432 19.7 482.5 C 3.4 489.3 -4.3 508 2.5 524.3 s 25.5 24 41.8 17.2 L 224 466.7 403.7 541.5 c 16.3 6.8 35 -.9 41.8 -17.2 s -.9 -35 -17.2 -41.8 L 307.2 432 428.3 381.5 c 16.3 -6.8 24 -25.5 17.2 -41.8 z"/>
        </symbol>
        <symbol id="key" viewBox="0 0 512 512">
            <path fill="currentColor" d="M 336 352 c 97.2 0 176 -78.8 176 -176 S 433.2 0 336 0 160 78.8 160 176 c 0 18.7 2.9 36.8 8.3 53.7 L 7 391 c -4.5 4.5 -7 10.6 -7 17 l 0 80 c 0 13.3 10.7 24 24 24 l 80 0 c 13.3 0 24 -10.7 24 -24 l 0 -40 40 0 c 13.3 0 24 -10.7 24 -24 l 0 -40 40 0 c 6.4 0 12.5 -2.5 17 -7 l 33.3 -33.3 c 16.9 5.4 35 8.3 53.7 8.3 z M 376 96 a 40 40 0 1 1 0 80 40 40 0 1 1 0 -80 z"/>
        </symbol>
        <symbol id="toolbox" viewBox="0 0 24 24">
            <path fill="currentColor" d="M 18 16 H 16 V 15 H 8 V 16 H 6 V 15 H 2 V 20 H 22 V 15 H 18 V 16 M 20 8 H 17 V 6 C 17 4.9 16.1 4 15 4 H 9 C 7.9 4 7 4.9 7 6 V 8 H 4 C 2.9 8 2 8.9 2 10 V 14 H 6 V 12 H 8 V 14 H 16 V 12 H 18 V 14 H 22 V 10 C 22 8.9 21.1 8 20 8 M 15 8 H 9 V 6 H 15 V 8 Z"/>
        </symbol>
        <symbol id="wrench" viewBox="0 0 576 512">
            <path fill="currentColor" d="M 509.4 98.6 c 7.6 -7.6 20.3 -5.7 24.1 4.3 6.8 17.7 10.5 37 10.5 57.1 0 88.4 -71.6 160 -160 160 -17.5 0 -34.4 -2.8 -50.2 -8 L 146.9 498.9 c -28.1 28.1 -73.7 28.1 -101.8 0 s -28.1 -73.7 0 -101.8 L 232 210.2 c -5.2 -15.8 -8 -32.6 -8 -50.2 0 -88.4 71.6 -160 160 -160 20.1 0 39.4 3.7 57.1 10.5 10 3.8 11.8 16.5 4.3 24.1 l -88.7 88.7 c -3 3 -4.7 7.1 -4.7 11.3 l 0 41.4 c 0 8.8 7.2 16 16 16 l 41.4 0 c 4.2 0 8.3 -1.7 11.3 -4.7 l 88.7 -88.7 z"/>
        </symbol>
        <symbol id="door-closed" viewBox="0 0 448 512">
            <path fill="currentColor" d="M 32 64 C 32 28.7 60.7 0 96 0 L 352 0 c 35.3 0 64 28.7 64 64 l 0 384 c 17.7 0 32 14.3 32 32 s -14.3 32 -32 32 L 32 512 c -17.7 0 -32 -14.3 -32 -32 s 14.3 -32 32 -32 L 32 64 z M 104 288 a 32 32 0 1 0 0 -64 32 32 0 1 0 0 64 z"/>
        </symbol>
        <symbol id="door-open" viewBox="0 0 448 512">
            <path fill="currentColor" d="M 288 64 l 64 0 0 416 c 0 17.7 14.3 32 32 32 l 32 0 c 17.7 0 32 -14.3 32 -32 s -14.3 -32 -32 -32 l 0 -384 c 0 -35.3 -28.7 -64 -64 -64 l -96 0 0 0 -160 0 C 60.7 0 32 28.7 32 64 l 0 384 c -17.7 0 -32 14.3 -32 32 s 14.3 32 32 32 l 32 0 c 17.7 0 32 -14.3 32 -32 l 0 -416 z"/>
        </symbol>
        <symbol id="disease" viewBox="0 0 512 512">
            <path fill="currentColor" d="M 236.5 29.4 L 224 48 c -20 30 -53.6 48 -89.7 48 L 68 96 c -37.5 0 -67.9 30.4 -67.9 67.9 0 18 7.2 35.2 19.9 47.9 l 27 27 c 11 11 17.2 25.9 17.2 41.5 0 15.8 -6.4 30.9 -17.7 42 L 33.4 335.1 c -11.1 10.8 -17.3 25.7 -17.3 41.2 0 36.8 34.1 64.2 70.1 56.2 l 62.3 -13.8 c 7.7 -1.7 15.7 -2.6 23.6 -2.6 32.8 0 64.2 14.6 85.2 39.8 l 30.5 36.6 c 10.4 12.4 25.7 19.6 41.9 19.6 30.1 0 54.5 -24.4 54.5 -54.5 l 0 -51.2 c 0 -41.4 25.4 -78.5 64 -93.5 l 22.2 -8.6 c 25.2 -9.8 41.8 -34.1 41.8 -61.1 0 -26.4 -15.9 -50.3 -40.3 -60.5 L 429 164.8 c -33.2 -13.9 -57.6 -43 -65.5 -78.1 l -7.9 -35.2 c -6.8 -30.1 -33.5 -51.5 -64.3 -51.5 -22 0 -42.6 11 -54.8 29.4 z M 160 192 a 32 32 0 1 1 0 64 32 32 0 1 1 0 -64 z m 96 0 a 32 32 0 1 1 64 0 32 32 0 1 1 -64 0 z m 32 96 a 32 32 0 1 1 0 64 32 32 0 1 1 0 -64 z"/>
        </symbol>
        <symbol id="axe" viewBox="21 20 199 179">
            <path fill="#cc1010" d="M 120,20 L 220,80 C 220,120 200,140 160,150 L 130,100 L 90,60 L 120,20 z"/>
            <path fill="#c4a484" d="M 41,198 L 21,183 L 92,90 L 110,108 L 41,198 Z"/>
        </symbol>
        <symbol id="battery" viewBox="0 0 512 512">
            <path fill="currentColor" d="M 80 64 c 0 -17.7 14.3 -32 32 -32 l 64 0 c 17.7 0 32 14.3 32 32 l 96 0 c 0 -17.7 14.3 -32 32 -32 l 64 0 c 17.7 0 32 14.3 32 32 l 16 0 c 35.3 0 64 28.7 64 64 l 0 256 c 0 35.3 -28.7 64 -64 64 L 64 448 c -35.3 0 -64 -28.7 -64 -64 L 0 128 C 0 92.7 28.7 64 64 64 l 16 0 z M 392 184 c 0 -13.3 -10.7 -24 -24 -24 s -24 10.7 -24 24 l 0 32 -32 0 c -13.3 0 -24 10.7 -24 24 s 10.7 24 24 24 l 32 0 0 32 c 0 13.3 10.7 24 24 24 s 24 -10.7 24 -24 l 0 -32 32 0 c 13.3 0 24 -10.7 24 -24 s -10.7 -24 -24 -24 l -32 0 0 -32 z M 64 240 c 0 13.3 10.7 24 24 24 l 112 0 c 13.3 0 24 -10.7 24 -24 s -10.7 -24 -24 -24 L 88 216 c -13.3 0 -24 10.7 -24 24 z"/>
        </symbol>
        <symbol id="radiation" viewBox="0 0 576 512">
            <path fill="currentColor" d="M446.2 34.5c-14.2-10.1-33.5-4.6-42.2 10.5L331.6 170.3c31.3 15.8 52.8 48.3 52.8 85.7l144 0c17.7 0 32.2-14.4 30.1-31.9-9.1-78.1-51.4-146.1-112.3-189.6zM172.7 44.9C164 29.8 144.7 24.3 130.5 34.5 69.6 77.9 27.3 145.9 18.2 224.1 16.1 241.6 30.7 256 48.3 256l144 0c0-37.5 21.5-69.9 52.8-85.7L172.7 44.9zm-9.4 416.8c-8.7 15.1-3.8 34.5 12 41.8 34.4 15.7 72.7 24.5 113 24.5s78.6-8.8 113-24.5c15.8-7.2 20.7-26.7 12-41.8L341 336.3c-15.1 9.9-33.2 15.7-52.6 15.7s-37.5-5.8-52.6-15.7L163.3 461.7zM288.3 304a48 48 0 1 0 -.7-96 48 48 0 1 0 .7 96z"/>
        </symbol>
        <symbol id="id-card" viewBox="0 0 576 512">
            <rect x="0" y="32" width="576" height="448" rx="64" ry="64" fill="currentColor"/>
            <rect x="0" y="96" width="576" height="48" fill="#444"/>
            <path fill="#444" d="M 247.3 416 c 20.2 0 35.3 -19.4 22.4 -35 -14.7 -17.7 -36.9 -29 -61.7 -29 l -64 0 c -24.8 0 -47 11.3 -61.7 29 -12.9 15.6 2.2 35 22.4 35 l 142.5 0 z M 176 312 a 56 56 0 1 0 0 -112 56 56 0 1 0 0 112 z M 360 208 c -13.3 0 -24 10.7 -24 24 s 10.7 24 24 24 l 112 0 c 13.3 0 24 -10.7 24 -24 s -10.7 -24 -24 -24 l -112 0 z M 360 304 c -13.3 0 -24 10.7 -24 24 s 10.7 24 24 24 l 112 0 c 13.3 0 24 -10.7 24 -24 s -10.7 -24 -24 -24 l -112 0 z"/>
        </symbol>
        <symbol id="barrel" viewBox="0 0 24 24">
            <path fill="currentColor" d="M 20 13 C 20.55 13 21 12.55 21 12 S 20.55 11 20 11 H 19 V 5 H 20 C 20.55 5 21 4.55 21 4 S 20.55 3 20 3 H 4 C 3.45 3 3 3.45 3 4 S 3.45 5 4 5 H 5 V 11 H 4 C 3.45 11 3 11.45 3 12 S 3.45 13 4 13 H 5 V 19 H 4 C 3.45 19 3 19.45 3 20 S 3.45 21 4 21 H 20 C 20.55 21 21 20.55 21 20 S 20.55 19 20 19 H 19 V 13 H 20 M 5 11 h 14 v 2 h -14 Z"/>
        </symbol>
        <symbol id="flight-controls" viewBox="0 0 24 24">
            <rect x="1" y="2" width="22" height="16" rx="2" ry="2" fill="#444"/>
            <path fill="currentColor" d="M 21,16 V 4 H 3 V 16 H 21 M 21,2 A 2,2 0 0,1 23,4 V 16 A 2,2 0 0,1 21,18 H 14 V 20 H 16 V 22 H 8 V 20 H 10 V 18 H 3 C 1.89,18 1,17.1 1,16 V 4 C 1,2.89 1.89,2 3,2 H 21 M 5,6 H 14 V 11 H 5 V 6 M 15,6 H 19 V 8 H 15 V 6 M 19,9 V 14 H 15 V 9 H 19 M 5,12 H 9 V 14 H 5 V 12 M 10,12 H 14 V 14 H 10 V 12 Z"/>
        </symbol>
        <symbol id="spacecraft" viewBox="0 252 1540 438">
            <path fill="#393d3a" d="M1294 252 L1295 254 L1289 265 L1285 273 L1283 277 L1268 306 L1251 338 L1262 333 L1273 327 L1276 326 L1282 323 L1300 313 L1330 298 L1336 295 L1344 291 L1349 288q12 -4 23 -5h15l53 -1l-8 10l-10 11l-15 15l-20 21l-10 11l-15 15l-10 11l-7 7l2 3l1 6h3l32 3q14 2 27 6l7 2l8 3l8 6l8 1l17 3q6 1 9 7c6 15 5 36 0 51q-2 5 -8 7l-5 1l-11 3h-5c-6 1 -7 2 -12 6l-10 3v9l3 1l3 1l4 1l6 4q3 4 9 3c9 0 21 1 28 7c9 16 6 40 2 56q-7 8 -18 8l-4 1l-1 1h-5l-11 4c-14 10 -31 10 -47 10h-12c-9 0 -9 0 -12 -3h-44v5q0 6 -4 10q-11 6 -25 7c-13 1 -13 1 -25 6q-11 4 -23 3h-5c-12 0 -12 0 -17 -2l-26 4l-7 1v12h-49l-21 4 L293 648 l-5 1l-9 -6c-5 -3 -5 -3 -11 -4l-1 2q-8 1 -16 -2l-1 -6h-4l-25 -5l-10 -2l-6 -1l-6 -1l-7 -3v-2l-5 -2l-6 -4l-3 -3q-2 -1 -2 -6h-3q-6 -4 -7 -11q-4 -11 -16 -14l-12 -3l-6 -2l-13 -3l-29 -8l-9 -3l-6 -1l-4 -2q-4 0 -7 -5q-7 -18 -11 -37l-1 -4l-1 -4l-1 -3l1 -9q5 -5 12 -8l4 -2l4 -2l5 -1l14 -6l4 -2l4 -1q36 -15 69 -31c76 -36 157 -64 241 -71q18 -1 32 -10q17 -10 36 -10v-2h5l23 -1q30 -3 61 -3h24c20 0 20 0 29 4q15 6 31 7l12 1l5 1l11 1h4q13 3 25 9l14 2h50l54 1h17l63 1h10c20 1 20 1 38 -7l6 -6q7 -4 13 -5l4 -1a460 460 0 0 1 106 1q11 -2 17 -12l8 -6l4 -3l34 -24l13 -9l17 -13l26 -18l5 -3l4 -3c22 -15 60 -12 85 -11"/>
            <path fill="#304044" d="M1294 252 L1295 254 L1289 265 L1285 273 L1283 277 L1268 306 L1251 338 L1262 333 L1273 327 L1276 326 L1282 323 L1300 313 L1330 298 L1336 295 L1344 291 L1349 288q12 -4 23 -5h15l53 -1l-8 10l-10 11l-15 15l-20 21l-10 11l-15 15l-10 11l-7 7l2 3l1 6h3l32 3q14 2 27 6l7 2l8 3l8 6l8 1l17 3q6 1 9 7c6 15 5 36 0 51q-2 5 -8 7l-5 1l-11 3h-5c-6 1 -7 2 -12 6l-10 3v9l3 1l3 1l4 1l6 4q3 4 9 3c9 0 21 1 28 7c9 16 6 40 2 56q-7 8 -18 8l-4 1l-1 1h-5l-11 4c-14 10 -31 10 -47 10h-12c-9 0 -9 0 -12 -3h-44v5q0 6 -4 10q-11 6 -25 7c-13 1 -13 1 -25 6q-11 4 -23 3h-5c-12 0 -12 0 -17 -2l-26 4l-7 1v12h-49l-21 4c-21 7 -44 6 -66 6l2 3l1 5l8 -1v8h3l59 -1h36l25 1v1l44 1v-2l4 1h32l35 -1l45 -1v1l-6 1h25l8 -1h16l18 1v1h-12l-3 1l-11 1h-13l-6 1h-18l18 1v2l33 2h20l62 2v1l-46 1l52 8q-8 3 -16 2h-76l-84 1l-26 1 L288 671 l1 -3l16 -1h8q-3 -5 -9 -7q-7 -4 -11 -12l-5 1l-9 -6c-5 -3 -5 -3 -11 -4l-1 2q-8 1 -16 -2l-1 -6h-4l-25 -5l-10 -2l-6 -1l-6 -1l-7 -3v-2l-5 -2l-6 -4l-3 -3q-2 -1 -2 -6h-3q-6 -4 -7 -11q-4 -11 -16 -14l-12 -3l-6 -2l-13 -3l-29 -8l-9 -3l-6 -1l-4 -2q-4 0 -7 -5q-7 -18 -11 -37l-1 -4l-1 -4l-1 -3l1 -9q5 -5 12 -8l4 -2l4 -2l5 -1l14 -6l4 -2l4 -1q36 -15 69 -31c76 -36 157 -64 241 -71q18 -1 32 -10q17 -10 36 -10v-2h5l23 -1q30 -3 61 -3h24c20 0 20 0 29 4q15 6 31 7l12 1l5 1l11 1h4q13 3 25 9l14 2h50l54 1h17l63 1h10c20 1 20 1 38 -7l6 -6q7 -4 13 -5l4 -1a460 460 0 0 1 106 1q11 -2 17 -12l8 -6l4 -3l34 -24l13 -9l17 -13l26 -18l5 -3l4 -3c22 -15 60 -12 85 -11"/>
            <path fill="#393d3a" d="M372 392h1v5h4q60 -7 122 -5h117l169 1h4l44 1h141q19 0 36 10q7 3 16 2h12l11 1h11q8 0 15 -3q10 -5 22 -4h133l60 1l4 1c7 0 7 0 9 2l14 1h4l2 6l1 3q3 15 2 30v15h-22l-2 10h5l12 -1l2 2h-29l-18 -1v44h14v8H729l-442 -1l9 -4l4 -2h3v-2l410 -1c-6 -17 -6 -17 -15 -19l-11 1h-5l-1 -5l-17 -1l1 -3h3v-2l-5 1l-1 -3l1 9l18 1v4l-12 1h-58l-4 -1v-24h-6v18l-2 1l-3 -1h-15l-1 -46v16l-1 1l-1 8h-1l-1 43l-16 1v-41h-2v41h-15l1 -26v-4l-1 -1v-10h-9v9h6v1l-5 1l-1 4h-12l-6 -1v16h-20q-2 -8 -2 -17l18 -1l-4 -1v-10l-16 -1v10h-21v-9l-1 -3l5 -1v-3l-1 -15v-5l1 -31h4l-1 -5l-38 -1l-1 6l-2 3l-10 1h-9l-1 3l-3 12l-2 5l-1 4l-1 4l-2 5l-1 9l9 -1v-5q1 -7 4 -12l9 -1h8q5 7 3 16h2l16 -1v1l-18 1l1 4q1 4 -2 7l-4 -1l3 -2v-3h-3l-1 4l-2 3h-60l6 -5l-9 1v2l2 1h-5l1 -5q7 -3 15 -2v-3l1 -5v-4q1 -6 6 -9h14l1 -5l5 -19h-17l1 -2h9l5 -1l8 -2l1 -5l-42 1v5h-25l4 -11l17 -3z"/>
            <path fill="#4e9aa2" d="M1212 268h73q-9 21 -21 41l-2 5l-6 12h-2l-1 5q-3 10 -13 14l-3 2q-11 5 -21 12c-11 6 -26 3 -38 2l-38 -3l-11 -1h-17l22 2h8l40 3l11 1l6 8l15 4h3l9 1l7 1l55 8c11 1 11 1 14 4l4 12h-215q-10 0 -21 6l-13 1h-22q-18 2 -34 -7q-15 -7 -31 -6H854l-64 -1l-173 -1H460a574 574 0 0 0 -87 4l-1 -4l-2 6h-8l-4 1c-5 1 -5 1 -9 11l25 1v-5q5 -2 11 -1h31v5q-6 4 -14 4h-9l16 1l-6 24h-11q-4 0 -7 5l-2 8l-1 5v3l-9 1l-6 2l-1 4l3 -1v-2q5 -2 11 -2l-7 5h59l3 -6h3l1 -3v6l-3 2h3l1 -10l12 -1h-12l-1 -9l-2 -6h-12q-3 -1 -6 3l-2 7v4l-1 3l-9 1q0 -10 3 -20l6 -17l2 -6l10 -1h9l3 -8h34l5 1v5h-4l1 55l-8 -1v10h-9l7 1v2l-20 -1l-1 -4l-1 5h-8l2 -10h-38l5 2l-2 8l-6 1c-1 -4 -1 -4 1 -11h-39l-1 7l-3 1l-3 -8h-9v-1h7l-3 -10l-1 -3c-1 -6 -1 -6 -4 -10h-5l2 5l2 10l-4 -1l-2 -6l-4 -2l3 -12l-25 58l-4 9q-3 6 -11 8l-5 2l-8 3l-1 2h-79l-5 1h-28v-2H65v4h2c2 4 2 4 3 13h204v6l-1 -4h-92l-1 31l-3 3l4 11q-9 2 -18 -1l-2 1l-1 -2l-9 -3l-3 -1l-6 -1l-10 -3l-30 -9l-21 -6l-6 -1l-4 -2q-4 0 -7 -5q-7 -18 -11 -38l-1 -3l-1 -4l-1 -3l1 -9q5 -5 12 -8l4 -2l4 -2l5 -1l14 -6l4 -2l4 -1q36 -15 69 -31c76 -36 157 -64 241 -71q17 -1 32 -10q17 -10 36 -10v-2h5l23 -1q30 -3 61 -3h24c20 0 20 0 29 4q15 6 31 7l11 1l5 1l12 1h4q13 3 25 9l14 1l6 1h43l55 1h17l73 1c20 1 20 1 38 -7l6 -6q6 -5 13 -5l4 -1a473 473 0 0 1 101 0h5q10 -2 17 -11l8 -6l4 -3l16 -11l16 -12l7 -3l9 -6l2 -2l36 -25c9 -6 9 -6 16 -6"/>
            <path fill="#666960" d="M372 392h1v5h3q64 -8 128 -5h190l4 1l102 1v49h-14l-1 -40l-1 21l-12 1h-21q-2 6 -1 11v6l-1 6v20h3v-40l27 1v39h-2v2h-28l1 41l36 1v-66h14v19l1 7v40l487 1v8H729l-442 -1l9 -4l4 -2h3v-2l410 -1c-6 -17 -6 -17 -15 -19l-11 1h-5l-1 -5l-17 -1l1 -3h3v-2l-5 1l-1 -3l1 9l18 1v4l-12 1h-58l-4 -1v-24h-6v18l-2 1l-3 -1h-15l-1 -46v16l-1 1l-1 8h-1l-1 43l-16 1v-41h-2v41h-15l1 -26v-4l-1 -1v-10h-9v9h6v1l-5 1l-1 4h-12l-6 -1v16h-20q-2 -8 -2 -17l18 -1l-4 -1v-10l-16 -1v10h-21v-9l-1 -3l5 -1v-3l-1 -15v-5l1 -31h4l-1 -5l-38 -1l-1 6l-2 3l-10 1h-9l-1 3l-3 12l-2 5l-1 4l-1 4l-2 5l-1 9l9 -1v-5q1 -7 4 -12l9 -1h8q5 7 3 16h2l16 -1v1l-18 1l1 4q1 4 -2 7l-4 -1l3 -2v-3h-3l-1 4l-2 3h-60l6 -5l-9 1v2l2 1h-5l1 -5q7 -3 15 -2v-3l1 -5v-4q1 -6 6 -9h14l1 -5l5 -19h-17l1 -2h9l5 -1l8 -2l1 -5l-42 1v5h-25l4 -11l17 -3z"/>
            <path fill="#4a5151" d="M426 370v1l-23 2l-1 5l-2 3q-4 6 -4 13h-1v-6l-5 1l-16 1l-1 3h-1l-2 6h-8l-4 1c-5 1 -5 1 -9 11l25 1v-5q5 -2 11 -1h31v5q-6 4 -14 4h-9l16 1l-6 24h-10c-4 1 -4 1 -8 5l-2 8v5l-1 3l-9 1l-6 2l-1 4l3 -1v-2q5 -2 11 -2l-7 5h59l3 -6h3l1 -3v6l-3 2h3l1 -10l12 -1h-12l-1 -9l-2 -6h-11q-4 -1 -7 3l-2 7v4l-1 3l-9 1q0 -10 3 -20l6 -17l2 -6l10 -1h9l3 -8h34l5 1v5h-4l1 55l-8 -1v10h-9l7 1v2l-20 -1l-1 -4l-1 5h-8l2 -10h-38l5 2l-2 8l-6 1c-1 -4 -1 -4 1 -11h-39l-1 7l-3 1l-3 -8h-9v-1h7l-3 -10l-1 -3c-1 -6 -1 -6 -4 -10h-5l2 5l2 10l-4 -1l-2 -6l-4 -2l3 -12l-13 30l-2 5l-9 20l-1 4l-3 8q-4 6 -12 8l-5 2l-8 3l-1 2h-79l-5 1h-28v-2H65v4h2c2 4 2 4 3 13h204v6l-1 -4h-92l-1 31l-3 3l4 11q-9 2 -18 -1l-2 1l-1 -2l-9 -3l-3 -1l-6 -1l-10 -3l-30 -9l-12 -3l-9 -3l-6 -1l-4 -2q-4 0 -7 -5q-7 -18 -11 -37l-1 -4l-1 -4l-1 -3l1 -9q5 -5 12 -8l4 -2l4 -2l5 -1l14 -6l4 -2l4 -1q36 -15 69 -31c78 -36 171 -74 259 -72"/>
            <path fill="#292c2b" d="M335 436q1 5 -1 10l-2 3l-1 3l5 2l2 6l3 1l-2 -6l-1 -4l-2 -6h6q5 5 6 12l1 5l1 7l3 3l2 6l2 -1l2 -7h39l-1 9l6 1v-5l2 -3h-5v-2h38l-2 10h8v-5l2 -1v5h11l9 1v-2h-10q6 -3 11 -2l1 -9h5l-3 1v2l2 1l-1 9h21v-10h26v1h-10v10h8q-6 3 -13 2h-9l1 2l1 8v7l5 -1l15 1v-16l18 1l1 -5l-1 -1v-9h9v5l2 7v7l-1 4v8l-1 10h15v-41h2v41l16 -1v-44h1v-3l2 -6v-11l1 -9h1v51l2 -1h10l7 1l1 -18h5l1 -4v4l3 1h-3l1 23h73v-4h-18l-2 -16c2 3 2 3 2 8h5v2l-3 1l-1 2h18v6h22l10 19H303l4 -12l2 -5l2 -5l4 -9l2 -5z"/>
            <path fill="#137f92" d="M1212 268h73q-9 21 -21 41l-2 5l-6 12h-2l-1 5q-3 10 -13 14l-3 2q-11 5 -21 12c-11 6 -26 3 -38 2l-38 -3l-11 -1h-10q-51 0 -103 -4v-1h38l5 1h10c13 1 13 1 23 -5l6 -6l8 -6l4 -3l16 -11l16 -12l7 -3l9 -6l2 -2l36 -25c9 -6 9 -6 16 -6"/>
            <path fill="#37a9bc" d="M327 454 L317 480 L313 489 L311 493 L307 501 L306 505 L305 508 L299 514 L294 515 L284 520h-84l-5 1h-19l-19 -1h-4l-12 -1h-27l-1 -22v-9q1 -8 8 -11l17 -3h6l16 -2l12 -1l22 -3l34 -4l36 -4l24 -2l3 -1l13 -1l9 -1l6 -1z"/>
            <path fill="#7f9597" d="M786 446h14v19l1 7v40l487 1v8H729l-442 -1l9 -4l4 -2h3v-2h483z"/>
            <path fill="#178699" d="M1349 300 L1376 302h43l1 3l-4 4l-5 5l-3 3l-14 15l-7 7l-10 11l-15 15l-13 15q-8 5 -17 2l-20 -4l-6 -1l-80 -16q-6 -1 -7 -3c8 -6 8 -6 14 -7v-2l5 -2l17 -9l8 -4l43 -22l15 -8l3 -1q12 -7 25 -3"/>
            <path fill="#313838" d="M372 392h1v5h3q68 -8 136 -5h100v1h-54v7h-15v4l1 38h14v2h-15v25h-9v-7h-26v7h-16v-2h-13l1 -52h-2l-1 16v3l-1 10v23h-1l-1 -18v-5l1 -31h4l-1 -5l-38 -1l-1 6l-2 3l-10 1h-9l-1 3l-3 12l-2 5l-1 4l-1 4l-2 5l-1 9l9 -1v-5q1 -7 4 -12l9 -1h8q5 7 3 16h2l16 -1v1l-18 1l1 4q1 4 -2 7l-4 -1l3 -2v-3h-3l-1 4l-2 3h-60l6 -5l-9 1v2l2 1h-5l1 -5q7 -3 15 -2v-3l1 -5v-4q1 -6 6 -9h14l6 -24h-17l1 -2h9l5 -1l8 -2l1 -5l-42 1v5h-25l4 -11l17 -3z"/>
            <path fill="#525958" d="M1069 430h79c2 3 2 3 2 9h27v42h-22v-14h-2v3h-3l-1 -3l-2 2l2 1v2h4v9h-5c2 2 9 1 12 2h10l-1 2h-14v3l16 1v-6l3 -1v29h-25l27 1v1H831v-1l21 -1v-3h-19v-4h125v4H854v4l270 -1l-1 -30l-2 1l-1 28h-23v-29h-3v29h-2l-1 -29h-16v-3l12 -2v-2l-6 2l-11 1l5 -5l-6 1c-2 -38 -2 -38 0 -43"/>
            <path fill="#77756b" d="M440 407h34l5 1v5h-4l1 55l-8 -1v10h-9l7 1v2l-20 -1l-1 -4l-1 5h-8l2 -10h-38l5 2l-2 8l-6 1c-1 -4 -1 -4 1 -11h-39l-1 7l-3 1l-3 -8h-9v-1h7l-3 -10l-1 -3c-1 -6 -1 -6 -4 -10h-5l2 5l2 10l-4 -1l-2 -6l-4 -2l5 -16l3 -5l6 -12l16 -2h5l43 -1l-6 24h-10c-4 1 -4 1 -8 5l-2 8v5l-1 3l-9 1l-6 2l-1 4l3 -1v-2q5 -2 11 -2l-7 5h59l3 -6h3l1 -3v6l-3 2h3l1 -10l12 -1h-12l-1 -9l-2 -6h-11q-4 -1 -7 3l-2 7v4l-1 3l-9 1q0 -10 3 -20l6 -17l2 -6l10 -1h9z"/>
            <path fill="#2fa4b8" d="M612 372h97l169 1v21H672l-60 -1z"/>
            <path fill="#269fb5" d="M879 374h117l33 -1h51q4 1 6 4q4 8 4 15v8h-4l-10 4q-9 5 -19 4h-22q-18 2 -34 -7q-10 -6 -22 -6h-95l-5 -1z"/>
            <path fill="#4bb3c4" d="M427 369v2h4l19 -1h23l137 1v21H464a649 649 0 0 0 -91 5l1 -7l8 -1l4 -1h9l6 -12q2 -3 6 -4h5z"/>
            <path fill="#38a9bc" d="M1212 268h73l-7 14l-2 4l-1 3h-34l-12 -1h-4q-10 -1 -18 7l-4 3l-56 44l-7 6q-7 4 -13 2l-2 -1h-5l-7 -10l5 9h-12l-9 -1c1 -6 3 -7 8 -11l4 -3l17 -11l16 -12l7 -3l9 -6l2 -2l36 -25c9 -6 9 -6 16 -6"/>
            <path fill="#192224" d="M580 437h1v51l2 -1h10l7 1l1 -18h5l1 -4v4l3 1h-3l1 23h73v-4h-18l-2 -16c2 3 2 3 2 8h5v2l-3 1l-1 2h18v6h22l10 19H520l-11 -1v-1h7v-26l18 1l1 -5l-1 -1v-9h9v5l2 7v7l-1 4v8l-1 10h15v-41h2v41l16 -1v-44h1v-3l2 -6v-11z"/>
            <path fill="#29a3b7" d="M1293 514h28v49l-26 8h-4l-14 4l-30 7l-26 6l-31 7l-4 1l-18 4l-1 26l-6 1l-3 1h-8v-91h143z"/>
            <path fill="#141c1e" d="M175 602 L198 607 L202 608 L218 612 L238 617 L242 618 L278 625 L313 632 L319 634 L329 635 L356 640 L392 647 L391 651c-11 7 -22 4 -34 1h-12c-8 6 -8 6 -11 15l2 1h-3v3h12l10 1l2 8h3l1 6c-11 7 -27 6 -39 6h-4l-51 -1l-45 -1L238 680 L272 680 L288 671l1 -3l21 -1h3q-3 -5 -9 -7q-7 -4 -11 -12l-5 1l-9 -6c-5 -3 -5 -3 -11 -4l-1 2q-8 1 -16 -2l-1 -6h-4l-25 -5l-10 -2l-6 -1l-6 -1l-7 -3v-2l-5 -2l-6 -4l-3 -2z"/>
            <path fill="#756858" d="M1064 541h76v3l1 3v4l2 8v14l4 -1v20l-6 1v-7h-25l-1 2l-8 1l-1 4q-2 6 -4 6h-11v15l-1 11h-2l-2 4l-12 1h-41l-1 -10h25v-2h-24v-10l-3 -5v-3h-89v-2h86v-8l2 2l3 -3h-14l-1 7h-12v-7h-7v-22h18q2 5 1 11v9h10v-31l15 -1l11 -1l7 1v-10q-1 -5 4 -4"/>
            <path fill="#303232" d="M446 588h15l-1 5l4 1l1 -6h12l-1 11h2l3 -10l5 -1l2 31v10l26 1v-26l2 1h11l4 1h14v-10h-3l-8 -2l3 -6l5 1h35l30 1h48l9 1l2 -3l9 3l2 4h2v4h5v-11h4v41h23v-30l4 1v8h-1v8h2c1 11 1 11 -1 14l3 1q-128 2 -257 0l1 -2h2l1 -32l-17 -1v-2h9v-5h-11z"/>
            <path fill="#25808d" d="M126 464 L125 468 L123 477 L119 480c-6 6 -5 13 -5 22v17h46l20 1h12l4 -1h29l56 1l-1 2h-79l-5 1h-28v-2H65v4h2c2 4 2 4 3 13h204v6l-1 -4h-92l-1 31l-3 3l4 11q-9 2 -18 -1l-2 1l-1 -2l-9 -3l-3 -1l-6 -1l-10 -3l-30 -9l-12 -3l-9 -3l-6 -1l-4 -2q-4 0 -7 -5c-10 -29 -10 -29 -10 -43l-1 -11q-1 -3 3 -6l7 -3l5 -2l5 -2l10 -4l15 -6l5 -2l5 -2l11 -5z"/>
            <path fill="#a2b8b9" d="M1149 620v9q-12 4 -25 5l-16 3q-30 6 -60 5h-17l-30 -1H657l-167 -1h-84l2 -1l-2 -3v-3l-5 -1l14 -1h587l25 1h31q23 0 46 -5l10 -2l15 -3l5 -1h4z"/>
            <path fill="#717b78" d="M462 552h26v23l-14 1l11 1h3q2 5 1 9h43l8 1h35l19 1h58v1l-15 1h-90l-10 -1l-2 5l10 2v10h-26l-4 -1l-1 25h-26q-2 -4 -1 -10v-6l-1 -6v-20l-4 1l-3 8l-1 2h-2l1 -11l-4 1l-8 -1v7l-6 -1l2 -6l-4 1v5h-9v2h11l6 1v23l1 4l-5 7h-12l-8 -1l-8 -1h-8v-32q5 -2 10 -1l1 1h7l-1 -11h3l1 -4l2 -1v2l9 1v-2l5 1zM446 628 L445 630 L448 629z"/>
            <path fill="#926b4b" d="M856 558h35l47 1v27l-3 2v-15h-5l-1 -5v-3l-6 1l-1 3l-1 4l-3 1v8l15 -2v13l-17 1l1 -5l-2 -2l1 -2l-3 1l-2 12l-1 9h-20l-2 23h-13l-1 -3h-2l-6 -9l-5 -7l-19 -27l-4 -5l-3 -7h29l-5 -8z"/>
            <path fill="#20292b" d="M911 589h1v41l14 -1l13 1v-41h9l1 8h-8v3h89l2 6l27 1v1h-26v10h24v2h-25l1 10h30l1 -2l1 1h14q6 0 10 -4v4l2 1q-9 3 -18 2H874l-1 -2h15l1 -24l21 1z"/>
            <path fill="#e36811" d="M65 521h103v2l3 -1h13c7 1 7 1 14 -1h82l-5 17H70l-2 -9l-1 -4h-2z"/>
            <path fill="#b1b6aa" d="M831 513h457v8h-224l-6 -1H831z"/>
            <path fill="#b2a38a" d="M1064 541h76v3l1 3v4l2 8v14l4 -1v20l-6 1v-7h-25l-1 2l-8 1l-1 4q-2 6 -4 6h-11v-8c-2 2 -2 2 -2 9h-25v-11l22 -1v-33h2v-4h-3l-25 -1v-8z"/>
            <path fill="#3698a8" d="M570 346h5c21 0 37 2 56 10l1 12q-1 3 -7 2h-12l-92 -1h-39l-1 -12l-1 1h-10q-14 0 -26 7l-13 4c17 -17 42 -17 65 -19l10 -1z"/>
            <path fill="#6c807d" d="M478 415h2v42l-1 10h13v2h16v-7h26v7h9v-25h15v25h2v-11h16v52l-16 1v-41h-2v41h-15l1 -26v-4l-1 -1v-10h-9v9h6v1l-5 1l-1 4h-12l-6 -1v16h-20q-2 -8 -2 -17l18 -1l-4 -1v-10l-16 -1v10h-21v-9l-1 -3h6v-40q0 -7 2 -13"/>
            <path fill="#3caec1" d="M1355 301h4l8 2l-12 8l-10 7c-22 15 -22 15 -33 19c-4 1 -4 1 -8 5l-11 6l-6 4l-3 1l-23 14l-34 -6c-6 -1 -6 -1 -8 -3c8 -6 8 -6 14 -7v-2l5 -2l17 -9l8 -4l58 -30l3 -1c12 -6 19 -5 31 -2"/>
            <path fill="#1b99ae" d="M1150 570h139l-1 2l-9 2l-6 2l-6 1l-9 2l-11 3l-26 6l-31 7l-4 1l-18 4l-1 26l-6 1l-3 1h-8z"/>
            <path fill="#556569" d="M1298 405h23q6 19 5 39v15h-22l-2 10h5l12 -1l2 2h-29l-18 -1v-59h13l1 19l6 -2h5v-3h2l-1 -6v-4z"/>
            <path fill="#669993" d="M426 370v1l-23 2l-1 5l-2 3q-4 6 -4 13h-1v-6l-5 1l-16 1l-1 3h-1l-2 6l-4 1l-95 14l-7 1l-27 3h-7q4 -4 11 -6v-2c57 -20 124 -41 185 -40"/>
            <path fill="#5b8f92" d="M661 429 L663 430v15l1 7l5 1l5 1l3 8l2 6l4 1q3 0 2 -6l1 -7l1 -9v-9l2 1v4l1 8l-1 4h3l14 -1v-9h1v25l-3 1l3 1v-34l9 -1l1 1l10 1l-1 4l1 12c0 6 0 6 -2 10h-5v14q-1 6 -5 10h-8q2 13 10 22h-4l-1 -4q-3 -7 -8 -13q-10 -3 -22 -1l-1 -5l-17 -1l1 -3h3v-2l-5 1l-2 -11l-1 -4v-3l-3 -1h2v-26c0 -5 0 -5 2 -9"/>
            <path fill="#67c1d1" d="M879 374h117l33 -1h51q4 1 7 4l2 9H936l-57 -1z"/>
            <path fill="#c1bca8" d="M303 512h266v8H287l9 -4l4 -2h3z"/>
            <path fill="#cbd7dc" d="M409 416 L403 440h-10c-4 1 -4 1 -8 5l-2 8v5l-1 3l-14 1l-4 -9l-4 -6h-7l-11 -1h-5l2 5l2 10l-4 -1l-2 -6l-4 -2l5 -16l3 -5l6 -12l16 -2h5z"/>
            <path fill="#ce6c1c" d="M1385 505h22a118 118 0 0 1 7 52q0 17 -5 33l-22 1v-4l1 -3l1 -9v-40h-9v-1h8q3 -11 -1 -21z"/>
            <path fill="#2d3738" d="M749 424h26l7 1v2h-2v42h2v-32h1l1 31l1 -23h15v1h-14v66h-37v-42h28v-2h2v-39h-11l-16 -1v40h-3z"/>
            <path fill="#69a1a7" d="M1149 620v9q-12 4 -25 5l-23 5l-39 3h-50l-40 -1H831v-1h125v-8h100q25 1 48 -5l10 -2l15 -3l5 -1h4z"/>
            <path fill="#37afc1" d="M1275 471h46v42h-26l-20 -1z"/>
            <path fill="#c9d7dc" d="M423 416h49l-3 13l-1 6l-1 3l-1 4v3l-2 9l-9 1l-4 1h-11l-1 -9l-2 -6h-12q-3 -1 -6 3l-2 7v4l-1 3l-9 1q0 -10 3 -20l6 -17q0 -7 7 -6"/>
            <path fill="#a95721" d="M723 558q4 22 -1 43h-1v-13h-10v41l-24 1v-18l1 -25h-3v-20h30l2 -7z"/>
            <path fill="#d36e1d" d="M1386 404h20c10 23 10 52 4 76l-4 9h-20l3 -16q2 -15 1 -31v-5c1 -11 1 -11 -2 -21z"/>
            <path fill="#688488" d="M1179 439h27v16c0 9 0 9 -2 12q5 3 11 2l-1 -3v-23h19v26h37v1h-38v7h-17v-7h-8v11h-9l-1 -1v-6h-8v7h-9l-1 -5z"/>
            <path fill="#1b1f20" d="M853 464h100v3l4 1l-11 1l13 1l-1 9l-50 1l-1 3l-56 -1l1 -2z"/>
            <path fill="#b5aa92" d="M1093 442h1v27h3v-26h24l-1 2v16l-1 49h-22v-29h-3v29h-2v-38l3 -2h-7l4 -1v-26z"/>
            <path fill="#b0a792" d="M561 544h60v6h-8l2 8h-8v4l-25 1v2h-20l-2 4h-6v-8l6 -3v-6l-3 -1l1 -6z"/>
            <path fill="#c9722f" d="M1440 282q-3 7 -8 10l-9 10l-2 2h-2v-2h-34q-24 2 -49 -4v-3q20 -11 42 -12h6z"/>
            <path fill="#cc6214" d="M613 466h47l1 11l2 12l18 1v4l-12 1h-58l-4 -1v-17c0 -11 0 -11 6 -11"/>
            <path fill="#c9bfa7" d="M831 513h227v7H831z"/>
            <path fill="#28a7bb" d="M1293 514h28v49l-16 5l-5 1l-9 1l-1 -4v-29h3z"/>
            <path fill="#305361" d="M604 417v51l-2 2l-1 9v9l-2 1l-3 -1h-15l-1 -56h-1l-1 -14h6c6 0 14 -3 20 -1"/>
            <path fill="#6d6b64" d="M447 581 L448 583 L456 584h8q2 5 1 11l-6 -1l2 -6l-4 1v5h-9v2h11l6 1v23l1 4l-5 7h-12l-8 -1l-8 -1h-8v-32q5 -2 10 -1l1 1h7l-1 -11h3l1 -4zM446 628 L445 630 L448 629z"/>
            <path fill="#6ac7d4" d="M612 372h143v11h-59l-84 -1z"/>
            <path fill="#33383b" d="M1208 541h58v26h-58z"/>
            <path fill="#5f777a" d="M1027 556h29v32l-38 1l-1 7h-12v-7h-7v-22h18q2 6 1 11v9h10z"/>
            <path fill="#91aeb4" d="M776 632h180v8H776z"/>
            <path fill="#aca99b" d="M833 482h74v19h-73q-3 -9 -1 -19"/>
            <path fill="#cdc5af" d="M833 438h74v18q-4 2 -9 1h-65z"/>
            <path fill="#65c2d1" d="M757 372 L837 373h41v11H757z"/>
            <path fill="#cf7929" d="M1066 364h16l48 1h18l15 3v4l-59 1l7 3q2 10 1 19h-22v-8q-1 -7 -6 -12l-17 -1h-16l2 -5l3 -1v-2z"/>
            <path fill="#4e4f49" d="M920 558h19v72h-27v-44l4 -1v2l12 1v1h-11l1 4h15l-1 -12l-3 1h-11v-8l3 -2l2 -7h6l1 7l5 1l1 14q2 -3 1 -7v-4l1 -4v-13h-18z"/>
            <path fill="#484b46" d="M468 467h5l-3 1v2l2 1l-1 9h21v-10h26v1h-10v10h8q-6 3 -13 2h-9l1 2l1 8v7l5 -1l15 1v10h-22l-1 -4l-1 4l-22 1l-1 -9l-1 8h-1l-1 -32h-10q6 -3 11 -2z"/>
            <path fill="#bbcad0" d="M226 425h18l-13 12l-3 2l-11 8l-3 3l-3 2l-6 5q-7 4 -15 4h-3l-29 1l-1 -5l50 -25l5 -2l5 -2c5 -3 5 -3 9 -3"/>
            <path fill="#bbc2be" d="M621 632h155v8H621z"/>
            <path fill="#668085" d="M1004 490h59v21h-59z"/>
            <path fill="#1e5762" d="M565 345h24c20 0 20 0 29 4q15 7 31 7l12 1h5l7 3l-23 -1l-3 -1l-15 -2v11h-1v-11h-3l-11 -4c-40 -17 -101 -3 -143 2h-8q-13 2 -23 8l-4 2l-7 4l16 -6q10 -5 22 -5h10l2 -4v16h82l1 -3v3h86l18 1h36v1H427v-3q22 -16 49 -17v-2h5l23 -1q30 -3 61 -3"/>
            <path fill="#5c6f73" d="M783 562h12v68h-12v-41l-2 1v9h-35v-2l20 -1l-4 -2v-3h-2v2l-9 2l-1 -2l-1 3h-3c-1 -6 -1 -6 1 -11l2 1l1 -1l6 -1v-2h14l1 4l12 1z"/>
            <path fill="#5f7072" d="M303 555h28l1 53h-6v2l-10 -2l7 -1l-9 -3l1 3l-8 -3l3 -1l-5 -1v-27h8l3 3v2h-4v2l7 -1l-1 -2h7l-2 -1v-2h7l-1 -2l-24 -1l-1 -8h20l-22 -5z"/>
            <path fill="#187f90" d="M548 354h5l11 1v14h-82v-13z"/>
            <path fill="#aba491" d="M882 558h23l33 1v27l-3 2v-15h-5l-1 -5v-3l-6 1l-1 3l-1 4l-3 1v8l15 -2v13l-17 1l1 -5l-2 -2l1 -2l-4 1v-14h-23l-1 2h12l-1 2h-10v12h-7z"/>
            <path fill="#a9bebc" d="M914 435h43v23h-49c0 -23 0 -23 6 -23"/>
            <path fill="#958d7a" d="M835 572h26l5 1h15v14h-7v-5h-2v35q1 5 -2 6c-6 -8 -6 -8 -6 -10l-5 -5l-14 -20l-8 -12z"/>
            <path fill="#6f3f1c" d="M720 465h7v1h-6v4h19v31l-1 10h9v1h-34v-3l-3 -5q-4 -7 -4 -15h4l4 -1l4 -10l-2 -1h2v-4z"/>
            <path fill="#5bbac8" d="M1015 351 L1016 353h6l36 1l19 1l23 2l41 2l7 1l18 1v6l-27 -1h-23l-4 -1l-26 -1v-6h-2v5h-52l-4 -1h-9l-7 -1v-8h3z"/>
            <path fill="#ef8326" d="M1305 406h16q6 18 5 38v15h-23l-1 -38l6 -1q0 -7 -3 -14"/>
            <path fill="#cbc2ab" d="M621 513h155v7H621z"/>
            <path fill="#7d999d" d="M908 480h49v22h-42l-7 -1z"/>
            <path fill="#437989" d="M786 446h14v19l1 7v40h29v1h-54v-1h10z"/>
            <path fill="#7e7f81" d="M1323 406h31q8 13 7 28l-4 1c-28 0 -28 0 -30 -2v-5q1 -7 -2 -12zM1360 410 L1367 411v3h-3v2h4l1 6l-1 1h-5q-5 -5 -4 -12z"/>
            <path fill="#222626" d="M446 588h15l-1 5l4 1l1 -6h12l-1 11h2l3 -10l5 -1l2 32v11h-27l1 -2h2l1 -32l-17 -1v-2h9v-5h-11z"/>
            <path fill="#308391" d="M632 356 L673 359q16 0 30 8q16 5 33 3h24v1l-98 1h-50v20h-2v-21l20 -1l2 -8z"/>
            <path fill="#8a8d88" d="M513 590v36q-7 2 -15 1l-11 -1v-35q13 -2 26 -1"/>
            <path fill="#838f86" d="M478 415h2v42l-1 10h13v2h16v-7h26l-1 9v9l-25 1v-10l-16 -1v10h-21v-9l-1 -3h6v-40q0 -7 2 -13"/>
            <path fill="#d16f27" d="M1255 254h37l-6 13h-79v-3c13 -10 31 -10 48 -10"/>
            <path fill="#151d1e" d="M331 568 L345 573 L349 574v13h2v-6h1l1 16h8l1 -7q3 9 2 17v12q-6 1 -12 -2c3 -1 3 -1 11 1l-1 -17l-11 -1v16l-16 -4l-9 -2v-2h5z"/>
            <path fill="#c3d1d6" d="M271 430v22q-27 5 -55 6l17 -14l8 -7c10 -9 17 -9 30 -7"/>
        </symbol>
        <symbol id="factory-background" viewBox="0 0 800 600" preserveAspectRatio="none">
            <defs>
                <filter id="factory-blur" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="4"/>
                </filter>
                <filter id="factory-blur2" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="6"/>
                </filter>
                <filter id="factory-blur3" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="8"/>
                </filter>
            </defs>
            <rect width="800" height="600" fill="#0e0f23"/>
            <g filter="url(#factory-blur3)">
                <path d="M-20,100 Q30,80 80,100 L80,450 Q30,480 -20,450 Z" fill="#1a1d35"/>
                <ellipse cx="30" cy="100" rx="55" ry="25" fill="#1e2140"/>
                <rect x="250" y="50" width="200" height="400" rx="10" fill="#181b30"/>
                <rect x="270" y="80" width="160" height="100" rx="5" fill="#1a1d35"/>
                <rect x="270" y="200" width="160" height="80" rx="5" fill="#1a1d35"/>
                <circle cx="350" cy="130" r="35" fill="#1e2140"/>
                <circle cx="350" cy="240" r="25" fill="#1e2140"/>
                <path d="M650,80 Q720,60 780,80 L780,500 Q720,530 650,500 Z" fill="#1a1d35"/>
                <ellipse cx="715" cy="80" rx="70" ry="30" fill="#1e2140"/>
            </g>
            <g filter="url(#factory-blur2)">
                <rect x="0" y="60" width="800" height="18" rx="9" fill="#1e2140"/>
                <rect x="0" y="90" width="800" height="14" rx="7" fill="#1a1d35"/>
                <rect x="0" y="115" width="800" height="20" rx="10" fill="#1c1f38"/>
                <rect x="0" y="280" width="800" height="16" rx="8" fill="#1a1d35"/>
                <rect x="0" y="305" width="800" height="22" rx="11" fill="#1e2140"/>
                <rect x="0" y="480" width="800" height="20" rx="10" fill="#1c1f38"/>
                <rect x="0" y="510" width="800" height="14" rx="7" fill="#1a1d35"/>
            </g>
            <g filter="url(#factory-blur2)">
                <rect x="50" y="0" width="25" height="600" rx="12" fill="#1a1d35"/>
                <rect x="150" y="0" width="18" height="600" rx="9" fill="#1c1f38"/>
                <rect x="320" y="0" width="30" height="600" rx="15" fill="#1a1d35"/>
                <rect x="480" y="0" width="22" height="600" rx="11" fill="#1e2140"/>
                <rect x="580" y="0" width="28" height="600" rx="14" fill="#1a1d35"/>
                <rect x="720" y="0" width="20" height="600" rx="10" fill="#1c1f38"/>
            </g>
            <g filter="url(#factory-blur)">
                <rect x="80" y="180" width="90" height="140" rx="5" fill="#1c1f38"/>
                <rect x="90" y="195" width="70" height="45" rx="3" fill="#1a1d35"/>
                <circle cx="105" cy="270" r="12" fill="#1e2140"/>
                <circle cx="135" cy="270" r="12" fill="#1e2140"/>
                <rect x="90" y="290" width="30" height="15" rx="2" fill="#1e2140"/>
                <rect x="125" y="290" width="30" height="15" rx="2" fill="#1e2140"/>
                <circle cx="200" cy="200" r="30" fill="#1a1d35"/>
                <circle cx="200" cy="200" r="22" fill="#1e2140"/>
                <circle cx="200" cy="380" r="25" fill="#1a1d35"/>
                <circle cx="200" cy="380" r="18" fill="#1e2140"/>
                <rect x="100" y="400" width="120" height="150" rx="8" fill="#1c1f38"/>
                <circle cx="160" cy="450" r="35" fill="#1a1d35"/>
                <circle cx="160" cy="450" r="25" fill="#1e2140"/>
                <circle cx="160" cy="520" r="25" fill="#1a1d35"/>
                <path d="M380,340 Q400,320 450,320 Q500,320 520,340 L520,450 Q500,470 450,470 Q400,470 380,450 Z" fill="#1c1f38"/>
                <ellipse cx="450" cy="340" rx="70" ry="25" fill="#1e2140"/>
                <circle cx="450" cy="400" r="30" fill="#1a1d35"/>
                <rect x="420" y="450" width="60" height="80" rx="5" fill="#1a1d35"/>
                <rect x="540" y="150" width="80" height="200" rx="40" fill="#1a1d35"/>
                <ellipse cx="580" cy="150" rx="40" ry="15" fill="#1e2140"/>
                <ellipse cx="580" cy="350" rx="40" ry="15" fill="#1c1f38"/>
                <rect x="555" y="200" width="50" height="8" fill="#1e2140"/>
                <rect x="555" y="240" width="50" height="8" fill="#1e2140"/>
                <rect x="555" y="280" width="50" height="8" fill="#1e2140"/>
                <rect x="650" y="200" width="100" height="180" rx="5" fill="#1c1f38"/>
                <rect x="660" y="215" width="80" height="50" rx="3" fill="#1a1d35"/>
                <rect x="660" y="275" width="35" height="25" rx="2" fill="#1e2140"/>
                <rect x="705" y="275" width="35" height="25" rx="2" fill="#1e2140"/>
                <circle cx="680" cy="330" r="15" fill="#1e2140"/>
                <circle cx="720" cy="330" r="15" fill="#1e2140"/>
                <rect x="665" y="355" width="70" height="15" rx="3" fill="#1a1d35"/>
                <ellipse cx="120" cy="95" rx="15" ry="20" fill="#1e2140"/>
                <ellipse cx="400" cy="70" rx="18" ry="22" fill="#1e2140"/>
                <ellipse cx="600" cy="295" rx="16" ry="20" fill="#1e2140"/>
                <ellipse cx="250" cy="490" rx="14" ry="18" fill="#1e2140"/>
                <rect x="0" y="350" width="200" height="15" rx="7" transform="rotate(-15 100 357)" fill="#1a1d35"/>
                <rect x="600" y="400" width="250" height="18" rx="9" transform="rotate(12 725 409)" fill="#1a1d35"/>
                <rect x="280" y="520" width="70" height="80" rx="5" fill="#1c1f38"/>
                <circle cx="315" cy="545" r="18" fill="#1e2140"/>
                <rect x="290" y="570" width="50" height="20" rx="3" fill="#1a1d35"/>
                <rect x="750" y="420" width="50" height="70" rx="3" fill="#1c1f38"/>
                <rect x="758" y="430" width="34" height="20" rx="2" fill="#1a1d35"/>
                <rect x="758" y="458" width="34" height="20" rx="2" fill="#1a1d35"/>
            </g>
        </symbol>
        <symbol id="jungle-background" viewBox="0 0 800 600" preserveAspectRatio="none">
            <defs>
                <filter id="jungle-blur" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="4"/>
                </filter>
                <filter id="jungle-blur2" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="6"/>
                </filter>
            </defs>
            <!-- Background -->
            <rect width="800" height="600" fill="#0e0f23"/>
            <!-- Tree trunks -->
            <g filter="url(#jungle-blur2)">
                <path d="M18,0 Q45,120 28,280 Q50,400 32,600 L78,600 Q55,450 72,250 Q48,100 65,0 Z" fill="#130b06"/>
                <path d="M108,0 Q135,180 118,350 Q145,520 130,600 L162,600 Q148,400 165,220 Q138,80 155,0 Z" fill="#170d06"/>
                <path d="M255,0 Q285,150 268,320 Q298,480 278,600 L348,600 Q318,420 342,200 Q302,70 328,0 Z" fill="#130b06"/>
                <path d="M405,0 Q438,220 418,420 Q448,540 430,600 L472,600 Q455,350 478,140 Q442,45 468,0 Z" fill="#150c06"/>
                <path d="M535,0 Q568,170 545,380 Q578,510 558,600 L608,600 Q585,380 612,170 Q572,60 598,0 Z" fill="#170d06"/>
                <path d="M662,0 Q698,200 672,360 Q712,490 685,600 L752,600 Q718,410 748,195 Q702,55 735,0 Z" fill="#130b06"/>
                <path d="M745,0 Q782,190 758,400 Q795,530 772,600 L820,600 Q798,390 825,180 Q785,50 812,0 Z" fill="#150c06"/>
            </g>
            <!-- Foliage - 60 randomly placed blobs -->
            <g filter="url(#jungle-blur)">
                <path d="M225,407 Q256,391 288,413 Q313,404 321,434 Q306,458 272,454 Q238,463 221,438 Q209,422 225,407 Z" fill="#091f09"/>
                <path d="M371,153 Q428,121 489,163 Q524,197 480,240 Q423,264 374,227 Q337,190 371,153 Z" fill="#0a210a"/>
                <path d="M214,156 Q250,138 286,164 Q314,150 321,189 Q337,179 331,220 Q304,246 259,236 Q222,249 205,214 Q189,193 214,156 Z" fill="#091f09"/>
                <path d="M576,506 Q626,479 683,516 Q712,547 673,584 Q621,605 578,572 Q547,539 576,506 Z" fill="#091f09"/>
                <path d="M556,15 Q595,-6 639,24 Q662,49 630,79 Q588,97 552,68 Q528,42 556,15 Z" fill="#0a210a"/>
                <path d="M580,-56 Q626,-78 674,-45 Q709,-63 719,-12 Q739,-25 732,28 Q696,61 639,48 Q590,66 568,20 Q548,-7 580,-56 Z" fill="#0b220b"/>
                <path d="M351,-12 Q389,-35 420,-5 Q409,31 377,42 Q341,36 335,7 Q329,-12 351,-12 Z" fill="#0b220b"/>
                <path d="M592,342 Q639,315 692,349 Q730,331 743,382 Q766,369 759,422 Q723,457 666,444 Q616,462 594,415 Q574,384 592,342 Z" fill="#091e09"/>
                <path d="M326,415 Q346,393 379,404 Q400,391 416,419 Q431,408 424,443 Q408,461 374,456 Q344,464 331,439 Q318,428 326,415 Z" fill="#0b220b"/>
                <path d="M193,-55 Q250,-89 320,-46 Q365,-70 384,-7 Q415,-25 408,40 Q360,83 289,66 Q229,90 200,36 Q174,-3 193,-55 Z" fill="#0a210a"/>
                <path d="M725,391 Q758,372 785,395 Q776,422 748,430 Q718,426 714,404 Q710,391 725,391 Z" fill="#091e09"/>
                <path d="M682,412 Q721,391 767,422 Q790,451 752,480 Q709,495 678,465 Q655,439 682,412 Z" fill="#091e09"/>
                <path d="M109,9 Q134,-2 166,20 Q185,34 168,59 Q146,75 114,61 Q93,44 109,9 Z" fill="#091f09"/>
                <path d="M784,219 Q829,193 872,230 Q860,273 823,286 Q779,280 771,247 Q764,225 784,219 Z" fill="#091f09"/>
                <path d="M765,563 Q813,535 866,572 Q895,602 857,638 Q806,659 763,624 Q731,593 765,563 Z" fill="#0a210a"/>
                <path d="M759,41 Q809,14 862,52 Q884,87 845,123 Q796,142 754,109 Q723,76 759,41 Z" fill="#0b220b"/>
                <path d="M-46,33 Q2,6 55,41 Q85,60 63,100 Q27,126 -17,109 Q-51,92 -46,33 Z" fill="#091e09"/>
                <path d="M519,569 Q567,542 612,581 Q600,627 561,640 Q515,633 506,599 Q499,576 519,569 Z" fill="#091f09"/>
                <path d="M441,282 Q474,256 518,275 Q549,251 559,296 Q580,284 575,329 Q544,359 497,348 Q455,362 437,322 Q418,301 441,282 Z" fill="#091f09"/>
                <path d="M680,453 Q730,426 787,463 Q816,494 777,531 Q726,552 682,519 Q651,486 680,453 Z" fill="#0b220b"/>
                <path d="M780,123 Q803,112 833,133 Q851,146 835,170 Q814,184 784,171 Q765,155 780,123 Z" fill="#091e09"/>
                <path d="M223,284 Q285,248 360,294 Q408,268 429,336 Q462,317 455,387 Q404,433 326,415 Q262,440 231,382 Q203,340 223,284 Z" fill="#0b220b"/>
                <path d="M556,383 Q587,374 622,402 Q638,423 614,443 Q579,456 550,431 Q527,411 556,383 Z" fill="#0a210a"/>
                <path d="M645,368 Q686,345 720,373 Q709,408 673,419 Q636,413 630,385 Q625,368 645,368 Z" fill="#0b220b"/>
                <path d="M64,298 Q123,265 191,308 Q236,285 254,348 Q282,331 274,396 Q229,439 157,422 Q97,445 70,389 Q44,351 64,298 Z" fill="#0b220b"/>
                <path d="M64,514 Q112,484 171,520 Q210,501 226,553 Q252,538 246,590 Q204,628 143,612 Q93,634 62,586 Q40,553 64,514 Z" fill="#0a210a"/>
                <path d="M292,420 Q341,393 394,429 Q424,459 385,495 Q336,516 294,484 Q262,452 292,420 Z" fill="#091f09"/>
                <path d="M321,430 Q370,402 416,442 Q403,489 363,504 Q316,496 307,461 Q299,437 321,430 Z" fill="#0b220b"/>
                <path d="M267,433 Q311,409 361,441 Q395,424 408,471 Q428,458 423,506 Q389,538 336,525 Q292,542 271,501 Q252,472 267,433 Z" fill="#091e09"/>
                <path d="M209,1 Q252,-20 297,11 Q330,-6 339,41 Q358,29 351,79 Q318,110 264,98 Q219,114 197,72 Q179,46 209,1 Z" fill="#0a210a"/>
                <path d="M7,546 Q50,521 99,552 Q124,577 95,610 Q56,630 17,605 Q-8,577 7,546 Z" fill="#091e09"/>
                <path d="M293,566 Q327,546 356,573 Q346,606 317,615 Q284,609 279,584 Q273,566 293,566 Z" fill="#0a210a"/>
                <path d="M583,528 Q616,509 652,532 Q673,553 646,577 Q611,591 581,567 Q560,544 583,528 Z" fill="#091e09"/>
                <path d="M12,152 Q53,130 97,160 Q122,187 89,218 Q45,236 8,205 Q-19,177 12,152 Z" fill="#0a210a"/>
                <path d="M581,244 Q624,222 668,253 Q702,236 711,284 Q730,272 723,322 Q690,353 636,341 Q590,357 569,315 Q551,289 581,244 Z" fill="#091f09"/>
                <path d="M550,490 Q597,463 636,500 Q623,545 583,557 Q538,550 530,515 Q523,490 550,490 Z" fill="#091e09"/>
                <path d="M699,480 Q747,454 803,492 Q830,528 785,564 Q731,581 693,546 Q666,513 699,480 Z" fill="#091f09"/>
                <path d="M230,331 Q279,303 326,340 Q314,387 274,406 Q228,401 218,364 Q211,338 230,331 Z" fill="#091e09"/>
                <path d="M215,372 Q267,342 326,380 Q359,401 334,445 Q295,474 246,455 Q208,436 215,372 Z" fill="#091e09"/>
                <path d="M544,149 Q594,121 651,157 Q691,137 705,192 Q730,178 723,235 Q684,273 622,259 Q569,278 546,228 Q524,194 544,149 Z" fill="#0a210a"/>
                <path d="M750,-14 Q799,-41 851,-5 Q880,24 843,60 Q794,81 753,49 Q721,18 750,-14 Z" fill="#091e09"/>
                <path d="M646,191 Q676,169 715,192 Q744,176 753,214 Q771,203 765,243 Q739,270 698,259 Q662,273 644,237 Q628,217 646,191 Z" fill="#091e09"/>
                <path d="M708,276 Q744,255 782,280 Q807,303 775,332 Q737,348 703,321 Q678,296 708,276 Z" fill="#091f09"/>
                <path d="M-21,199 Q21,176 67,207 Q93,232 60,263 Q18,281 -19,254 Q-46,227 -21,199 Z" fill="#091e09"/>
                <path d="M460,124 Q502,98 553,128 Q585,113 597,162 Q580,196 536,187 Q492,202 468,164 Q449,139 460,124 Z" fill="#091e09"/>
                <path d="M710,243 Q755,217 808,248 Q842,233 855,284 Q837,320 790,310 Q744,326 719,286 Q699,259 710,243 Z" fill="#091e09"/>
                <path d="M736,71 Q775,47 819,76 Q841,98 815,128 Q780,146 745,123 Q723,98 736,71 Z" fill="#0b220b"/>
                <path d="M316,-43 Q363,-67 412,-32 Q448,-51 459,1 Q480,-12 472,42 Q435,77 376,63 Q326,81 303,35 Q282,7 316,-43 Z" fill="#0a210a"/>
                <path d="M669,518 Q711,495 759,528 Q784,555 750,587 Q703,607 665,575 Q638,547 669,518 Z" fill="#091f09"/>
                <path d="M329,523 Q385,491 449,532 Q485,555 458,602 Q415,633 363,613 Q322,592 329,523 Z" fill="#091e09"/>
                <path d="M198,214 Q219,191 254,202 Q277,188 294,219 Q310,207 303,244 Q285,263 249,258 Q217,266 203,240 Q189,228 198,214 Z" fill="#091f09"/>
                <path d="M196,601 Q234,578 266,609 Q255,646 222,656 Q185,650 179,621 Q173,601 196,601 Z" fill="#091f09"/>
                <path d="M358,75 Q374,58 401,66 Q418,56 431,79 Q443,70 438,98 Q425,113 397,109 Q373,115 362,95 Q351,86 358,75 Z" fill="#0a210a"/>
                <path d="M193,507 Q233,484 278,512 Q304,538 270,567 Q227,584 191,554 Q165,527 193,507 Z" fill="#091e09"/>
                <path d="M41,360 Q79,338 111,365 Q101,396 67,407 Q32,402 27,375 Q23,360 41,360 Z" fill="#0a210a"/>
                <path d="M482,194 Q519,183 560,216 Q579,241 550,265 Q509,279 475,250 Q448,226 482,194 Z" fill="#0b220b"/>
                <path d="M-5,230 Q31,210 71,235 Q96,258 64,288 Q24,304 -10,277 Q-35,251 -5,230 Z" fill="#091e09"/>
                <path d="M349,86 Q383,64 422,87 Q445,74 455,113 Q439,139 403,133 Q366,145 347,114 Q334,97 349,86 Z" fill="#0a210a"/>
                <path d="M144,74 Q177,69 206,91 Q227,80 236,111 Q250,101 246,134 Q223,156 183,147 Q150,158 136,128 Q121,113 144,74 Z" fill="#091f09"/>
                <path d="M287,176 Q303,159 330,167 Q347,156 360,180 Q372,171 367,199 Q353,213 326,209 Q302,216 291,196 Q281,187 287,176 Z" fill="#0a210a"/>
            </g>
        </symbol>
        <symbol id="stalactite-1" viewBox="0 4 64 60" preserveAspectRatio="none">
            <path fill="currentColor" d="M 18 4 H 46 L 40 18 L 42 28 L 36 40 L 34 52 L 32 62 L 30 52 L 28 40 L 22 28 L 24 18 Z"/>
        </symbol>
        <symbol id="stalactite-2" viewBox="0 4 64 60" preserveAspectRatio="none">
            <path fill="currentColor" d="M 16 4 H 48 L 41 16 L 44 27 L 35 39 L 33 53 L 30 62 L 28 50 L 24 38 L 18 26 L 22 15 Z"/>
        </symbol>
        <symbol id="stalactite-3" viewBox="0 4 64 60" preserveAspectRatio="none">
            <path fill="currentColor" d="M 10 6 H 54 L 48 18 L 52 26 L 44 34 L 46 42 L 38 50 L 40 58 L 32 62 L 24 58 L 26 50 L 18 42 L 20 34 L 12 26 L 16 18 Z"/>
        </symbol>
        <symbol id="stalagmite-1" viewBox="0 0 64 62" preserveAspectRatio="none">
            <path fill="currentColor" d="M 12 62 H 52 L 47 45 L 50 31 L 39 19 L 35 7 L 29 3 L 25 12 L 20 23 L 15 37 L 18 48 Z"/>
        </symbol>
        <symbol id="stalagmite-2" viewBox="0 0 64 62" preserveAspectRatio="none">
            <path fill="currentColor" d="M 10 62 H 54 L 46 44 L 48 32 L 40 18 L 36 8 L 32 2 L 28 8 L 24 18 L 16 32 L 18 44 Z"/>
        </symbol>
        <symbol id="stalagmite-3" viewBox="0 0 64 62" preserveAspectRatio="none">
            <path fill="currentColor" d="M 32 2 L 40 6 L 38 14 L 46 22 L 44 30 L 52 38 L 48 46 L 54 58 H 10 L 16 46 L 12 38 L 20 30 L 18 22 L 26 14 L 24 6 Z"/>
        </symbol>
        <symbol id="caves-background" viewBox="0 0 800 600" preserveAspectRatio="none">
            <defs>
                <filter id="caves-blur" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="5"/>
                </filter>
                <filter id="caves-blur2" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="8"/>
                </filter>
                <linearGradient id="caves-topFade" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" stop-color="white" stop-opacity="0"/>
                    <stop offset="20%" stop-color="white" stop-opacity="1"/>
                </linearGradient>
                <mask id="caves-fadeMask">
                    <rect width="800" height="600" fill="url(#caves-topFade)"/>
                </mask>
            </defs>
            <!-- Background -->
            <rect width="800" height="600" fill="#06080c"/>
            <!-- Pillars - far back, very blurry -->
            <g filter="url(#caves-blur2)" mask="url(#caves-fadeMask)">
                <path d="M 17.5 0 Q 27.5 150 22.5 300 Q 32.5 450 25 600 L 47.5 600 Q 40 420 50 200 Q 37.5 60 45 0 Z" fill="#0c0e14"/>
                <path d="M 417.5 0 Q 427.5 150 422.5 300 Q 432.5 450 425 600 L 447.5 600 Q 440 420 450 200 Q 437.5 60 445 0 Z" fill="#0c0e14"/>
                <path d="M 82.5 0 Q 95 200 87.5 400 Q 100 530 92.5 600 L 120 600 Q 110 400 122.5 170 Q 102.5 40 115 0 Z" fill="#0a0c12"/>
                <path d="M 482.5 0 Q 495 200 487.5 400 Q 500 530 492.5 600 L 520 600 Q 510 400 522.5 170 Q 502.5 40 515 0 Z" fill="#0a0c12"/>
                <path d="M 167.5 0 Q 182.5 180 175 360 Q 190 500 180 600 L 212.5 600 Q 200 420 215 190 Q 190 50 207.5 0 Z" fill="#0c0e14"/>
                <path d="M 567.5 0 Q 582.5 180 575 360 Q 590 500 580 600 L 612.5 600 Q 600 420 615 190 Q 590 50 607.5 0 Z" fill="#0c0e14"/>
                <path d="M 252.5 0 Q 270 210 260 410 Q 275 530 267.5 600 L 297.5 600 Q 285 400 302.5 180 Q 277.5 40 295 0 Z" fill="#0a0c12"/>
                <path d="M 652.5 0 Q 670 210 660 410 Q 675 530 667.5 600 L 697.5 600 Q 685 400 702.5 180 Q 677.5 40 695 0 Z" fill="#0a0c12"/>
                <path d="M 332.5 0 Q 350 190 340 380 Q 357.5 510 347.5 600 L 382.5 600 Q 370 410 387.5 190 Q 360 55 377.5 0 Z" fill="#0c0e14"/>
                <path d="M 732.5 0 Q 750 190 740 380 Q 757.5 510 747.5 600 L 782.5 600 Q 770 410 787.5 190 Q 760 55 777.5 0 Z" fill="#0c0e14"/>
            </g>
            <!-- Stalactites - from ceiling -->
            <g filter="url(#caves-blur)" mask="url(#caves-fadeMask)">
                <path d="M 10 -10 Q 20 40 15 100 Q 25 150 19 200 L 27.5 200 Q 35 140 29 75 Q 39 25 32.5 -10 Z" fill="#14100c"/>
                <path d="M 410 -10 Q 420 40 415 100 Q 425 150 419 200 L 427.5 200 Q 435 140 429 75 Q 439 25 432.5 -10 Z" fill="#14100c"/>
                <path d="M 42.5 -10 Q 54 60 47.5 150 L 59 150 Q 69 75 62.5 -10 Z" fill="#0e1016"/>
                <path d="M 442.5 -10 Q 454 60 447.5 150 L 459 150 Q 469 75 462.5 -10 Z" fill="#0e1016"/>
                <path d="M 77.5 -10 Q 89 55 82.5 125 Q 95 175 87.5 220 L 99 220 Q 109 160 102.5 90 Q 114 35 107.5 -10 Z" fill="#14100c"/>
                <path d="M 477.5 -10 Q 489 55 482.5 125 Q 495 175 487.5 220 L 499 220 Q 509 160 502.5 90 Q 514 35 507.5 -10 Z" fill="#14100c"/>
                <path d="M 115 -10 Q 127.5 70 121 160 L 134 160 Q 145 85 139 -10 Z" fill="#100c0a"/>
                <path d="M 515 -10 Q 527.5 70 521 160 L 534 160 Q 545 85 539 -10 Z" fill="#100c0a"/>
                <path d="M 155 -10 Q 169 90 160 190 Q 175 235 166 280 L 179 280 Q 190 215 182.5 130 Q 195 50 187.5 -10 Z" fill="#0e1016"/>
                <path d="M 555 -10 Q 569 90 560 190 Q 575 235 566 280 L 579 280 Q 590 215 582.5 130 Q 595 50 587.5 -10 Z" fill="#0e1016"/>
                <path d="M 200 -10 Q 212.5 60 206 140 L 219 140 Q 230 70 224 -10 Z" fill="#14100c"/>
                <path d="M 600 -10 Q 612.5 60 606 140 L 619 140 Q 630 70 624 -10 Z" fill="#14100c"/>
                <path d="M 237.5 -10 Q 252.5 80 245 175 Q 261 220 252.5 265 L 266 265 Q 277.5 200 271 115 Q 285 40 277.5 -10 Z" fill="#100c0a"/>
                <path d="M 637.5 -10 Q 652.5 80 645 175 Q 661 220 652.5 265 L 666 265 Q 677.5 200 671 115 Q 685 40 677.5 -10 Z" fill="#100c0a"/>
                <path d="M 280 -10 Q 292.5 50 286 115 L 299 115 Q 310 60 304 -10 Z" fill="#0e1016"/>
                <path d="M 680 -10 Q 692.5 50 686 115 L 699 115 Q 710 60 704 -10 Z" fill="#0e1016"/>
                <path d="M 315 -10 Q 331 100 322.5 200 L 337.5 200 Q 351 110 344 -10 Z" fill="#14100c"/>
                <path d="M 715 -10 Q 731 100 722.5 200 L 737.5 200 Q 751 110 744 -10 Z" fill="#14100c"/>
                <path d="M 355 -10 Q 371 75 362.5 170 Q 379 215 371 260 L 386 260 Q 399 195 391 105 Q 406 40 399 -10 Z" fill="#100c0a"/>
                <path d="M 755 -10 Q 771 75 762.5 170 Q 779 215 771 260 L 786 260 Q 799 195 791 105 Q 806 40 799 -10 Z" fill="#100c0a"/>
                <path d="M 26 -5 Q 32.5 35 30 80 L 37.5 80 Q 42.5 42 40 -5 Z" fill="#0d0f15"/>
                <path d="M 426 -5 Q 432.5 35 430 80 L 437.5 80 Q 442.5 42 440 -5 Z" fill="#0d0f15"/>
                <path d="M 62.5 -5 Q 70 32 67.5 78 L 76 78 Q 82.5 40 79 -5 Z" fill="#12100b"/>
                <path d="M 462.5 -5 Q 470 32 467.5 78 L 476 78 Q 482.5 40 479 -5 Z" fill="#12100b"/>
                <path d="M 97.5 -5 Q 106 42 102.5 98 L 112.5 98 Q 120 50 116 -5 Z" fill="#0d0f15"/>
                <path d="M 497.5 -5 Q 506 42 502.5 98 L 512.5 98 Q 520 50 516 -5 Z" fill="#0d0f15"/>
                <path d="M 135 -5 Q 144 48 140 105 L 151 105 Q 159 58 155 -5 Z" fill="#12100b"/>
                <path d="M 535 -5 Q 544 48 540 105 L 551 105 Q 559 58 555 -5 Z" fill="#12100b"/>
                <path d="M 177.5 -5 Q 186 38 182.5 85 L 192.5 85 Q 200 45 196 -5 Z" fill="#0d0f15"/>
                <path d="M 577.5 -5 Q 586 38 582.5 85 L 592.5 85 Q 600 45 596 -5 Z" fill="#0d0f15"/>
                <path d="M 220 -5 Q 229 52 225 115 L 237.5 115 Q 246 62 242.5 -5 Z" fill="#12100b"/>
                <path d="M 620 -5 Q 629 52 625 115 L 637.5 115 Q 646 62 642.5 -5 Z" fill="#12100b"/>
                <path d="M 262.5 -5 Q 271 35 267.5 75 L 277.5 75 Q 285 42 281 -5 Z" fill="#0d0f15"/>
                <path d="M 662.5 -5 Q 671 35 667.5 75 L 677.5 75 Q 685 42 681 -5 Z" fill="#0d0f15"/>
                <path d="M 300 -5 Q 310 48 306 105 L 319 105 Q 327.5 55 324 -5 Z" fill="#12100b"/>
                <path d="M 700 -5 Q 710 48 706 105 L 719 105 Q 727.5 55 724 -5 Z" fill="#12100b"/>
                <path d="M 340 -5 Q 349 38 346 88 L 357.5 88 Q 365 48 361 -5 Z" fill="#0d0f15"/>
                <path d="M 740 -5 Q 749 38 746 88 L 757.5 88 Q 765 48 761 -5 Z" fill="#0d0f15"/>
                <path d="M 380 -5 Q 390 45 386 100 L 399 100 Q 407.5 55 404 -5 Z" fill="#12100b"/>
                <path d="M 780 -5 Q 790 45 786 100 L 799 100 Q 807.5 55 804 -5 Z" fill="#12100b"/>
            </g>
            <!-- Stalagmites - from floor -->
            <g filter="url(#caves-blur)">
                <path d="M 5 610 Q 16 540 11 455 Q 24 385 17.5 320 L 30 320 Q 39 405 32.5 490 Q 46 560 37.5 610 Z" fill="#14100c"/>
                <path d="M 405 610 Q 416 540 411 455 Q 424 385 417.5 320 L 430 320 Q 439 405 432.5 490 Q 446 560 437.5 610 Z" fill="#14100c"/>
                <path d="M 45 610 Q 59 530 52.5 425 L 66 425 Q 77.5 520 74 610 Z" fill="#0e1016"/>
                <path d="M 445 610 Q 459 530 452.5 425 L 466 425 Q 477.5 520 474 610 Z" fill="#0e1016"/>
                <path d="M 82.5 610 Q 97.5 515 90 400 Q 106 330 99 265 L 114 265 Q 127.5 360 119 470 Q 137.5 550 127.5 610 Z" fill="#100c0a"/>
                <path d="M 482.5 610 Q 497.5 515 490 400 Q 506 330 499 265 L 514 265 Q 527.5 360 519 470 Q 537.5 550 527.5 610 Z" fill="#100c0a"/>
                <path d="M 135 610 Q 149 540 142.5 445 L 159 445 Q 171 530 167.5 610 Z" fill="#14100c"/>
                <path d="M 535 610 Q 549 540 542.5 445 L 559 445 Q 571 530 567.5 610 Z" fill="#14100c"/>
                <path d="M 180 610 Q 197.5 505 189 380 Q 207.5 300 197.5 230 L 215 230 Q 231 335 222.5 450 Q 242.5 540 231 610 Z" fill="#0e1016"/>
                <path d="M 580 610 Q 597.5 505 589 380 Q 607.5 300 597.5 230 L 615 230 Q 631 335 622.5 450 Q 642.5 540 631 610 Z" fill="#0e1016"/>
                <path d="M 240 610 Q 256 525 249 420 L 266 420 Q 279 520 275 610 Z" fill="#100c0a"/>
                <path d="M 640 610 Q 656 525 649 420 L 666 420 Q 679 520 675 610 Z" fill="#100c0a"/>
                <path d="M 285 610 Q 304 515 295 390 Q 314 315 304 250 L 322.5 250 Q 341 350 331 465 Q 352.5 550 340 610 Z" fill="#14100c"/>
                <path d="M 685 610 Q 704 515 695 390 Q 714 315 704 250 L 722.5 250 Q 741 350 731 465 Q 752.5 550 740 610 Z" fill="#14100c"/>
                <path d="M 345 610 Q 362.5 535 356 440 L 375 440 Q 389 530 385 610 Z" fill="#0e1016"/>
                <path d="M 745 610 Q 762.5 535 756 440 L 775 440 Q 789 530 785 610 Z" fill="#0e1016"/>
                <path d="M 385 610 Q 401 515 394 400 L 411 400 Q 425 510 421 610 Z" fill="#100c0a"/>
                <path d="M 785 610 Q 801 515 794 400 L 811 400 Q 825 510 821 610 Z" fill="#100c0a"/>
                <path d="M 24 610 Q 32.5 568 29 512 L 39 512 Q 46 565 42.5 610 Z" fill="#0d0f15"/>
                <path d="M 424 610 Q 432.5 568 429 512 L 439 512 Q 446 565 442.5 610 Z" fill="#0d0f15"/>
                <path d="M 69 610 Q 79 555 75 490 L 86 490 Q 95 552 91 610 Z" fill="#12100b"/>
                <path d="M 469 610 Q 479 555 475 490 L 486 490 Q 495 552 491 610 Z" fill="#12100b"/>
                <path d="M 117.5 610 Q 127.5 560 124 500 L 136 500 Q 145 558 141 610 Z" fill="#0d0f15"/>
                <path d="M 517.5 610 Q 527.5 560 524 500 L 536 500 Q 545 558 541 610 Z" fill="#0d0f15"/>
                <path d="M 162.5 610 Q 174 550 170 475 L 182.5 475 Q 192.5 545 189 610 Z" fill="#12100b"/>
                <path d="M 562.5 610 Q 574 550 570 475 L 582.5 475 Q 592.5 545 589 610 Z" fill="#12100b"/>
                <path d="M 212.5 610 Q 224 565 220 502 L 232.5 502 Q 242.5 560 239 610 Z" fill="#0d0f15"/>
                <path d="M 612.5 610 Q 624 565 620 502 L 632.5 502 Q 642.5 560 639 610 Z" fill="#0d0f15"/>
                <path d="M 270 610 Q 282.5 545 277.5 470 L 291 470 Q 302.5 542 299 610 Z" fill="#12100b"/>
                <path d="M 670 610 Q 682.5 545 677.5 470 L 691 470 Q 702.5 542 699 610 Z" fill="#12100b"/>
                <path d="M 315 610 Q 326 565 322.5 510 L 336 510 Q 346 562 342.5 610 Z" fill="#0d0f15"/>
                <path d="M 715 610 Q 726 565 722.5 510 L 736 510 Q 746 562 742.5 610 Z" fill="#0d0f15"/>
                <path d="M 372.5 610 Q 384 550 380 480 L 395 480 Q 406 548 402.5 610 Z" fill="#12100b"/>
                <path d="M 772.5 610 Q 784 550 780 480 L 795 480 Q 806 548 802.5 610 Z" fill="#12100b"/>
            </g>
            <rect x="0" y="0" width="100%" height="100%" fill="white" opacity="0.08"/>
        </symbol>
        <symbol id="tree" viewBox="-26 0 92 110">
            <!-- Foliage - overlapping circles (drawn first, behind trunk/branches) -->
            <circle fill="#2d5a2d" cx="-10" cy="38" r="16"/>
            <circle fill="#3a7a3a" cx="4" cy="30" r="18"/>
            <circle fill="#2d5a2d" cx="20" cy="24" r="20"/>
            <circle fill="#3a7a3a" cx="41" cy="25" r="18"/>
            <circle fill="#2d5a2d" cx="55" cy="33" r="16"/>
            <circle fill="#4a9a4a" cx="-4" cy="46" r="14"/>
            <circle fill="#3a7a3a" cx="16" cy="38" r="16"/>
            <circle fill="#4a9a4a" cx="40" cy="46" r="14"/>
            <circle fill="#3a7a3a" cx="8" cy="54" r="12"/>
            <circle fill="#4a9a4a" cx="28" cy="54" r="12"/>
            <!-- Trunk and main branches as one continuous shape -->
            <path fill="#6b4423" d="M 14,110 L 14,54 L 12,45 L -18,35 L -18,34 L 14,40 L 20,45 L 26,38 L 58,28 L 58,29 L 20,48 L 26,48 L 26,110 Z"/>
            <!-- Left side shading -->
            <path fill="#5d3a1a" d="M 14,110 L 14,54 L 12,45 L -18,35 L -18,34 L 14,40 L 14,110 Z"/>
            <!-- Right side highlight -->
            <path fill="#8b5a2b" d="M 26,110 L 26,48 L 28,40 L 58,29 L 58,28 L 26,46 L 20,42 L 14,40 L 26,110 Z"/>
            <!-- Left twig -->
            <path fill="#5d3a1a" d="M -6,40 L -4,38 L -2,28 L -5,28 L -8,38 Z"/>
            <!-- Right twig -->
            <path fill="#6b4423" d="M 46,36 L 44,34 L 42,24 L 45,24 L 48,34 Z"/>
        </symbol>
        <symbol id="gem" viewBox="0 0 512 512">
            <path fill="currentColor" d="M 168.5 72 l 87.5 93 87.5 -93 -175 0 z M 383.9 99.1 l -72.3 76.9 129 0 -56.6 -76.9 z m 50 124.9 L 78.1 224 256 420.3 433.9 224 z M 71.5 176 l 129 0 -72.3 -76.9 -56.6 76.9 z m 434.3 40.1 l -232 256 c -4.5 5 -11 7.9 -17.8 7.9 s -13.2 -2.9 -17.8 -7.9 l -232 -256 c -7.7 -8.5 -8.3 -21.2 -1.5 -30.4 l 112 -152 c 4.5 -6.1 11.7 -9.8 19.3 -9.8 l 240 0 c 7.6 0 14.8 3.6 19.3 9.8 l 112 152 c 6.8 9.2 6.1 21.9 -1.5 30.4 z"/>
        </symbol>
        <symbol id="bolt" viewBox="0 0 448 512">
            <path fill="currentColor" d="M 338.8 -9.9 c 11.9 8.6 16.3 24.2 10.9 37.8 L 271.3 224 416 224 c 13.5 0 25.5 8.4 30.1 21.1 s .7 26.9 -9.6 35.5 l -288 240 c -11.3 9.4 -27.4 9.9 -39.3 1.3 s -16.3 -24.2 -10.9 -37.8 L 176.7 288 32 288 c -13.5 0 -25.5 -8.4 -30.1 -21.1 s -.7 -26.9 9.6 -35.5 l 288 -240 c 11.3 -9.4 27.4 -9.9 39.3 -1.3 z"/>
        </symbol>
    </svg>

    <!-- Debug toggle: Alt+D (Windows/Linux) or Ctrl+Alt+D (Mac) -->
    <input type="checkbox" id="debug-toggle" accesskey="d">

    <!-- Title screen toggle -->
    <input type="checkbox" id="title-screen-toggle">

    <div class="game-container">
        <h2>NIBO'S WAY OUT</h2>

        <!-- Radio buttons for level (vertical) -->
        <input type="radio" name="level" id="level-0" class="level-radio" title="level-0" checked>
        <input type="radio" name="level" id="level-1" class="level-radio" title="level-1">
        <input type="radio" name="level" id="level-2" class="level-radio" title="level-2">
        <input type="radio" name="level" id="level-3" class="level-radio" title="level-3">
        <input type="radio" name="level" id="level-4" class="level-radio" title="level-4">
        <!-- Levels 5-9 for S2/S3 (display at same heights as 0-4) -->
        <input type="radio" name="level" id="level-5" class="level-radio" title="level-5">
        <input type="radio" name="level" id="level-6" class="level-radio" title="level-6">
        <input type="radio" name="level" id="level-7" class="level-radio" title="level-7">
        <input type="radio" name="level" id="level-8" class="level-radio" title="level-8">
        <input type="radio" name="level" id="level-9" class="level-radio" title="level-9">

        <!-- Radio buttons for position (horizontal) -->
        <input type="radio" name="position" id="pos-1" class="position-radio" title="pos-1" checked>
        <input type="radio" name="position" id="pos-2" class="position-radio" title="pos-2">
        <input type="radio" name="position" id="pos-3" class="position-radio" title="pos-3">
        <input type="radio" name="position" id="pos-4" class="position-radio" title="pos-4">
        <input type="radio" name="position" id="pos-5" class="position-radio" title="pos-5">
        <input type="radio" name="position" id="pos-6" class="position-radio" title="pos-6">
        <!-- S2/S4 positions (same horizontal space, S4 at levels 0-4, S2 at levels 5-9) -->
        <input type="radio" name="position" id="pos-7" class="position-radio" title="pos-7">
        <input type="radio" name="position" id="pos-8" class="position-radio" title="pos-8">
        <input type="radio" name="position" id="pos-9" class="position-radio" title="pos-9">
        <input type="radio" name="position" id="pos-10" class="position-radio" title="pos-10">
        <input type="radio" name="position" id="pos-11" class="position-radio" title="pos-11">
        <input type="radio" name="position" id="pos-12" class="position-radio" title="pos-12">
        <!-- S3 positions -->
        <input type="radio" name="position" id="pos-13" class="position-radio" title="pos-13">
        <input type="radio" name="position" id="pos-14" class="position-radio" title="pos-14">
        <input type="radio" name="position" id="pos-15" class="position-radio" title="pos-15">
        <input type="radio" name="position" id="pos-16" class="position-radio" title="pos-16">
        <input type="radio" name="position" id="pos-17" class="position-radio" title="pos-17">
        <input type="radio" name="position" id="pos-18" class="position-radio" title="pos-18">
        <input type="radio" name="position" id="pos-φ" class="position-radio" title="pos-φ">

        <!-- Key pickup checkbox -->
        <input type="checkbox" id="key-pickup" class="key-checkbox" title="key">

        <!-- Safe unlock checkbox -->
        <input type="checkbox" id="toolbox-unlocked" class="toolbox-checkbox" title="toolbox">

        <!-- Wrench pickup checkbox -->
        <input type="checkbox" id="wrench-pickup" class="wrench-checkbox" title="wrench">

        <!-- ID card pickup checkbox -->
        <input type="checkbox" id="idcard-pickup" class="idcard-checkbox" title="idcard">

        <!-- Stage 3 item pickups -->
        <input type="checkbox" id="axe-pickup" class="axe-checkbox" title="axe">
        <input type="checkbox" id="battery-pickup" class="battery-checkbox" title="battery">
        <input type="checkbox" id="torch-pickup" class="torch-checkbox" title="torch">

        <!-- Bolt fixed checkbox -->
        <input type="checkbox" id="bolt-fixed" class="battery-checkbox" title="bolt">

        <!-- Control button pressed checkbox -->
        <input type="checkbox" id="flight-controls-used" class="flight-controls-checkbox" title="flight-controls">

        <!-- Sprout unlock checkbox -->
        <input type="checkbox" id="tree-chopped" class="tree-checkbox" title="tree">

        <!-- Escaped checkbox -->
        <input type="checkbox" id="escaped" class="escaped-checkbox" title="escaped">

        <!-- darkness toggle -->
        <input type="checkbox" id="darkness-toggle" class="darkness-checkbox" title="darkness">

        <!-- Door open checkbox -->
        <input type="checkbox" id="door-unlocked" class="door-checkbox" title="door">

        <!-- loot pickup checkboxes -->
        <input type="checkbox" id="loot-S1-L0-P3-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S1-L1-P4-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S1-L3-P5-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S1-L2-P1-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S1-L4-P2-pickup" class="loot-checkbox" title="coin">
        <!-- Stage 2 loot pickup checkboxes -->
        <input type="checkbox" id="loot-S2-L5-P8-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S2-L6-P11-pickup" class="loot-checkbox" title="aquamarine">
        <input type="checkbox" id="loot-S2-L7-P7-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S2-L8-P9-pickup" class="loot-checkbox" title="aquamarine">
        <input type="checkbox" id="loot-S2-L9-P10-pickup" class="loot-checkbox" title="coin">
        <!-- Stage 3 loot -->
        <input type="checkbox" id="loot-S3-L5-P18-pickup" class="loot-checkbox" title="ruby">
        <input type="checkbox" id="loot-S3-L5-P15-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S3-L8-P18-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S3-L9-P14-pickup" class="loot-checkbox" title="coin">
        <!-- Stage 4 loot -->
        <input type="checkbox" id="loot-S4-L3-P7-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S4-L3-P8-pickup" class="loot-checkbox" title="aquamarine">
        <input type="checkbox" id="loot-S4-L3-P12-pickup" class="loot-checkbox" title="coin">
        <input type="checkbox" id="loot-S4-L1-P10-pickup" class="loot-checkbox" title="aquamarine">
        <input type="checkbox" id="loot-S4-L0-P9-pickup" class="loot-checkbox" title="coin">

        <div class="subtitle subtitle-S1">The Factory</div>
        <div class="subtitle subtitle-S2">The Jungle</div>
        <div class="subtitle subtitle-S3">The Hangar</div>
        <div class="subtitle subtitle-S4">The Caves</div>

        <!-- Fixed navigation panel -->
        <div class="nav-panel">
            <!-- Up cell -->
            <div class="nav-cell nav-cell-up">
                <label for="level-1" class="nav-btn nav-up"></label>
                <label for="level-2" class="nav-btn nav-up"></label>
                <label for="level-3" class="nav-btn nav-up"></label>
                <label for="level-4" class="nav-btn nav-up"></label>
                <!-- S2/S3 levels (5-9) -->
                <label for="level-5" class="nav-btn nav-up"></label>
                <label for="level-6" class="nav-btn nav-up"></label>
                <label for="level-7" class="nav-btn nav-up"></label>
                <label for="level-8" class="nav-btn nav-up"></label>
                <label for="level-9" class="nav-btn nav-up"></label>
                <label for="pos-φ" class="nav-btn nav-up"></label>
            </div>
            <!-- Left cell -->
            <div class="nav-cell nav-cell-left">
                <label for="pos-1" class="nav-btn nav-left"></label>
                <label for="pos-2" class="nav-btn nav-left"></label>
                <label for="pos-3" class="nav-btn nav-left"></label>
                <label for="pos-4" class="nav-btn nav-left"></label>
                <label for="pos-5" class="nav-btn nav-left"></label>
                <!-- Stage 2 -->
                <label for="pos-6" class="nav-btn nav-left"></label>
                <label for="pos-7" class="nav-btn nav-left"></label>
                <label for="pos-8" class="nav-btn nav-left"></label>
                <label for="pos-9" class="nav-btn nav-left"></label>
                <label for="pos-10" class="nav-btn nav-left"></label>
                <label for="pos-11" class="nav-btn nav-left"></label>
                <!-- Stage 3 -->
                <label for="pos-12" class="nav-btn nav-left"></label>
                <label for="pos-13" class="nav-btn nav-left"></label>
                <label for="pos-14" class="nav-btn nav-left"></label>
                <label for="pos-15" class="nav-btn nav-left"></label>
                <label for="pos-16" class="nav-btn nav-left"></label>
                <label for="pos-17" class="nav-btn nav-left"></label>
            </div>
            <!-- Right cell -->
            <div class="nav-cell nav-cell-right">
                <label for="pos-2" class="nav-btn nav-right"></label>
                <label for="pos-3" class="nav-btn nav-right"></label>
                <label for="pos-4" class="nav-btn nav-right"></label>
                <label for="pos-5" class="nav-btn nav-right"></label>
                <label for="pos-6" class="nav-btn nav-right"></label>
                <!-- Stage 2 -->
                <label for="pos-7" class="nav-btn nav-right"></label>
                <label for="pos-8" class="nav-btn nav-right"></label>
                <label for="pos-9" class="nav-btn nav-right"></label>
                <label for="pos-10" class="nav-btn nav-right"></label>
                <label for="pos-11" class="nav-btn nav-right"></label>
                <label for="pos-12" class="nav-btn nav-right"></label>
                <label for="pos-13" class="nav-btn nav-right"></label>
                <label for="pos-14" class="nav-btn nav-right"></label>
                <label for="pos-15" class="nav-btn nav-right"></label>
                <label for="pos-16" class="nav-btn nav-right"></label>
                <label for="pos-17" class="nav-btn nav-right"></label>
                <label for="pos-18" class="nav-btn nav-right"></label>
            </div>
            <!-- Down cell -->
            <div class="nav-cell nav-cell-down">
                <label for="level-0" class="nav-btn nav-down"></label>
                <label for="level-1" class="nav-btn nav-down"></label>
                <label for="level-2" class="nav-btn nav-down"></label>
                <label for="level-3" class="nav-btn nav-down"></label>
                <label for="level-4" class="nav-btn nav-down"></label>
                <!-- S2/S3 levels (5-9) -->
                <label for="level-5" class="nav-btn nav-down"></label>
                <label for="level-6" class="nav-btn nav-down"></label>
                <label for="level-7" class="nav-btn nav-down"></label>
                <label for="level-8" class="nav-btn nav-down"></label>
            </div>
        </div>

        <!-- Inventory -->
        <div class="inv-panel">
            <span class="inventory-key"><svg><use href="#key"/></svg></span>
            <span class="inventory-wrench"><svg><use href="#wrench"/></svg></span>
            <span class="inventory-axe"><svg><use href="#axe"/></svg></span>
            <span class="inventory-idcard"><svg><use href="#id-card"/></svg></span>
            <span class="inventory-battery"><svg><use href="#battery"/></svg></span>
            <span class="inventory-torch"><svg><use href="#torch"/></svg></span>
        </div>

        <!-- loot counter -->
        <div class="counter-panel">
            <svg class="loot-icon"><use href="#coin"/></svg>
            <div class="digit-container">
                <div class="digit-strip">
                    <div class="digit">0</div>
                    <div class="digit">1</div>
                    <div class="digit">2</div>
                    <div class="digit">3</div>
                    <div class="digit">4</div>
                    <div class="digit">5</div>
                    <div class="digit">6</div>
                    <div class="digit">7</div>
                    <div class="digit">8</div>
                    <div class="digit">9</div>
                    <div class="digit">10</div>
                    <div class="digit">11</div>
                    <div class="digit">12</div>
                    <div class="digit">13</div>
                    <div class="digit">14</div>
                    <div class="digit">15</div>
                    <div class="digit">16</div>
                    <div class="digit">17</div>
                    <div class="digit">18</div>
                    <div class="digit">19</div>
                    <div class="digit">20</div>
                    <div class="digit">21</div>
                    <div class="digit">22</div>
                    <div class="digit">23</div>
                    <div class="digit">24</div>
                    <div class="digit">25</div>
                    <div class="digit">26</div>
                    <div class="digit">27</div>
                    <div class="digit">28</div>
                </div>
            </div>
        </div>

        <!-- Game world (scrollable content) -->
        <div class="game-world">

        <!-- Key in game world (clickable to pick up) -->
        <span class="key-hover-area"></span>
        <label for="key-pickup" class="key-in-game"><svg><use href="#key"/></svg></label>
        <span class="tooltip key-tooltip">Key</span>

        <!-- Toolbox on level 2, position 6 -->
        <div class="toolbox">
            <span class="tooltip toolbox-tooltip">A locked toolbox.<br>You need a key.</span>
            <svg><use href="#toolbox"/></svg>
        </div>

        <!-- Axe on stage 3, level 4, pos φ (clickable to pick up) -->
        <span class="axe-hover-area"></span>
        <label for="axe-pickup" class="axe-in-game"><svg><use href="#axe"/></svg></label>
        <span class="tooltip axe-tooltip">Axe</span>

        <!-- ID card on stage 2, level 4, pos 6 (clickable to pick up) -->
        <div class="stage-2-elements">
            <span class="idcard-hover-area"></span>
            <label for="idcard-pickup" class="idcard-in-game"><svg><use href="#id-card"/></svg></label>
            <span class="tooltip idcard-tooltip">ID Card</span>
        </div>

        <!-- Battery on stage 3, level 2, pos 1 (clickable to pick up) -->
        <span class="battery-hover-area"></span>
        <label for="battery-pickup" class="battery-in-game"><svg><use href="#battery"/></svg></label>
        <span class="tooltip battery-tooltip">Battery</span>

        <!-- Torch on stage 4, level 0, pos 12 (clickable to pick up) -->
        <span class="torch-hover-area"></span>
        <label for="torch-pickup" class="torch-in-game"><svg><use href="#torch"/></svg></label>
        <span class="tooltip torch-tooltip">Torch</span>

        <!-- Wrench in game world (clickable to pick up) -->
        <span class="wrench-hover-area"></span>
        <label for="wrench-pickup" class="wrench-in-game"><svg><use href="#wrench"/></svg></label>
        <span class="tooltip wrench-tooltip">Wrench</span>

        <!-- Key above toolbox (appears when user has key, clickable to unlock) -->
        <label for="toolbox-unlocked" class="key-at-toolbox"><svg><use href="#key"/></svg></label>


        <!-- Horizontal arrow labels -->
        <label for="pos-2" class="arrow arrow-right arrow-h arrow-S1-P1-P2"></label>
        <label for="pos-1" class="arrow arrow-left arrow-h arrow-S1-P2-P1"></label>
        <label for="pos-3" class="arrow arrow-right arrow-h arrow-S1-P2-P3"></label>
        <label for="pos-2" class="arrow arrow-left arrow-h arrow-S1-P3-P2"></label>
        <label for="pos-4" class="arrow arrow-right arrow-h arrow-S1-P3-P4"></label>
        <label for="pos-3" class="arrow arrow-left arrow-h arrow-S1-P4-P3"></label>
        <label for="pos-5" class="arrow arrow-right arrow-h arrow-S1-P4-P5"></label>
        <label for="pos-4" class="arrow arrow-left arrow-h arrow-S1-P5-P4"></label>
        <label for="pos-6" class="arrow arrow-right arrow-h arrow-S1-P5-P6"></label>
        <label for="pos-5" class="arrow arrow-left arrow-h arrow-S1-P6-P5"></label>
        <label for="pos-7" class="arrow arrow-right arrow-h arrow-S1-P6-S2-P7"></label>

        <!-- Stage 2 horizontal arrow labels -->
        <label for="pos-6" class="arrow arrow-left arrow-h arrow-S2-P7-S1-P6"></label>
        <label for="pos-8" class="arrow arrow-right arrow-h arrow-S2-P7-P8"></label>
        <label for="pos-7" class="arrow arrow-left arrow-h arrow-S2-P8-P7"></label>
        <label for="pos-9" class="arrow arrow-right arrow-h arrow-S2-P8-P9"></label>
        <label for="pos-8" class="arrow arrow-left arrow-h arrow-S2-P9-P8"></label>
        <label for="pos-10" class="arrow arrow-right arrow-h arrow-S2-P9-P10"></label>
        <label for="pos-9" class="arrow arrow-left arrow-h arrow-S2-P10-P9"></label>
        <label for="pos-11" class="arrow arrow-right arrow-h arrow-S2-P10-P11"></label>
        <label for="pos-10" class="arrow arrow-left arrow-h arrow-S2-P11-P10"></label>
        <label for="pos-12" class="arrow arrow-right arrow-h arrow-S2-P11-P12"></label>
        <label for="pos-11" class="arrow arrow-left arrow-h arrow-S2-P12-P11"></label>
        <!-- Stage 2 to Stage 3 arrows -->
        <label for="pos-13" class="arrow arrow-right arrow-h arrow-S2-P12-S3-P13"></label>
        <label for="pos-12" class="arrow arrow-left arrow-h arrow-S3-P13-S2-P12"></label>
        <!-- Stage 3 horizontal arrows -->
        <label for="pos-14" class="arrow arrow-right arrow-h arrow-S3-P13-P14"></label>
        <label for="pos-13" class="arrow arrow-left arrow-h arrow-S3-P14-P13"></label>
        <label for="pos-15" class="arrow arrow-right arrow-h arrow-S3-P14-P15"></label>
        <label for="pos-14" class="arrow arrow-left arrow-h arrow-S3-P15-P14"></label>
        <label for="pos-16" class="arrow arrow-right arrow-h arrow-S3-P15-P16"></label>
        <label for="pos-15" class="arrow arrow-left arrow-h arrow-S3-P16-P15"></label>
        <label for="pos-17" class="arrow arrow-right arrow-h arrow-S3-P16-P17"></label>
        <label for="pos-16" class="arrow arrow-left arrow-h arrow-S3-P17-P16"></label>
        <label for="pos-18" class="arrow arrow-right arrow-h arrow-S3-P17-P18"></label>
        <label for="pos-17" class="arrow arrow-left arrow-h arrow-S3-P18-P17"></label>

        <!-- Stage 4 horizontal arrows -->
        <label for="pos-8" class="arrow arrow-right arrow-h arrow-S4-P7-P8"></label>
        <label for="pos-7" class="arrow arrow-left arrow-h arrow-S4-P8-P7"></label>
        <label for="pos-9" class="arrow arrow-right arrow-h arrow-S4-P8-P9"></label>
        <label for="pos-8" class="arrow arrow-left arrow-h arrow-S4-P9-P8"></label>
        <label for="pos-10" class="arrow arrow-right arrow-h arrow-S4-P9-P10"></label>
        <label for="pos-9" class="arrow arrow-left arrow-h arrow-S4-P10-P9"></label>
        <label for="pos-11" class="arrow arrow-right arrow-h arrow-S4-P10-P11"></label>
        <label for="pos-10" class="arrow arrow-left arrow-h arrow-S4-P11-P10"></label>
        <label for="pos-12" class="arrow arrow-right arrow-h arrow-S4-P11-P12"></label>
        <label for="pos-11" class="arrow arrow-left arrow-h arrow-S4-P12-P11"></label>

        <!-- Up arrow labels (at ladder positions) -->
        <label for="level-1" class="arrow arrow-up arrow-up-S1-L0-P5"></label>
        <label for="level-2" class="arrow arrow-up arrow-up-S1-L1-P3"></label>
        <label for="level-3" class="arrow arrow-up arrow-up-S1-L2-P1"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-S1-L3-P4"></label>

        <!-- Down arrow labels (at platform gaps) -->
        <label for="level-0" class="arrow arrow-down arrow-down-S1-L1-P1"></label>
        <label for="level-1" class="arrow arrow-down arrow-down-S1-L2-P5"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-S1-L4-P6"></label>
        <label for="level-2" class="arrow arrow-down arrow-down-S1-L3-P3"></label>

        <!-- Stage 2 Up arrow labels (S2 uses levels 5-9) -->
        <label for="level-6" class="arrow arrow-up arrow-up-S2-L5-P8"></label>
        <label for="level-6" class="arrow arrow-up arrow-up-S2-L5-P11"></label>
        <label for="level-7" class="arrow arrow-up arrow-up-S2-L6-P7"></label>
        <label for="level-7" class="arrow arrow-up arrow-up-S2-L6-P10"></label>
        <label for="level-8" class="arrow arrow-up arrow-up-S2-L7-P11"></label>
        <label for="level-9" class="arrow arrow-up arrow-up-S2-L8-P9"></label>

        <!-- Stage 2 Down arrow labels (S2 uses levels 5-9) -->
        <label for="level-5" class="arrow arrow-down arrow-down-S2-L6-P7"></label>
        <label for="level-5" class="arrow arrow-down arrow-down-S2-L6-P11"></label>
        <label for="level-6" class="arrow arrow-down arrow-down-S2-L7-P8"></label>
        <label for="level-7" class="arrow arrow-down arrow-down-S2-L8-P10"></label>
        <label for="level-8" class="arrow arrow-down arrow-down-S2-L9-P7"></label>

        <!-- Stage 4 Up arrow labels (S4 uses levels 0-4) -->
        <!-- L0: P7, P8, P9, P12 -->
        <label for="level-1" class="arrow arrow-up arrow-up-S4-L0-P7"></label>
        <label for="level-1" class="arrow arrow-up arrow-up-S4-L0-P8"></label>
        <label for="level-1" class="arrow arrow-up arrow-up-S4-L0-P9"></label>
        <label for="level-1" class="arrow arrow-up arrow-up-S4-L0-P12"></label>
        <!-- L1: P7, P9, P11 -->
        <label for="level-2" class="arrow arrow-up arrow-up-S4-L1-P7"></label>
        <label for="level-2" class="arrow arrow-up arrow-up-S4-L1-P9"></label>
        <label for="level-2" class="arrow arrow-up arrow-up-S4-L1-P11"></label>
        <!-- L2: P8, P10, P11 -->
        <label for="level-3" class="arrow arrow-up arrow-up-S4-L2-P8"></label>
        <label for="level-3" class="arrow arrow-up arrow-up-S4-L2-P10"></label>
        <label for="level-3" class="arrow arrow-up arrow-up-S4-L2-P11"></label>
        <!-- L3: P7, P9, P10, P11, P12 -->
        <label for="level-4" class="arrow arrow-up arrow-up-S4-L3-P7"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-S4-L3-P9"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-S4-L3-P10"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-S4-L3-P11"></label>
        <label for="level-4" class="arrow arrow-up arrow-up-S4-L3-P12"></label>
        <!-- L4: P7 (climb to S2) -->
        <label for="level-5" class="arrow arrow-up arrow-up-S4-L4-P7"></label>

        <!-- Stage 4 Down arrow labels (S4 uses levels 0-4) -->
        <!-- L4: P7, P9, P10, P11, P12 -->
        <label for="level-3" class="arrow arrow-down arrow-down-S4-L4-P7"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-S4-L4-P9"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-S4-L4-P10"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-S4-L4-P11"></label>
        <label for="level-3" class="arrow arrow-down arrow-down-S4-L4-P12"></label>
        <!-- L3: P8, P10, P11 -->
        <label for="level-2" class="arrow arrow-down arrow-down-S4-L3-P8"></label>
        <label for="level-2" class="arrow arrow-down arrow-down-S4-L3-P10"></label>
        <label for="level-2" class="arrow arrow-down arrow-down-S4-L3-P11"></label>
        <!-- L2: P7, P9, P11 -->
        <label for="level-1" class="arrow arrow-down arrow-down-S4-L2-P7"></label>
        <label for="level-1" class="arrow arrow-down arrow-down-S4-L2-P9"></label>
        <label for="level-1" class="arrow arrow-down arrow-down-S4-L2-P11"></label>
        <!-- L1: P7, P8, P9, P12 -->
        <label for="level-0" class="arrow arrow-down arrow-down-S4-L1-P7"></label>
        <label for="level-0" class="arrow arrow-down arrow-down-S4-L1-P8"></label>
        <label for="level-0" class="arrow arrow-down arrow-down-S4-L1-P9"></label>
        <label for="level-0" class="arrow arrow-down arrow-down-S4-L1-P12"></label>

        <!-- S2→S4 climb arrow at P7 -->
        <label for="level-4" class="arrow arrow-down arrow-down-S2-L5-P7-to-S4"></label>

        <!-- Stage 3 Down arrow labels (S3 uses levels 5-9) -->
        <label for="level-5" class="arrow arrow-down arrow-down-S3-L6-P16"></label>
        <label for="level-6" class="arrow arrow-down arrow-down-S3-L7-P13"></label>
        <label for="level-6" class="arrow arrow-down arrow-down-S3-L7-P14"></label>
        <label for="level-6" class="arrow arrow-down arrow-down-S3-L7-P18"></label>

        <!-- Stage 3 Up arrow labels (S3 uses levels 5-9) -->
        <label for="level-6" class="arrow arrow-up arrow-up-S3-L5-P16"></label>
        <label for="level-7" class="arrow arrow-up arrow-up-S3-L6-P18"></label>
        <label for="pos-φ" class="arrow arrow-up arrow-up-S3-L8-P17"></label>

        <!-- Stage 3 Phantom position arrows (fall left/right) -->
        <label for="pos-16" class="arrow arrow-left arrow-left-S3-Pφ"></label>
        <label for="pos-18" class="arrow arrow-right arrow-right-S3-Pφ"></label>

        <!-- Player character -->
        <div class="player">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="170 300 750 930"><path fill="#ccd3e4" d="m536 311 4 1 13 1v-1h6v2l11 1 1 2 10 1 6 1 11 1 2 1v3l4-4 4 3-5 2h5q6 1 7 3l10 5q45 19 81 52l2 2q10 10 18 21l3 4q23 33 36 70 3 10 8 18c15 31 11 74-4 104l-6 15q-15 46-51 76h-2v2q-18 15-40 23l-6 2-15 5 11 5q26 9 50 23 16 8 34 2h4l28-7 4-1 26-8q9-5 20-3l3-1q22-4 36 14 3 5 3 12l2 1c11 3 17 14 19 24v7q0 10 3 20 4 22-11 37-11 9-23 5l-3-1q-5-1-9 3c-12 8-26 9-39 12l-4 1q-67 12-129-13v3c-6 65-23 121-80 158q-4 2-4 5l9 17 6 12 1 4 3 7 9 1h5c5 0 5 0 9-2v4l8 1q18 6 31 19v2h2q11 13 11 29l2 1h-2v4c-5 33-46 59-72 75l-5 3c-19 11-42 21-64 21h-5q-16-3-24-19l-2-2-19-30h-3l-1-3h2l-3-6-2-3-1-2-2 1-2-1 1-5-3-6-3-9-2-1-1-3-5-8-2-3-5-4-2-4-4-5q-9 0-17 5l-12 3v15q0 26-19 41-28 13-55-1l-3-1q-9-4-16-11l-3-2c-24-23-40-63-33-96 4-17 13-26 27-35l5-4 3-2 2-2h3l6-4 26-17 5-3h2l-5-10q-12-18-17-39l-1-3q-5-26-4-52v-9q1-3-2-4l2-1 1-10 4-22v-4q-16 3-27 14l-7 6-11 9-27 22c-5 3-5 3-4 8l2 10q4 15-5 28-8 6-17 4-10-6-12-16l-1-4-1-3-3 2-6 1 1 3q5 14-4 25-10 7-22 2l-10-8-5-2c-19-9-28-32-30-52v-15c1-31 17-59 38-81l3-3 23-20 3-2 22-14 4-2c38-22 91-48 137-39q6 2 11-3l-4-2a223 223 0 0 1-50-28q-20-16-34-38l-2 1v-2q-5-19-21-26c-17-9-25-34-29-51l-2-6v-21q-2-36 22-63l1 1 5-15q6-21 18-40l-1-4 2-1 1 2 3-5c24-37 24-37 32-37v-2q33-31 76-47l8-3-1-4 4 1 1-2h5l19-2 3-1 8-2v-3h4l31-1zm-63 2-1 2 4-1zm4 0v1h6v-1zm-37 8 4 1Zm-85 519 1 2Z"/><path fill="#dde3f0" d="m536 311 4 1 13 1v-1h6v2l11 1 1 2 10 1 6 1 11 1 2 1v3l4-4 4 3-5 2h5q6 1 7 3l10 5q45 19 81 52l2 2q10 10 18 21l3 4q23 33 36 70 3 10 8 18c15 31 11 74-4 104l-6 15q-15 46-51 76h-2v2c-28 22-28 22-42 23l-12 3c-14 5-14 5-21 5l-3 2q-30 8-62 6h-20l-14-2h-10l-17-1v-1l-14-1-5-1-11-1-3-1v-2h-5l-10-1-11-2-11-3v-2l-5 1-11-3-3-1-37-14q-24-10-43-30l-2-2q-12-11-20-25l-2 1v-2q-5-19-21-26c-17-9-25-34-29-51l-2-6v-21q-2-36 22-63l1 1 5-15q6-21 18-40l-1-4 2-1 1 2 3-5c24-37 24-37 32-37v-2q33-31 76-47l8-3-1-4 4 1 1-2h5l19-2 3-1 8-2v-3h4l31-1zm-63 2-1 2 4-1zm4 0v1h6v-1zm-37 8 4 1Z"/><path fill="#091629" d="m648 402 6 1c24 2 47 7 65 23l2 2c32 30 43 80 42 122v5q1 19-3 37l-1 3c-7 37-25 70-63 83-60 18-171 23-222-22l-2-2c-42-39-39-123-28-175q12-53 64-68c44-13 94-14 140-9"/><path fill="#dfe4ef" d="m403 717-1 1 2 1q23 10 25 35 2 29-18 50l-2 3c-14 14-41 34-62 34v2l-4 2q-13 7-23 17l-6 5-12 10c-14 12-14 12-21 16-5 5-2 11-1 18q4 16-5 28-7 6-17 4-10-6-12-16l-1-4-1-3-3 2-6 1 1 3q5 14-4 25-10 7-22 2l-10-8-5-2c-19-9-28-32-30-52v-15c1-31 17-59 38-81l3-3 23-20 3-2 22-14 4-2c39-23 99-52 145-37"/><path fill="#d8ddeb" d="M865 751q3 5 3 12l3 1c10 3 16 14 18 24v7q0 10 3 20 4 22-11 37-11 8-23 5l-3-1q-5-1-9 3c-11 8-26 9-39 12l-4 1q-41 8-82 1l1-2-2-2-7-10-1-3c-13-28-5-64 12-87l2-3 2-3q7-5 16-6l8-1 4-1 20-5 4-1c14-3 14-3 26-8q9-5 20-3l3-1q23-4 36 14"/><path fill="#e2e7f3" d="m548 976 3 2v2l4 2a124 124 0 0 1 23 26q7 8 11 18l-1 2-1-3c-25-8-50 5-69 20-21 19-44 46-46 75v7c-5-1-5-2-8-6l-3-2v-5l-2-1-2-4-5-3c-16-18-32-43-39-67l-1-3 1-2h-2c-7-19 0-37 11-52h2l2-4c35-31 85-29 122-2"/><path fill="#8b59c5" d="M629 791h10q13 1 18 12 3 10 2 22v38c0 35 0 35-12 44-21 9-46 8-69 8h-20q-16 2-26-9-2-6-2-14v-80q0-11 10-17l26-3h29l23-1z"/><path fill="#cdd5e8" d="M188 814v5c-2 27 15 51 36 66 14 9 33 18 49 12l3-2h3l-1 5 2 8c2 11 3 22-5 31q-7 6-17 4-10-6-12-16l-1-4-1-3-3 2-6 1 1 3q5 14-4 25-10 7-22 2l-10-8-5-2c-19-9-28-32-30-52v-15q2-35 23-62"/><path fill="#e5e9f4" d="M865 751q3 5 3 12l3 1c10 3 16 14 18 24v7q0 10 3 20 5 21-10 35-12 9-26 5-8-7-8-18v-4h3q16 1 28-11l-2 2c-8 6-18 11-28 7q-11-9-10-22l6-3q20-7 24-28v-11 6q-3 21-20 31-10 3-18-3l-4-7-1-2q-1-10 3-21l1-6-1 3q-3 18-19 26-13 3-22-8-7-20 6-36 13-15 32-12l3-1q23-4 36 14"/><path fill="#9beffc" d="M591 501q16 20 14 44v3q2 33-25 51-16 5-30-6c-16-16-19-39-16-61q5-26 27-39 17-4 30 8"/><path fill="#c9cfe0" d="m800 746-4 2-2 4-2 3q-10 15-3 31 8 9 21 7c13-5 16-16 19-29l1-3h1q1 7-2 14-6 14 2 25 7 6 15 4 18-9 21-28l1-4v-7q5 6 2 13-5 22-27 29-5 1-3 7 1 10 9 16 15 4 27-7l3-3c0 6-7 9-12 12q-9 4-19 1c1 9 1 9 5 18v2l4 1 3 1q12 2 21-6l2 1c-9 7-14 9-25 7l-3-1q-5-1-9 3c-22 14-57 16-82 16v-1l10-1q22 0 42-7l-5-2q-10-6-17-13l-4-4a81 81 0 0 1-10-79q4-10 13-18l1-1-4-2c7-2 7-2 10-1"/><path fill="#9ceffc" d="M716 502c17 20 16 50 9 74q-5 14-17 22-14 1-22-11a85 85 0 0 1 0-76c7-11 18-18 30-9"/><path fill="#7453b0" d="M308 500q21 20 18 49v4c0 14-2 30-14 39q-11 4-20-5a77 77 0 0 1-12-71c5-11 14-23 28-16"/><path fill="#adb6ce" d="M188 814v5c-2 27 15 51 36 66 14 9 33 18 49 12l3-2h3l-1 5 2 8c2 11 3 22-5 31q-7 6-17 4-10-6-12-16l-1-4-1-3-3 2h-6l3-2c15-7 15-7 26-18h-5c-25 0-51-20-64-41l-8-16-2-4q-4-14 3-27"/><path fill="#b3b9d0" d="m601 1015-8 5-3 5 3 6c3 6 3 6 2 8l-1-2c-9-9-22-8-33-6-39 11-71 50-83 87l-3 17-5-8h2v-6c0-26 19-49 36-67l3-3c17-18 41-31 67-29l9 3-2-5-1-4q4 3 3 5l3-2 3-2 3-2z"/><path fill="#d0d8e9" d="M886 781q5 8 3 17 0 8 3 17 5 21-10 35-12 9-26 5-8-7-8-18v-4h3q16 2 28-11 8-14 7-29z"/><path fill="#bec6db" d="m181 908 3 3q15 13 35 13h5l8-1h3q5 13 0 25-9 9-21 6-8-2-14-9l-5-2 3-1q1-6-3-6l-2-13q-1-7-9-10-4-3-3-5"/><path fill="#98a0bb" d="m800 746-4 2-2 4-2 3q-10 15-3 31 8 9 21 7c13-5 16-16 19-29l1-3h1l-2 16-1 5q-1 5-6 5l-3 3q-8 8-19 6c-10-4-13-8-17-18a85 85 0 0 0 4 48q8 21 27 33l3 2 15 3c-17 11-49 11-68 11v-1l10-1q22 0 42-7l-5-2q-10-6-17-13l-4-4a81 81 0 0 1-10-79q4-10 13-18l1-1-4-2c7-2 7-2 10-1"/><path fill="#8b98b8" d="m375 990 6 7-3 9c-8 26 2 55 19 75q18 18 42 23-17 7-32-5l-14-12-2-2a81 81 0 0 1-22-59v-3q-1-13 5-24l-3-1 5-2z"/><path fill="#a5adc6" d="M279 746v4c-3 33 19 70 45 89q9 5 20 4l-4 3-5 4q-4 4-7 3l2-3-2-1c-30-15-55-53-57-86q0-7 3-14h3z"/><path fill="#a6aec6" d="m732 762-3 2q-13 13-18 32l-1 3-2 25v4q-1 25 15 44l-15-3 4-1-2-2c-14-19-13-50-6-72l1-4c4-10 14-32 27-28"/><path fill="#4a2c80" d="M635 803h5c5 0 5 0 9 4l1 11v55q2 14-7 24-18 5-37 4v-1l7-1h4l9-1 4-1h4q9-1 12-9v-6l1-4v-47c1-13 1-13-3-25l-11-1-29 1-4 1h-33l-4 1h-8l-9 1-1 12v40l-1 17v15q0 6 6 7l6 1h6v1h-10q-7 0-10-6v-79q0-7 6-11l14-2h28l21-1z"/><path fill="#382962" d="M626 791h13q6 0 11 3h-22l-43 1h-27c-14 1-14 1-24 9q-2 5-1 11v83q0 8 7 11 11 4 22 3h21c34 1 34 1 65-9l2 1c-15 15-52 11-72 11h-20q-16 2-26-9-2-6-2-14v-80q0-11 10-17l26-3h29l23-1z"/><path fill="#e4e4f2" d="m368 1179 6 1-6 2z"/><path fill="#e1e7f2" d="m308 1131 2 3h-3z"/><path fill="#fdfefe" d="M299 1117h2v2l2 1h-3z"/><path fill="#b4b2df" d="m703 870 4 1-3 1z"/><path fill="#e7edf9" d="m500 1185 2 1-1 3z"/><path fill="#b2b0e3" d="m458 1115 2 1-1 2-2-2z"/><path fill="#f3fbfc" d="M611 1064h5v1h-5z"/><path fill="#f5fdfe" d="m606 1055 2 1-1 3z"/><path fill="#d2d7eb" d="m517 1210 2 3h-2z"/><path fill="#cfced8" d="m376 1181 4 1Z"/><path fill="#c8cfe0" d="m352 1175 4 1Z"/><path fill="#c4c7e1" d="m433 1117 4 1Z"/><path fill="#d4e7e8" d="m685 1112 1 4Z"/><path fill="#f8fbfb" d="m639 1066 2 1-1 2z"/><path fill="#f8fbfc" d="m598 1038 2 3h-2z"/><path fill="#c5f8f3" d="m605 1014 2 1h-3z"/><path fill="#e5fcfe" d="m355 957 2 1-1 2z"/><path fill="#dcdeeb" d="M395 709h3l-1 2z"/><path fill="#dcf8f8" d="m308 629 2 3h-2z"/><path fill="#fdfffe" d="m781 526 2 2-2 1z"/><path fill="#f4f9fb" d="m456 315 3 1-3 1z"/><path fill="#fafbfc" d="m467 313 2 2-3-1z"/><path fill="#b9bdd2" d="m336 1165 2 1-2 1z"/><path fill="#dadfef" d="m312 1138 2 2h-2z"/><path fill="#d1d3e2" d="m297 1102 1 2-2-1z"/><path d="m924 1090 3 1Z"/><path fill="#cde0df" d="M596 1019h2l-1 2z"/><path fill="#bdc1d4" d="m368 984 2 2h-2z"/><path fill="#fafefe" d="m191 942 1 2-2-1z"/><path fill="#96f1f7" d="m741 876 3 1Z"/><path fill="#fafdfd" d="m760 752 3 1Z"/><path fill="#fefefc" d="m776 748 2 1-2 1z"/><path fill="#c8d7f0" d="m352 715 3 1Z"/><path fill="#e6e5f1" d="m358 714 3 1Z"/><path fill="#e3e2f3" d="m354 685 1 2-2-1z"/><path fill="#fcfefc" d="m272 590 2 2h-2z"/><path fill="#e5e7ea" d="m336 383 2 1-2 1z"/><path fill="#fdfcff" d="M692 371h2l-1 2z"/><path fill="#e7e9ec" d="m399 336 3 1Z"/><path fill="#edeef6" d="m608 323 1 2-2-1z"/><path fill="#fdfdfd" d="m428 321 2 2h-2z"/><path fill="#e5fcfa" d="m574 315 3 1Z"/><path fill="#f7f7fb" d="m463 314 2 1-2 1z"/><path fill="#fbfbfd" d="m562 313 3 1Z"/><path fill="#c0bfe7" d="m581 1215 2 1Z"/><path fill="#9d96b2" d="m386 1181 2 1Z"/><path fill="#c6c2df" d="m320 1151 2 1Z"/><path d="m942 1119 2 1Z"/><path fill="#404040" d="m874 1117 2 1Z"/><path fill="#c1c0df" d="m452 1110 2 1Z"/><path d="m1004 1090 2 1Zm-48 0 2 1Z"/><path fill="#fafbfc" d="m622 1064 2 1Z"/><path fill="#fff" d="m619 1064 2 1Z"/><path fill="#f8fcfd" d="m601 1045 2 1Z"/><path fill="#dcdfe0" d="m350 1008 2 1Z"/><path fill="#d2cff8" d="m373 994 2 1Z"/><path fill="#c5c0da" d="m368 989 2 1Z"/><path fill="#fffefc" d="m759 877 2 1Z"/><path fill="#97a8c5" d="m738 876 2 1Z"/><path fill="#9b98c5" d="m821 870 2 1Z"/><path fill="#cbd3d2" d="m679 862 2 1Z"/><path fill="#fcffff" d="m340 846 2 1Zm533-83 2 1Z"/><path fill="#f7fbff" d="m783 747 2 1Z"/><path fill="#e9f9f8" d="m786 746 2 1Z"/><path fill="#f8fefe" d="m790 745 2 1Z"/><path fill="#fbfdff" d="m273 744 2 1Z"/><path fill="#fcffff" d="m653 728 2 1Z"/><path fill="#fefeff" d="m366 713 2 1Z"/><path fill="#fcffff" d="m381 702 2 1Z"/><path fill="#dddede" d="m362 691 2 1Z"/><path fill="#c4f9f9" d="m321 651 2 1Z"/><path fill="#fcfdfc" d="m780 518 2 1Z"/><path fill="#dbfdfc" d="m323 398 2 1Z"/><path fill="#f9fafb" d="m336 381 2 1Z"/><path fill="#fafaff" d="m697 376 2 1Z"/><path fill="#fffdff" d="m687 368 2 1Z"/><path fill="#f9fcfe" d="m385 344 2 1Z"/><path fill="#fdfdff" d="m620 329 2 1Z"/><path fill="#f9fbfe" d="m428 324 2 1Z"/><path fill="#f9ffff" d="m451 317 2 1Z"/></svg>
            <span class="torch-held"><svg><use href="#torch"/></svg></span>
            <span class="tooltip player-tooltip">Nibo</span>
        </div>

        <!-- ==================== STAGE 1 LAYOUT ==================== -->
        <!-- Factory background -->
        <div class="factory-bg">
            <svg><use href="#factory-background"/></svg>
        </div>
        <!-- Ground -->
        <div class="ground-S1"></div>
        <!-- Warning walls -->
        <div class="warning-wall wall-S1-left"></div>
        <div class="warning-wall wall-S1-right"></div>
        <!-- Platforms -->
        <div class="platform platform-S1-L1"></div>
        <div class="platform platform-S1-L2-left"></div>
        <div class="platform platform-S1-L2-right"></div>
        <div class="platform platform-S1-L3-left"></div>
        <div class="platform platform-S1-L3-right"></div>
        <div class="platform platform-S1-L4"></div>
        <!-- Ladders (up) -->
        <div class="ladder wooden-ladder ladder-S1-L0-P5"></div>
        <div class="ladder wooden-ladder ladder-S1-L1-P3"></div>
        <div class="ladder wooden-ladder ladder-S1-L2-P1"></div>
        <div class="ladder wooden-ladder ladder-S1-L3-P4"></div>
        <div class="ladder wooden-ladder ladder-S4-L4-P7"></div>
        <!-- Grates (down) -->
        <div class="grate grate-S1-L1-P1"></div>
        <div class="grate grate-S1-L2-P5"></div>
        <div class="grate grate-S1-L3-P3"></div>
        <div class="grate grate-S1-L4-P6"></div>
        <!-- Door -->
        <div class="door-container door-S1-L0-P6">
            <label for="door-unlocked" class="door">
                <svg class="door-closed" preserveAspectRatio="none"><use href="#door-closed"/></svg>
                <svg class="door-open" preserveAspectRatio="none"><use href="#door-open"/></svg>
            </label>
            <span class="door-hover-area"></span>
            <span class="tooltip door-tooltip">The door handle is broken.<br>You need a wrench.</span>
            <span class="tooltip door-tooltip-wrench">Repair the door handle.</span>
        </div>
        <label for="door-unlocked" class="wrench-at-door"><svg><use href="#wrench"/></svg></label>
        <!-- Skull hazard -->
        <div class="skull skull-S1-L1-P6">
            <span class="tooltip skull-tooltip">Poison</span>
            <svg><use href="#skull"/></svg>
        </div>

        <!-- ==================== STAGE 2 LAYOUT ==================== -->
        <div class="stage-2-elements">
            <!-- Jungle background -->
            <div class="jungle-bg">
                <svg><use href="#jungle-background"/></svg>
            </div>
            <!-- Ground -->
            <div class="ground-S2"></div>
            <!-- Manhole at L5-P7 (entry point from S4) -->
            <div class="manhole-S2-L5-P7"></div>
            <div class="manhole-cover-S2-L5-P7"></div>
            <!-- Rock wall on left edge of S2 -->
            <div class="rock-wall wall-S2-left"></div>
            <!-- Rock walls on edges of S4 -->
            <div class="rock-wall wall-S4-left"></div>
            <div class="rock-wall wall-S4-right"></div>
            <!-- Platforms -->
            <div class="platform platform-S2-L6-left"></div>
            <div class="platform platform-S2-L6-right"></div>
            <div class="platform platform-S2-L7-left"></div>
            <div class="platform platform-S2-L7-right"></div>
            <div class="platform platform-S2-L8-left"></div>
            <div class="platform platform-S2-L8-right"></div>
            <div class="platform platform-S2-L9"></div>
            <!-- Vines (up) -->
            <div class="vine vine-S2-L5-P8"></div>
            <div class="vine vine-S2-L5-P11"></div>
            <div class="vine vine-S2-L6-P7"></div>
            <div class="vine vine-S2-L6-P10"></div>
            <div class="vine vine-S2-L7-P11"></div>
            <div class="vine vine-S2-L8-P9"></div>
            <!-- Branches (down) -->
            <div class="branch branch-S2-L6-P7"></div>
            <div class="branch branch-S2-L6-P11"></div>
            <div class="branch branch-S2-L7-P8"></div>
            <div class="branch branch-S2-L8-P10"></div>
            <div class="branch branch-S2-L9-P7"></div>
            <!-- Bacteria hazards -->
            <div class="disease disease-S2-L5-P10">
                <span class="tooltip disease-tooltip">Disease</span>
                <svg><use href="#disease"/></svg>
            </div>
            <div class="disease disease-S2-L6-P9">
                <span class="tooltip disease-tooltip">Disease</span>
                <svg><use href="#disease"/></svg>
            </div>
            <!-- Tree blocking exit -->
            <div class="tree-container">
                <label for="tree-chopped" class="tree">
                    <svg><use href="#tree"/></svg>
                </label>
                <span class="tree-hover-area"></span>
                <span class="tooltip tree-tooltip">The tree blocks your way.<br>You need an axe.</span>
                <span class="tooltip tree-tooltip-axe">Chop down the tree</span>
            </div>
            <label for="tree-chopped" class="axe-at-tree"><svg><use href="#axe"/></svg></label>
        </div>

        <!-- ==================== STAGE 4 LAYOUT ==================== -->
        <div class="stage-4-elements">
            <!-- Caves background -->
            <div class="caves-bg">
                <svg><use href="#caves-background"/></svg>
            </div>
            <!-- S4 ground -->
            <div class="ground-S4"></div>
            <!-- S4 Platforms -->
            <div class="platform platform-S4-L4-P8"></div>
            <div class="platform platform-S4-L3-P7"></div>
            <div class="platform platform-S4-L3-P9"></div>
            <div class="platform platform-S4-L3-P12"></div>
            <div class="platform platform-S4-L2-P8"></div>
            <div class="platform platform-S4-L2-P10"></div>
            <div class="platform platform-S4-L2-P12"></div>
            <div class="platform platform-S4-L1-P10-P11"></div>
            <!-- S4 Stalagmites -->
            <div class="stalagmite-S4 stalagmite-S4-L3-P10-P11"><svg><use href="#stalagmite-2"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L3-P11-P12"><svg><use href="#stalagmite-1"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L0-P8-P9"><svg><use href="#stalagmite-3"/></svg></div>
            <!-- S4 Stalactites -->
            <div class="stalactite-S4 stalactite-S4-L4-P9-P10"><svg><use href="#stalactite-1"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L1-P7-P8"><svg><use href="#stalactite-2"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L1-P9-P10"><svg><use href="#stalactite-2"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L1-P9-P10"><svg><use href="#stalagmite-3"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L2-P10-P11"><svg><use href="#stalactite-3"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L2-P10-P11"><svg><use href="#stalagmite-2"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L3-P7-P8"><svg><use href="#stalactite-2"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L3-P7-P8"><svg><use href="#stalagmite-2"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L3-P8-P9"><svg><use href="#stalactite-3"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L3-P8-P9"><svg><use href="#stalagmite-1"/></svg></div>
            <div class="stalactite-S4 stalactite-S4-L2-P8-P9"><svg><use href="#stalactite-2"/></svg></div>
            <div class="stalagmite-S4 stalagmite-S4-L2-P8-P9"><svg><use href="#stalagmite-2"/></svg></div>
        </div>

        <!-- Barrel blocking exit -->
        <div class="barrel-S3-L9-P15">
            <svg><use href="#barrel"/></svg>
            <svg><use href="#barrel"/></svg>
            <span class="tooltip">Barrels</span>
        </div>

        <!-- ==================== STAGE 3 LAYOUT ==================== -->
        <!-- Spaceship background -->
        <div class="spacecraft-bg">
            <svg><use href="#spacecraft"/></svg>
        </div>
        <!-- Ground -->
        <div class="ground-S3"></div>
        <!-- Platforms -->
        <div class="grate grate-S3-L6-P13-P14"></div>
        <div class="grate grate-S3-L8-P13-P14"></div>
        <div class="platform platform-S3-L4"></div>
        <!-- Grate (down) -->
        <div class="grate grate-S3-L7-P13-P14"></div>
        <!-- Floating platform (phantom position) -->
        <div class="platform-S3-L9-P17-floating"></div>
        <!-- Ladders -->
        <div class="ladder spine-ladder ladder-S3-L5-P16"></div>
        <div class="ladder spine-ladder ladder-S3-L6-P18"></div>
        <div class="ladder spine-ladder ladder-S3-L8-P17"></div>
        <!-- Bolt -->
        <div class="bolt">
            <svg><use href="#bolt"/></svg>
            <span class="tooltip">A short-circuit.<br>You need a new battery.</span>
        </div>
        <label for="bolt-fixed" class="battery-at-bolt"><svg><use href="#battery"/></svg></label>
        <div class="battery-installed">
            <svg><use href="#battery"/></svg>
            <span class="tooltip">The battery is<br>installed correctly.</span>
        </div>
        <span class="flight-controls-hover-area"></span>
        <label for="flight-controls-used" class="idcard-at-controls"><svg><use href="#id-card"/></svg></label>
        <div class="flight-controls-unavailable">
            <svg><use href="#flight-controls"/></svg>
            <span class="tooltip tooltip-no-power">Flight controls are offline.<br>You need power.</span>
            <span class="tooltip tooltip-no-idcard">Flight controls are unavailable.<br>You need your ID card.</span>
        </div>
        <span class="flight-controls-available-hover-area"></span>
        <label for="escaped" class="flight-controls-available">
            <svg><use href="#flight-controls"/></svg>
            <span class="tooltip">Flight controls<br>are now available.</span>
        </label>

        <!-- ==================== STAGE 1 LOOT ==================== -->
        <div class="container coin loot-S1-L0-P3">
            <label for="loot-S1-L0-P3-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S1-L1-P4">
            <label for="loot-S1-L1-P4-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S1-L3-P5">
            <label for="loot-S1-L3-P5-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S1-L2-P1">
            <label for="loot-S1-L2-P1-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S1-L4-P2">
            <label for="loot-S1-L4-P2-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>

        <!-- ==================== STAGE 4 LOOT ==================== -->
        <div class="container coin loot-S4-L3-P7">
            <label for="loot-S4-L3-P7-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
        </div>
        <div class="container aquamarine loot-S4-L3-P8">
            <label for="loot-S4-L3-P8-pickup" class="loot-in-game"><svg><use href="#gem"/></svg></label>
            <span class="loot-hover-area"></span>
            <span class="tooltip">Aquamarine</span>
        </div>
        <div class="container coin loot-S4-L3-P12">
            <label for="loot-S4-L3-P12-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
        </div>
        <div class="container aquamarine loot-S4-L1-P10">
            <label for="loot-S4-L1-P10-pickup" class="loot-in-game"><svg><use href="#gem"/></svg></label>
            <span class="loot-hover-area"></span>
            <span class="tooltip">Aquamarine</span>
        </div>
        <div class="container coin loot-S4-L0-P9">
            <label for="loot-S4-L0-P9-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
        </div>

        <!-- ==================== STAGE 2 LOOT ==================== -->
        <div class="stage-2-elements">
            <div class="container coin loot-S2-L5-P8">
                <label for="loot-S2-L5-P8-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
                <span class="loot-hover-area"></span>
            </div>
            <div class="container aquamarine loot-S2-L6-P11">
                <label for="loot-S2-L6-P11-pickup" class="loot-in-game"><svg><use href="#gem"/></svg></label>
                <span class="loot-hover-area"></span>
                <span class="tooltip">Aquamarine</span>
            </div>
            <div class="container coin loot-S2-L7-P7">
                <label for="loot-S2-L7-P7-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
                <span class="loot-hover-area"></span>
            </div>
            <div class="container aquamarine loot-S2-L8-P9">
                <label for="loot-S2-L8-P9-pickup" class="loot-in-game"><svg><use href="#gem"/></svg></label>
                <span class="loot-hover-area"></span>
                <span class="tooltip">Aquamarine</span>
            </div>
            <div class="container coin loot-S2-L9-P10">
                <label for="loot-S2-L9-P10-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
                <span class="loot-hover-area"></span>
            </div>
        </div>

        <!-- ==================== STAGE 3 LOOT ==================== -->
        <div class="container ruby loot-S3-L5-P18">
            <label for="loot-S3-L5-P18-pickup" class="loot-in-game"><svg><use href="#gem"/></svg></label>
            <span class="loot-hover-area"></span>
            <span class="tooltip">Ruby</span>
        </div>
        <div class="container coin loot-S3-L5-P15">
            <label for="loot-S3-L5-P15-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S3-L8-P18">
            <label for="loot-S3-L8-P18-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>
        <div class="container coin loot-S3-L9-P14">
            <label for="loot-S3-L9-P14-pickup" class="loot-in-game"><svg><use href="#coin"/></svg></label>
            <span class="loot-hover-area"></span>
        </div>

        </div><!-- end game-world -->

        <!-- darkness for Stage 4 (Caves) - creates darkness with hole around player -->
        <div class="darkness-S4"></div>

        <!-- Title screen overlay -->
        <label for="title-screen-toggle" class="overlay title-screen-overlay">
            <h1>NIBO'S WAY OUT</h1>
            <p class="story">Nibo is lost on an alien planet.<br>He must find his ship.<br>Help him escape.</p>
            <div class="submessage">Click to start</div>
            <div class="copyright">© 2026 René Uittenbogaard · <a href="https://github.com/ruittenb/nibo-game" target="_blank">View on GitHub</a></div>
        </label>

        <!-- Death overlays -->
        <div class="overlay death-screen-overlay death-screen-overlay-poison">
            <div class="message">You died from poison</div>
            <div class="submessage">GAME OVER</div>
        </div>
        <div class="overlay death-screen-overlay death-screen-overlay-disease">
            <div class="message">You died from a deadly disease</div>
            <div class="submessage">GAME OVER</div>
        </div>
        <div class="overlay death-screen-overlay death-screen-overlay-chemical">
            <div class="message">You died from chemical waste</div>
            <div class="submessage">GAME OVER</div>
        </div>

        <!-- Escape overlay -->
        <div class="overlay escape-screen-overlay">
            <div class="message">You Escaped!</div>
            <div class="submessage">Well done</div>
            <div class="video-box">
                <video muted preload="auto" playsinline controls>
                    <source src="images/spaceship.mp4" type="video/mp4">
                </video>
            </div>
        </div>

    </div>
</body>
</html>
